<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-12-20">

<title>Diagnostics –  CHA Statistics II in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/exercises.html" rel="next">
<link href="../contents/chap22.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Diagnostics –  CHA Statistics II in R">
<meta property="og:description" content="mixed">
<meta property="og:site_name" content="CHA Statistics II in R">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Diagnostics</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics II in R</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages for SEM</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Keith’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Variable SEM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multigroup Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diagnostics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Diagnostics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEM Equations</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Kline’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/Kline/composite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reflective</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: Formative</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: PLS-PM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: HO</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#non-normality" id="toc-non-normality" class="nav-link active" data-scroll-target="#non-normality">Non-normality</a>
  <ul>
  <li><a href="#multivariate-test" id="toc-multivariate-test" class="nav-link" data-scroll-target="#multivariate-test">Multivariate test</a></li>
  <li><a href="#univariate-test" id="toc-univariate-test" class="nav-link" data-scroll-target="#univariate-test">Univariate test</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">Outliers</a></li>
  <li><a href="#homework-dataset" id="toc-homework-dataset" class="nav-link" data-scroll-target="#homework-dataset">Homework Dataset</a></li>
  <li><a href="#non-normality에-대한-대응" id="toc-non-normality에-대한-대응" class="nav-link" data-scroll-target="#non-normality에-대한-대응">Non-normality에 대한 대응</a>
  <ul class="collapse">
  <li><a href="#robust-ml" id="toc-robust-ml" class="nav-link" data-scroll-target="#robust-ml">Robust ML</a></li>
  <li><a href="#bootstrapping" id="toc-bootstrapping" class="nav-link" data-scroll-target="#bootstrapping">Bootstrapping</a></li>
  <li><a href="#분포에-대한-가정이-없는-방법" id="toc-분포에-대한-가정이-없는-방법" class="nav-link" data-scroll-target="#분포에-대한-가정이-없는-방법">분포에 대한 가정이 없는 방법</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">Missing Data</a>
  <ul>
  <li><a href="#fiml" id="toc-fiml" class="nav-link" data-scroll-target="#fiml">FIML</a></li>
  <li><a href="#imputation" id="toc-imputation" class="nav-link" data-scroll-target="#imputation">Imputation</a></li>
  </ul></li>
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity">Linearity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Diagnostics</h1>
<p class="subtitle lead">mixed</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 20, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<details class="code-fold">
<summary>Load libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manymome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="non-normality" class="level1">
<h1>Non-normality</h1>
<p><a href="https://cran.r-project.org/web/packages/MVN/vignettes/MVN.html">MVN: An R Package for Assessing Multivariate Normality</a></p>
<div id="cell-5" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="5">
<details class="code-fold">
<summary>Load data</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(covsim)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>sigma.target <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ig.sample <span class="ot">&lt;-</span> <span class="fu">rIG</span>(<span class="at">N =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, <span class="at">sigma.target =</span> sigma.target, <span class="at">reps =</span> <span class="dv">1</span>, <span class="at">skewness =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">8</span>), <span class="dv">0</span>), <span class="at">excesskurtosis =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> ig.sample <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-6" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 3
      X1     X2     X3
   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 -0.626 -0.609 -0.472
2  0.184 -0.125  0.799
3 -0.836 -0.749 -0.773
4  1.60   2.95   0.975
5  0.330 -0.268  0.693
6 -0.820  1.22   1.27 
# ℹ 994 more rows</code></pre>
</div>
</div>
<section id="multivariate-test" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-test">Multivariate test</h2>
<ul>
<li>mardia for Mardia’s test,</li>
<li>hz for Henze-Zirkler’s test, # default</li>
<li>royston for Royston’s test,</li>
<li>dh for Doornik-Hansen’s test,</li>
<li>energy for E-statistic</li>
</ul>
<div id="cell-8" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mvn</span>(df) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$multivariateNormality
           Test       HZ p value MVN
1 Henze-Zirkler 26.31374       0  NO

$univariateNormality
              Test  Variable Statistic   p value Normality
1 Anderson-Darling    X1        0.2219  0.8297      YES   
2 Anderson-Darling    X2       62.9376  &lt;0.001      NO    
3 Anderson-Darling    X3        4.1598  &lt;0.001      NO    

$Descriptives
      n         Mean   Std.Dev      Median       Min      Max       25th      75th
X1 1000 -0.011648142 1.0349158 -0.03532423 -3.008049 3.810277 -0.6973732 0.6884280
X2 1000  0.027678496 1.0566535 -0.18501542 -1.580517 8.663489 -0.5357336 0.2325938
X3 1000  0.009367604 0.9815131 -0.01418352 -4.190712 4.747516 -0.5385744 0.5710483
          Skew     Kurtosis
X1 -0.01913836 -0.007768915
X2  2.96485086 13.333058070
X3  0.29143698  2.195906716
</code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multivariate normality</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mvn</span>(<span class="at">data =</span> df, <span class="at">mvnTest =</span> <span class="st">"hz"</span>)<span class="sc">$</span>multivariateNormality <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Test       HZ p value MVN
1 Henze-Zirkler 26.31374       0  NO</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multivariate normality plot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> df, <span class="at">multivariatePlot =</span> <span class="st">"qq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-9-output-1.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="univariate-test" class="level2">
<h2 class="anchored" data-anchor-id="univariate-test">Univariate test</h2>
<ul>
<li>Shapiro-Wilk (SW),</li>
<li>Cramer-von Mises (CVM),</li>
<li>Lilliefors (Lillie),</li>
<li>Shapiro-Francia (SF),</li>
<li>Anderson-Darling (AD) # default</li>
</ul>
<div id="cell-13" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mvn</span>(<span class="at">data =</span> df, <span class="at">univariateTest =</span> <span class="st">"AD"</span>)<span class="sc">$</span>univariateNormality <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Test  Variable Statistic   p value Normality
1 Anderson-Darling    X1        0.2219  0.8297      YES   
2 Anderson-Darling    X2       62.9376  &lt;0.001      NO    
3 Anderson-Darling    X3        4.1598  &lt;0.001      NO    </code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># univariate normality histogram</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> df, <span class="at">univariatePlot =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-11-output-1.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># univariate normality scatterplot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> df, <span class="at">univariatePlot =</span> <span class="st">"scatter"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-12-output-1.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="outliers" class="level2">
<h2 class="anchored" data-anchor-id="outliers">Outliers</h2>
<div id="cell-17" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> df, <span class="at">mvnTest =</span> <span class="st">"hz"</span>, <span class="at">multivariateOutlierMethod =</span> <span class="st">"adj"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-13-output-1.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="homework-dataset" class="level2">
<h2 class="anchored" data-anchor-id="homework-dataset">Homework Dataset</h2>
<div id="cell-19" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/chap 19 latent means/Homework means.sav"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ethnic, <span class="sc">-</span>Female, <span class="at">hw10 =</span> f1s36a2, <span class="at">hw12 =</span> f2s25f2)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-20" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mvn</span>(<span class="at">data =</span> hw_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<dl>
    <dt>$multivariateNormality</dt>
        <dd>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 1 x 4</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">Test</th>
<th data-quarto-table-cell-role="th" scope="col">HZ</th>
<th data-quarto-table-cell-role="th" scope="col">p value</th>
<th data-quarto-table-cell-role="th" scope="col">MVN</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Henze-Zirkler</td>
<td>1.014463</td>
<td>2.875198e-07</td>
<td>NO</td>
</tr>
</tbody>
</table>

</dd>
    <dt>$univariateNormality</dt>
        <dd>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 13 x 5</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Test</th>
<th data-quarto-table-cell-role="th" scope="col">Variable</th>
<th data-quarto-table-cell-role="th" scope="col">Statistic</th>
<th data-quarto-table-cell-role="th" scope="col">p value</th>
<th data-quarto-table-cell-role="th" scope="col">Normality</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;I&lt;chr&gt;&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>Anderson-Darling</td>
<td>bytxrstd</td>
<td><span style="white-space:pre-wrap"> 2.0702</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>Anderson-Darling</td>
<td>bytxmstd</td>
<td><span style="white-space:pre-wrap"> 3.1087</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>Anderson-Darling</td>
<td>bytxsstd</td>
<td>0.5534</td>
<td>0.1522</td>
<td>YES</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>Anderson-Darling</td>
<td>bytxhstd</td>
<td>1.6028</td>
<td>4e-04</td>
<td>NO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">5</td>
<td>Anderson-Darling</td>
<td><span style="white-space:pre-wrap"> parocc </span></td>
<td><span style="white-space:pre-wrap"> 17.0342</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">6</td>
<td>Anderson-Darling</td>
<td><span style="white-space:pre-wrap"> hw10 </span></td>
<td><span style="white-space:pre-wrap"> 9.8312</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">7</td>
<td>Anderson-Darling</td>
<td><span style="white-space:pre-wrap"> hw12 </span></td>
<td><span style="white-space:pre-wrap"> 5.7268</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">8</td>
<td>Anderson-Darling</td>
<td>eng92</td>
<td>1.4401</td>
<td>0.001</td>
<td>NO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">9</td>
<td>Anderson-Darling</td>
<td>math92</td>
<td>1.1281</td>
<td>0.0058</td>
<td>NO</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">10</td>
<td>Anderson-Darling</td>
<td>sci92</td>
<td>0.7714</td>
<td>0.0445</td>
<td>NO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">11</td>
<td>Anderson-Darling</td>
<td>soc92</td>
<td>1.0731</td>
<td>0.008</td>
<td>NO</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">12</td>
<td>Anderson-Darling</td>
<td>byfaminc</td>
<td><span style="white-space:pre-wrap"> 3.2795</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">13</td>
<td>Anderson-Darling</td>
<td>bypared</td>
<td><span style="white-space:pre-wrap"> 10.0582</span></td>
<td><span style="white-space:pre-wrap"> &lt;0.001 </span></td>
<td><span style="white-space:pre-wrap"> NO </span></td>
</tr>
</tbody>
</table>

</dd>
    <dt>$Descriptives</dt>
        <dd>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 13 x 10</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">n</th>
<th data-quarto-table-cell-role="th" scope="col">Mean</th>
<th data-quarto-table-cell-role="th" scope="col">Std.Dev</th>
<th data-quarto-table-cell-role="th" scope="col">Median</th>
<th data-quarto-table-cell-role="th" scope="col">Min</th>
<th data-quarto-table-cell-role="th" scope="col">Max</th>
<th data-quarto-table-cell-role="th" scope="col">25th</th>
<th data-quarto-table-cell-role="th" scope="col">75th</th>
<th data-quarto-table-cell-role="th" scope="col">Skew</th>
<th data-quarto-table-cell-role="th" scope="col">Kurtosis</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;int&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">bytxrstd</td>
<td>247</td>
<td>52.252498</td>
<td>9.729559</td>
<td>52.744</td>
<td>29.459</td>
<td>67.499</td>
<td>44.2160</td>
<td>61.0010</td>
<td>-0.21638586</td>
<td>-0.9412619</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">bytxmstd</td>
<td>247</td>
<td>52.921267</td>
<td>9.785079</td>
<td>52.593</td>
<td>32.049</td>
<td>70.118</td>
<td>44.5670</td>
<td>60.9505</td>
<td>0.01656429</td>
<td>-1.1789082</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">bytxsstd</td>
<td>247</td>
<td>52.323486</td>
<td>10.027881</td>
<td>52.525</td>
<td>29.079</td>
<td>73.829</td>
<td>45.2340</td>
<td>59.2450</td>
<td>0.03041495</td>
<td>-0.6364867</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">bytxhstd</td>
<td>247</td>
<td>52.560567</td>
<td>9.909501</td>
<td>53.781</td>
<td>25.166</td>
<td>69.508</td>
<td>45.8075</td>
<td>60.7700</td>
<td>-0.38347369</td>
<td>-0.5212263</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">parocc</td>
<td>247</td>
<td>54.081619</td>
<td>20.713100</td>
<td>61.320</td>
<td>7.320</td>
<td>81.870</td>
<td>49.7000</td>
<td>66.1800</td>
<td>-0.82741669</td>
<td>-0.5561309</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">hw10</td>
<td>247</td>
<td>2.627530</td>
<td>1.708102</td>
<td>2.000</td>
<td>0.000</td>
<td>7.000</td>
<td>1.0000</td>
<td>4.0000</td>
<td>0.74801463</td>
<td>-0.2616338</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">hw12</td>
<td>247</td>
<td>3.210526</td>
<td>1.901062</td>
<td>3.000</td>
<td>0.000</td>
<td>8.000</td>
<td>2.0000</td>
<td>4.0000</td>
<td>0.59291685</td>
<td>-0.1371959</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">eng92</td>
<td>247</td>
<td>6.594130</td>
<td>2.344748</td>
<td>7.000</td>
<td>0.500</td>
<td>11.120</td>
<td>4.9000</td>
<td>8.3300</td>
<td>-0.27431510</td>
<td>-0.6372800</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">math92</td>
<td>247</td>
<td>5.943846</td>
<td>2.397474</td>
<td>6.000</td>
<td>0.500</td>
<td>11.120</td>
<td>4.2500</td>
<td>7.7500</td>
<td>-0.12080923</td>
<td>-0.7570884</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">sci92</td>
<td>247</td>
<td>6.252267</td>
<td>2.468523</td>
<td>6.500</td>
<td>0.670</td>
<td>11.330</td>
<td>4.5000</td>
<td>8.0000</td>
<td>-0.14739430</td>
<td>-0.7185309</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">soc92</td>
<td>247</td>
<td>6.708988</td>
<td>2.473552</td>
<td>6.830</td>
<td>0.000</td>
<td>11.000</td>
<td>5.0700</td>
<td>8.6450</td>
<td>-0.32097156</td>
<td>-0.5374977</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">byfaminc</td>
<td>247</td>
<td>10.121457</td>
<td>2.438142</td>
<td>10.000</td>
<td>3.000</td>
<td>15.000</td>
<td>8.0000</td>
<td>12.0000</td>
<td>-0.38695907</td>
<td>-0.1149796</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">bypared</td>
<td>247</td>
<td>3.283401</td>
<td>1.316194</td>
<td>3.000</td>
<td>1.000</td>
<td>6.000</td>
<td>3.0000</td>
<td>4.0000</td>
<td>0.40848247</td>
<td>-0.3096812</td>
</tr>
</tbody>
</table>

</dd>
</dl>
</div>
</div>
<div id="cell-21" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multivariate normality</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>hw_mean2 <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()  <span class="co"># qqplot does not handle missing data</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> hw_mean2, <span class="at">multivariatePlot =</span> <span class="st">"qq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-16-output-1.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-23" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># univariate normality</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> hw_mean, <span class="at">univariatePlot =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-18-output-1.png" width="720" height="720" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-25" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> hw_mean, <span class="at">univariatePlot =</span> <span class="st">"box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message in uniPlot(data, type = univariatePlot):
“Box-Plots are based on standardized values (centered and scaled).”</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-20-output-2.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> hw_mean, <span class="at">mvnTest =</span> <span class="st">"hz"</span>, <span class="at">multivariateOutlierMethod =</span> <span class="st">"adj"</span>)  <span class="co"># show options</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-21-output-1.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>이상치들</p>
<div id="cell-28" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mvn</span>(<span class="at">data =</span> hw_mean, <span class="at">mvnTest =</span> <span class="st">"hz"</span>, <span class="at">multivariateOutlierMethod =</span> <span class="st">"adj"</span>, <span class="at">showOutliers =</span> <span class="cn">TRUE</span>, <span class="at">showNewData =</span> <span class="cn">TRUE</span>)  <span class="co"># show options</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>multivariateOutliers <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 3
  Observation `Mahalanobis Distance` Outlier
  &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;  
1 1                             94.0 TRUE   
2 2                             88.9 TRUE   
3 3                             86.8 TRUE   
4 4                             85.5 TRUE   
5 5                             83.8 TRUE   
6 6                             73.0 TRUE   
# ℹ 56 more rows</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-22-output-2.png" width="480" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>이상치가 제거된 데이터셋</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>newData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="non-normality에-대한-대응" class="level2">
<h2 class="anchored" data-anchor-id="non-normality에-대한-대응">Non-normality에 대한 대응</h2>
<div class="callout callout-style-default callout-note callout-titled" title="Non-normality에 대한 대응">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-normality에 대한 대응
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Robust ML</li>
<li>Bootstrapping</li>
<li>분포에 대한 가정이 없는 방법: WLS(fully weighted least squares)</li>
</ul>
<p><strong>Robust ML 방식</strong><br>
ML 파라미터 추정치는 일반적으로 robust하나, 표준오차는 문제가 될 수 있음.<br>
다음과 같은 ML에 대한 robust estimation들은 표준오차에 대한 보정을 제공함.</p>
<ol type="1">
<li>Option “MLM” is for complete data sets only and generates the mean-adjusted Satorra-Bentler scaled chi-square.</li>
<li>Option “MLR” can be applied in complete or incomplete data sets, and it generates a mean adjusted chi-square based on the Yuan-Bentler T2 statistic. Because this method accommodates missing data, it is the most flexible option listed here.</li>
<li>Option “MLMV” is for complete data sets only and computes a mean- and variance-adjusted scaled chi-square.</li>
<li>Option “MLMVS” generates a mean- and variance adjusted chi-square with a correction for heteroscedasticity by Satterthwaite (1941). Model degrees of freedom are estimated, and the method is for complete data sets.</li>
</ol>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;137, 163, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
<section id="robust-ml" class="level3">
<h3 class="anchored" data-anchor-id="robust-ml">Robust ML</h3>
<p>결측치가 포함된 경우: <code>estimator = "MLR"</code></p>
<ul>
<li>결측치에 대해 FIML(Full Information Maximum Likelihood) 적용</li>
<li>‘Huber-White’ robust standard errors</li>
</ul>
<p>결측치가 없는 경우: <code>estimator = "MLM"</code> or <code>"MLMV"</code> or <code>"MLMVS"</code> - 결측치는 listwise deletion</p>
<div id="cell-33" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>hw_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + byfaminc + bypared</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw12 + hw10</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng92 + math92 + sci92 + soc92</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng92</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math92</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci92</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ soc92</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>sem_fit_robust <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model, <span class="at">data =</span> hw_mean, <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit_robust, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 141 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        35

                                                  Used       Total
  Number of observations                           247         300

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                66.999      67.084
  Degrees of freedom                                56          56
  P-value (Chi-square)                           0.149       0.147
  Scaling correction factor                                  0.999
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              1996.735    1887.529
  Degrees of freedom                                78          78
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.058

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.994       0.994
  Tucker-Lewis Index (TLI)                       0.992       0.991
                                                                  
  Robust Comparative Fit Index (CFI)                         0.994
  Robust Tucker-Lewis Index (TLI)                            0.992

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -8046.960   -8046.960
  Scaling correction factor                                  1.030
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)             NA          NA
  Scaling correction factor                                  1.011
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               16163.920   16163.920
  Bayesian (BIC)                             16286.748   16286.748
  Sample-size adjusted Bayesian (SABIC)      16175.799   16175.799

Root Mean Square Error of Approximation:

  RMSEA                                          0.028       0.028
  90 Percent confidence interval - lower         0.000       0.000
  90 Percent confidence interval - upper         0.051       0.051
  P-value H_0: RMSEA &lt;= 0.050                    0.942       0.942
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.028
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.051
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.942
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.028       0.028

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              15.208    0.736
    byfaminc          0.127    0.010   13.060    0.000    1.931    0.794
    bypared           0.074    0.006   12.172    0.000    1.125    0.856
  prevach =~                                                            
    bytxrstd          1.000                               8.238    0.848
    bytxmstd          1.010    0.057   17.831    0.000    8.320    0.852
    bytxsstd          1.022    0.063   16.195    0.000    8.422    0.841
    bytxhstd          1.003    0.060   16.634    0.000    8.261    0.837
  hw =~                                                                 
    hw12              1.000                               1.221    0.644
    hw10              1.045    0.165    6.351    0.000    1.276    0.749
  grades =~                                                             
    eng92             1.000                               2.093    0.895
    math92            0.845    0.057   14.749    0.000    1.769    0.742
    sci92             0.995    0.050   19.888    0.000    2.082    0.845
    soc92             1.057    0.044   23.791    0.000    2.213    0.895

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.320    0.038    8.384    0.000    0.591    0.591
  grades ~                                                              
    prevach           0.109    0.021    5.192    0.000    0.431    0.431
    hw                0.562    0.168    3.341    0.001    0.328    0.328
  hw ~                                                                  
    prevach           0.055    0.017    3.275    0.001    0.368    0.368
    famback           0.018    0.009    1.995    0.046    0.225    0.225

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng92             0.079    0.523    0.151    0.880    0.079    0.015
 .bytxmstd ~~                                                           
   .math92            2.081    0.570    3.651    0.000    2.081    0.255
 .bytxsstd ~~                                                           
   .sci92             0.249    0.694    0.360    0.719    0.249    0.035
 .bytxhstd ~~                                                           
   .soc92             0.424    0.645    0.657    0.511    0.424    0.071

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          196.008   21.642    9.057    0.000  196.008    0.459
   .byfaminc          2.191    0.297    7.375    0.000    2.191    0.370
   .bypared           0.460    0.081    5.710    0.000    0.460    0.267
   .bytxrstd         26.465    4.083    6.482    0.000   26.465    0.281
   .bytxmstd         26.038    2.975    8.753    0.000   26.038    0.273
   .bytxsstd         29.285    3.609    8.114    0.000   29.285    0.292
   .bytxhstd         29.231    3.951    7.398    0.000   29.231    0.300
   .hw12              2.107    0.273    7.723    0.000    2.107    0.585
   .hw10              1.277    0.269    4.737    0.000    1.277    0.439
   .eng92             1.092    0.155    7.060    0.000    1.092    0.200
   .math92            2.550    0.254   10.026    0.000    2.550    0.449
   .sci92             1.742    0.205    8.511    0.000    1.742    0.287
   .soc92             1.221    0.195    6.254    0.000    1.221    0.200
    famback         231.288   32.809    7.049    0.000    1.000    1.000
   .prevach          44.162    5.703    7.743    0.000    0.651    0.651
   .hw                1.068    0.280    3.810    0.000    0.716    0.716
   .grades            2.476    0.350    7.079    0.000    0.565    0.565
</code></pre>
</div>
</div>
</section>
<section id="bootstrapping" class="level3">
<h3 class="anchored" data-anchor-id="bootstrapping">Bootstrapping</h3>
<ul>
<li>표본 수가 작은 경우 (n &lt; 100) 사용하기 어려움.</li>
<li>ML로 얻은 파라미터 추정치에 대한 표준오차(se)를 bootstrap을 통해 추정
<ul>
<li>naive bootstrap: <code>se = "bootstrap"</code></li>
</ul></li>
<li>Chi-square test의 경우 Bollen-Stine bootstrap: <code>test = "bootstrap"</code>
<ul>
<li>데이터를 완전한 모형이 되도록 변형 후 bootstrap 수행</li>
<li>즉, 변형된 데이터에서 <span class="math inline">\(\mathbf{S}\)</span> = <span class="math inline">\(\hat{\Sigma}(\theta)\)</span> (단, 분포의 변형은 없음)</li>
<li>결측치가 있는 경우, 특화된 함수를 시용: semTools 패키지의 <code>bsBootMiss()</code></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Bootstrap standard errors">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrap standard errors
</div>
</div>
<div class="callout-body-container callout-body">
<p>If “boot” or “bootstrap”, bootstrap standard errors are computed using standard bootstrapping (unless Bollen-Stine bootstrapping is requested for the test statistic; in this case bootstrap standard errors are computed using model-based bootstrapping).</p>
</div>
</div>
<p>파라미터 추정치에 대한 표준오차는 <code>se = "bootstrap"</code>을 사용하여 보통의 naive/ordinary bootstrap을 수행해 계산할 수 있음.</p>
<div id="cell-36" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sem_fit_boot <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  hw_model,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_mean,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">"bootstrap"</span>, <span class="co"># standard errors</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">"FIML"</span>, <span class="co"># missing data handling</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">1000</span>, <span class="co"># number of bootstrap samples; default</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">iseed =</span> <span class="dv">1234</span> <span class="co"># for reproducibility</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit_boot, <span class="at">standardized =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 175 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        48

  Number of observations                           300
  Number of missing patterns                        18

Model Test User Model:
                                                      
  Test statistic                                68.247
  Degrees of freedom                                56
  P-value (Chi-square)                           0.126

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              16.913    0.774
    byfaminc          0.131    0.008   15.586    0.000    2.211    0.808
    bypared           0.066    0.005   13.718    0.000    1.108    0.829
  prevach =~                                                            
    bytxrstd          1.000                               8.630    0.858
    bytxmstd          0.980    0.050   19.448    0.000    8.457    0.856
    bytxsstd          0.977    0.055   17.824    0.000    8.430    0.847
    bytxhstd          0.965    0.053   18.245    0.000    8.330    0.844
  hw =~                                                                 
    hw12              1.000                               1.276    0.669
    hw10              0.963    0.157    6.145    0.000    1.228    0.714
  grades =~                                                             
    eng92             1.000                               2.466    0.915
    math92            0.853    0.044   19.443    0.000    2.105    0.798
    sci92             0.959    0.043   22.426    0.000    2.366    0.870
    soc92             1.044    0.034   30.901    0.000    2.574    0.917

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.304    0.034    8.864    0.000    0.596    0.596
  grades ~                                                              
    prevach           0.130    0.024    5.503    0.000    0.453    0.453
    hw                0.667    0.225    2.969    0.003    0.345    0.345
  hw ~                                                                  
    prevach           0.044    0.016    2.822    0.005    0.300    0.300
    famback           0.022    0.008    2.760    0.006    0.295    0.295

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng92             0.232    0.501    0.463    0.643    0.232    0.042
 .bytxmstd ~~                                                           
   .math92            1.899    0.514    3.692    0.000    1.899    0.234
 .bytxsstd ~~                                                           
   .sci92             0.260    0.610    0.427    0.669    0.260    0.037
 .bytxhstd ~~                                                           
   .soc92             0.204    0.600    0.339    0.734    0.204    0.034

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           52.406    1.257   41.697    0.000   52.406    2.398
   .byfaminc          9.844    0.159   61.949    0.000    9.844    3.599
   .bypared           3.216    0.076   42.258    0.000    3.216    2.407
   .bytxrstd         51.337    0.595   86.307    0.000   51.337    5.105
   .bytxmstd         52.177    0.580   90.024    0.000   52.177    5.280
   .bytxsstd         51.627    0.592   87.252    0.000   51.627    5.189
   .bytxhstd         51.796    0.585   88.541    0.000   51.796    5.245
   .hw12              3.115    0.113   27.661    0.000    3.115    1.634
   .hw10              2.536    0.104   24.465    0.000    2.536    1.474
   .eng92             6.130    0.154   39.751    0.000    6.130    2.276
   .math92            5.534    0.153   36.256    0.000    5.534    2.100
   .sci92             5.846    0.156   37.569    0.000    5.846    2.149
   .soc92             6.283    0.163   38.516    0.000    6.283    2.238

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          191.591   19.789    9.682    0.000  191.591    0.401
   .byfaminc          2.592    0.363    7.134    0.000    2.592    0.346
   .bypared           0.557    0.074    7.567    0.000    0.557    0.312
   .bytxrstd         26.646    3.843    6.933    0.000   26.646    0.264
   .bytxmstd         26.119    2.859    9.136    0.000   26.119    0.267
   .bytxsstd         27.924    3.202    8.721    0.000   27.924    0.282
   .bytxhstd         28.116    3.551    7.917    0.000   28.116    0.288
   .hw12              2.008    0.301    6.667    0.000    2.008    0.552
   .hw10              1.453    0.284    5.124    0.000    1.453    0.491
   .eng92             1.175    0.145    8.101    0.000    1.175    0.162
   .math92            2.519    0.226   11.162    0.000    2.519    0.363
   .sci92             1.800    0.190    9.487    0.000    1.800    0.243
   .soc92             1.257    0.181    6.950    0.000    1.257    0.159
    famback         286.051   33.754    8.474    0.000    1.000    1.000
   .prevach          48.024    5.646    8.506    0.000    0.645    0.645
   .hw                1.168    0.330    3.544    0.000    0.718    0.718
   .grades            3.202    0.378    8.481    0.000    0.526    0.526
</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Bootstrap Confidence Intervals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrap Confidence Intervals
</div>
</div>
<div class="callout-body-container callout-body">
<p>lavaan의 <code>standardizedSolution()</code> 함수의 ci값이 percentile bootstrap confidence intervals이 아니라고 하니, 다음 함수를 사용하는 것을 권장</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semhelpinghands)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">standardizedSolution_boot_ci</span>(sem_fit_boot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Chi-square test의 경우 Bollen-Stine bootstrap을 적용; <code>test = "bootstrap"</code></p>
<div id="cell-39" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sem_fit_boot <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  hw_model,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_mean,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="st">"bootstrap"</span>, <span class="co"># model test</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="dv">1000</span>, <span class="co"># number of bootstrap samples; default</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">iseed =</span> <span class="dv">1234</span>, <span class="co"># for reproducibility</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit_boot, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">estimates =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 141 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        35

                                                  Used       Total
  Number of observations                           247         300

Model Test User Model:
                                                      
  Test statistic                                66.999
  Degrees of freedom                                56
  P-value (Chi-square)                           0.149
                                                      
  Test statistic                                66.999
  Degrees of freedom                                56
  P-value (Bollen-Stine bootstrap)               0.202

Model Test Baseline Model:

  Test statistic                              1996.735
  Degrees of freedom                                78
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.994
  Tucker-Lewis Index (TLI)                       0.992

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -8046.960
  Loglikelihood unrestricted model (H1)             NA
                                                      
  Akaike (AIC)                               16163.920
  Bayesian (BIC)                             16286.748
  Sample-size adjusted Bayesian (SABIC)      16175.799

Root Mean Square Error of Approximation:

  RMSEA                                          0.028
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.051
  P-value H_0: RMSEA &lt;= 0.050                    0.942
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.028</code></pre>
</div>
</div>
<p>결측치가 포함된 경우 이에 특화된 <code>bsBootMiss()</code>함수를 사용</p>
<div id="cell-41" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  hw_model, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_mean, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">meanstructure =</span> <span class="cn">TRUE</span>, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">"FIML"</span> <span class="co"># missing data handling</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>bsboot <span class="ot">&lt;-</span> <span class="fu">bsBootMiss</span>(fit, <span class="at">nBoot =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">1234</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bsboot) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |==================================================| 100%
Time elapsed to transform the data:
Time difference of 0.220299 secs

Time elapsed to fit the model to 1000 bootstrapped samples:
Time difference of 6.22466 mins

Mean of Theoretical Distribution = DF = 56 
Variance of Theoretical Distribution = 2*DF = 112 

Mean of Bootstrap Distribution = 59.32232 
Variance of Bootstrap Distribution = 164.2552 

Chi-Squared = 68.24697
Degrees of Freedom = 56
Theoretical p value = 0.1262701
    i.e., pchisq(68.24697, df = 56, lower.tail = FALSE)

Bootstrapped p value = 0.217

Chi-Squared = 68.24697
Degrees of Freedom = 56
Theoretical p value = 0.1262701
    i.e., pchisq(68.24697, df = 56, lower.tail = FALSE)

Bootstrapped p value = 0.217
</code></pre>
</div>
</div>
<div id="cell-43" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bsboot, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">legendArgs =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"topleft"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-28-output-1.png" width="720" height="540" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="분포에-대한-가정이-없는-방법" class="level3">
<h3 class="anchored" data-anchor-id="분포에-대한-가정이-없는-방법">분포에 대한 가정이 없는 방법</h3>
<p>WLS (fully weighted least squares); <code>estimator = "WLS"</code><br>
also called ADF (Asymptotically Distribution-Free) estimator: 부정적인 견해 존재; p.&nbsp;141, Klein, R. B. (2023)</p>
<div id="cell-45" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="357">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sem_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model, <span class="at">data =</span> hw_mean, <span class="at">estimator =</span> <span class="st">"WLS"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 229 iterations

  Estimator                                        WLS
  Optimization method                           NLMINB
  Number of model parameters                        35

                                                  Used       Total
  Number of observations                           247         300

Model Test User Model:
                                                      
  Test statistic                                90.176
  Degrees of freedom                                56
  P-value (Chi-square)                           0.003

Model Test Baseline Model:

  Test statistic                               733.895
  Degrees of freedom                                78
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.948
  Tucker-Lewis Index (TLI)                       0.927

Root Mean Square Error of Approximation:

  RMSEA                                          0.050
  90 Percent confidence interval - lower         0.030
  90 Percent confidence interval - upper         0.068
  P-value H_0: RMSEA &lt;= 0.050                    0.485
  P-value H_0: RMSEA &gt;= 0.080                    0.003

Standardized Root Mean Square Residual:

  SRMR                                           0.040

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              15.912    0.780
    byfaminc          0.121    0.008   15.623    0.000    1.923    0.788
    bypared           0.074    0.005   15.043    0.000    1.170    0.875
  prevach =~                                                            
    bytxrstd          1.000                               8.547    0.877
    bytxmstd          1.004    0.044   22.584    0.000    8.585    0.869
    bytxsstd          0.967    0.047   20.609    0.000    8.262    0.859
    bytxhstd          0.985    0.044   22.480    0.000    8.417    0.862
  hw =~                                                                 
    hw12              1.000                               1.092    0.600
    hw10              1.206    0.186    6.498    0.000    1.317    0.810
  grades =~                                                             
    eng92             1.000                               2.109    0.923
    math92            0.827    0.048   17.197    0.000    1.744    0.725
    sci92             0.980    0.042   23.289    0.000    2.066    0.855
    soc92             1.038    0.040   26.001    0.000    2.189    0.889

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.286    0.029    9.966    0.000    0.532    0.532
  grades ~                                                              
    prevach           0.110    0.016    6.713    0.000    0.447    0.447
    hw                0.616    0.156    3.959    0.000    0.319    0.319
  hw ~                                                                  
    prevach           0.048    0.013    3.708    0.000    0.375    0.375
    famback           0.012    0.006    2.162    0.031    0.179    0.179

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng92            -0.304    0.437   -0.694    0.487   -0.304   -0.074
 .bytxmstd ~~                                                           
   .math92            2.510    0.456    5.501    0.000    2.510    0.310
 .bytxsstd ~~                                                           
   .sci92            -0.656    0.513   -1.277    0.202   -0.656   -0.106
 .bytxhstd ~~                                                           
   .soc92             0.177    0.520    0.340    0.734    0.177    0.032

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          163.471   17.751    9.209    0.000  163.471    0.392
   .byfaminc          2.258    0.240    9.422    0.000    2.258    0.379
   .bypared           0.418    0.071    5.892    0.000    0.418    0.234
   .bytxrstd         21.834    3.150    6.932    0.000   21.834    0.230
   .bytxmstd         23.842    2.478    9.623    0.000   23.842    0.244
   .bytxsstd         24.190    2.637    9.173    0.000   24.190    0.262
   .bytxhstd         24.578    3.007    8.173    0.000   24.578    0.258
   .hw12              2.117    0.217    9.760    0.000    2.117    0.640
   .hw10              0.910    0.255    3.566    0.000    0.910    0.344
   .eng92             0.770    0.125    6.178    0.000    0.770    0.148
   .math92            2.747    0.211   12.997    0.000    2.747    0.475
   .sci92             1.571    0.155   10.148    0.000    1.571    0.269
   .soc92             1.272    0.163    7.802    0.000    1.272    0.210
    famback         253.186   28.024    9.035    0.000    1.000    1.000
   .prevach          52.345    4.815   10.872    0.000    0.717    0.717
   .hw                0.902    0.201    4.483    0.000    0.756    0.756
   .grades            2.509    0.293    8.569    0.000    0.564    0.564
</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="missing-data" class="level1">
<h1>Missing Data</h1>
<p><strong>결측치 분류</strong></p>
<ul>
<li>MCAR: Missing Completely At Random; 결측이 특정 변수와 전혀 상관없는 경우; 매우 드물다고 봄</li>
<li>MAR: Missing At Random; 결측의 패턴이 다른 변수와 상관이 있지만 결측된 변수의 값과는 상관이 없는 경우; 다른 변수에 의해 설명될 수 있음</li>
<li>MNAR: Missing Not At Random; 결측이 해당 변수의 값과 연관이 있을 때;
<ul>
<li>우울 수준이 높은 사람들이 자신의 우울감을 보고하기를 꺼리는 경우,</li>
<li>수입이 낮은/높은 사람들이 자신의 수입을 보고하기를 꺼리는 경우 등</li>
</ul></li>
</ul>
<p><strong>결측치에 대한 처리</strong></p>
<ul>
<li>Listwise deletion / Pairwise deletion</li>
<li>Full Information Maximum Likelihood (FIML): 결측치를 포함한 모든 데이터를 이용</li>
<li>Imputation (결측치 대체)
<ul>
<li>Multivariate Imputation by Chained Equations (MICE)가 가장 우수한 것으로 알려져 있음</li>
<li><code>mice</code> package <a href="https://stefvanbuuren.name/fimd/">참고 서적</a></li>
<li>ML 기반이 아닌 estimator를 사용할 때 용이함.</li>
</ul></li>
<li>대체로 FIML과 MICE가 유사한 결과를 얻음.</li>
<li>Machine learning 기반 방법도 있음: random forest, k-nearest neighbors, …</li>
</ul>
<p><strong>결측치에 대한 시각화</strong>: <code>naniar</code> package; <a href="https://cran.r-project.org/web/packages/naniar/vignettes/naniar-visualisation.html">Missing Data Visualisations</a>, <a href="https://cran.r-project.org/web/packages/naniar/vignettes/getting-started-w-naniar.html">Getting Started with naniar</a></p>
<div id="cell-47" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="297">
<details class="code-fold">
<summary>Load data</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/chap 19 latent means/Homework means.sav"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">hw10 =</span> f1s36a2, <span class="at">hw12 =</span> f2s25f2)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-50" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="300">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(hw_mean) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>── Data Summary ────────────────────────
                           Values 
Name                       hw_mean
Number of rows             300    
Number of columns          15     
_______________________           
Column type frequency:            
  numeric                  15     
________________________          
Group variables            None   

── Variable type: numeric ────────────────────────────────────────────────────────────────
   skim_variable n_missing complete_rate   mean     sd    p0   p25   p50   p75 p100 hist 
 1 bytxrstd              6         0.98  51.3   10.0   29.5  43.1  50.7  59.2  67.5 ▃▆▇▇▇
 2 bytxmstd              6         0.98  52.2    9.87  32.0  44.3  51.4  60.7  70.1 ▃▇▆▆▆
 3 bytxsstd              7         0.977 51.6    9.93  29.1  44.7  51.2  58.1  73.8 ▂▆▇▆▂
 4 bytxhstd              7         0.977 51.8    9.86  25.2  45.2  52.1  60.8  69.5 ▁▅▇▇▇
 5 parocc                2         0.993 52.5   21.9    7.32 27.4  61.3  66.2  81.9 ▃▁▁▇▂
 6 hw10                 15         0.95   2.60   1.70   0     1     2     4     7   ▇▇▆▂▂
 7 ethnic                4         0.987  0.784  0.412  0     1     1     1     1   ▂▁▁▁▇
 8 hw12                 28         0.907  3.19   1.89   0     2     3     4     8   ▂▇▂▃▁
 9 eng92                 4         0.987  6.16   2.68   0     4.22  6.5   8.25 11.2 ▂▅▅▇▃
10 math92                4         0.987  5.56   2.63   0     3.5   5.5   7.5  11.1 ▃▆▇▇▃
11 sci92                 4         0.987  5.87   2.71   0     3.91  6     8    11.3 ▃▆▇▇▃
12 soc92                 4         0.987  6.31   2.80   0     4.55  6.33  8.57 11   ▂▅▇▇▆
13 Female                0         1      0.503  0.501  0     0     1     1     1   ▇▁▁▁▇
14 byfaminc             10         0.967  9.82   2.73   2     8    10    12    15   ▁▂▃▇▂
15 bypared               1         0.997  3.21   1.34   1     2     3     4     6   ▅▇▂▂▂</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="301">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-53" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="303">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치 요약 시각화</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(hw_mean, <span class="at">facet =</span> ethnic)  <span class="co"># by ethnic group</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-36-output-1.png" width="630" height="360" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-55" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="305">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 개별 결측치, 군집화 패턴 확인</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(hw_mean, <span class="at">cluster =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-38-output-1.png" width="720" height="450" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-57" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="307">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 함께 누락된 변수들의 패턴 확인</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_upset</span>(hw_mean, <span class="at">nsets =</span> <span class="fu">n_var_miss</span>(hw_mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-40-output-1.png" width="800" height="600" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>결측치에 대한 패턴</strong></p>
<p>학업 성취도가 낮은 아이들의 경우 숙제를 한 시간을 보고하지 않는 경향이 있을 수 있다는 의심하에,<br>
다음과 같이 대략 세 변수에 대해 결측치 여부를 나타내는 변수를 추가하여, 다른 변수들과의 상관계수를 살펴보면,</p>
<div id="cell-59" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="308">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a variable to the dataset that indicates the missingness</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_reading =</span> <span class="fu">is.na</span>(bytxrstd),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_hw12 =</span> <span class="fu">is.na</span>(hw12),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_hw10 =</span> <span class="fu">is.na</span>(hw10)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-60" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="309">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">lowerCor</span>(hw_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 bytxr bytxm bytxs bytxh parcc hw10  ethnc hw12  eng92 mth92 sci92 soc92
bytxrstd          1.00                                                                  
bytxmstd          0.73  1.00                                                            
bytxsstd          0.71  0.73  1.00                                                      
bytxhstd          0.73  0.71  0.74  1.00                                                
parocc            0.37  0.41  0.32  0.35  1.00                                          
hw10              0.25  0.29  0.26  0.30  0.21  1.00                                    
ethnic            0.28  0.28  0.30  0.31  0.29  0.13  1.00                              
hw12              0.30  0.29  0.24  0.23  0.21  0.47  0.00  1.00                        
eng92             0.53  0.47  0.43  0.42  0.37  0.34  0.27  0.30  1.00                  
math92            0.48  0.50  0.38  0.37  0.29  0.25  0.20  0.26  0.71  1.00            
sci92             0.50  0.47  0.42  0.38  0.31  0.28  0.25  0.30  0.79  0.74  1.00      
soc92             0.54  0.49  0.45  0.44  0.35  0.36  0.24  0.33  0.85  0.71  0.79  1.00
Female           -0.14  0.01  0.09  0.09 -0.04 -0.05 -0.05 -0.01 -0.23 -0.04 -0.08 -0.14
byfaminc          0.38  0.43  0.40  0.39  0.63  0.23  0.36  0.21  0.36  0.28  0.32  0.38
bypared           0.44  0.43  0.44  0.39  0.64  0.28  0.30  0.26  0.39  0.34  0.36  0.37
missing_reading*    NA    NA    NA    NA -0.01  0.01 -0.04 -0.02  0.05  0.01  0.01  0.03
missing_hw12*    -0.25 -0.19 -0.20 -0.19 -0.24 -0.02 -0.12    NA -0.39 -0.32 -0.34 -0.36
missing_hw10*    -0.21 -0.12 -0.09 -0.11 -0.15    NA -0.10 -0.08 -0.40 -0.31 -0.32 -0.40
                 Femal byfmn byprd mss_* m_12* m_10*
Female            1.00                              
byfaminc          0.13  1.00                        
bypared           0.01  0.66  1.00                  
missing_reading* -0.05 -0.03  0.01  1.00            
missing_hw12*     0.04 -0.28 -0.11 -0.05  1.00      
missing_hw10*     0.04 -0.24 -0.12 -0.03  0.40  1.00</code></pre>
</div>
</div>
<div id="cell-62" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="311">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hw_mean, <span class="fu">aes</span>(<span class="at">x =</span> missing_hw12, <span class="at">y =</span> eng92)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha=</span>.<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-44-output-1.png" width="400" height="320" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-63" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="312">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hw_mean, <span class="fu">aes</span>(<span class="at">x =</span> hw12, <span class="at">y =</span> eng92)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_miss_point</span>(<span class="at">jitter =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-45-output-1.png" width="400" height="320" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="fiml" class="level3">
<h3 class="anchored" data-anchor-id="fiml">FIML</h3>
<p>Full Information Maximum Likelihood</p>
<ul>
<li>결측치를 제거하지 않고 모든 관측치를 이용</li>
<li>각 관측치(case) 별로 결측치가 없는 변수들로만 이루어진 공분산 행렬로 log-likelihood를 계산하여 합산하는 방식</li>
<li>MNAR(missing not at random)에 대해서는 부적절할 수 있음.</li>
</ul>
<div id="cell-65" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="313">
<details class="code-fold">
<summary>Load data</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/chap 19 latent means/Homework means.sav"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">hw10 =</span> f1s36a2, <span class="at">hw12 =</span> f2s25f2) <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  labelled<span class="sc">::</span><span class="fu">remove_labels</span>()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-66" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="314">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NA가 하나라도 포함된 행들만 추출</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(hw_mean)) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 15
  bytxrstd bytxmstd bytxsstd bytxhstd parocc  hw10 ethnic  hw12 eng92 math92 sci92 soc92
     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     46.4     55.2     46.7     42.4   NA      NA      0     2  1.29   0.4   0.4   0.67
2     46.2     50.2     51.1     61.0   15.6     0      1    NA  3.33  NA     0     0   
3     48.4     45.4     62.4     48.8   66.2     1      1     6  1.8    1.5   3.25  3.78
4     59.1     44.7     NA       NA     56.3     3      0     4  8.6    7.25 10.2   9   
5     35.8     32.6     42.5     35.3   56.3    NA      1     1  0.56   3     1.37  0.75
6     37.0     44.4     48.8     52.1   20.3    NA      1     0  0.78   0     1.75  1.29
# ℹ 49 more rows
# ℹ 3 more variables: Female &lt;dbl&gt;, byfaminc &lt;dbl&gt;, bypared &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="cell-67" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="315">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>hw_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + byfaminc + bypared</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw12 + hw10</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng92 + math92 + sci92 + soc92</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng92</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math92</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci92</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ soc92</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>sem_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_mean,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>,  <span class="co"># robust ML for non-normal data</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">"FIML"</span>  <span class="co"># FIML for missing data; "MLR"일 때 자동으로 FIML로 설정됨</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 175 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        48

  Number of observations                           300
  Number of missing patterns                        18

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                68.247      67.485
  Degrees of freedom                                56          56
  P-value (Chi-square)                           0.126       0.140
  Scaling correction factor                                  1.011
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2543.132    2388.205
  Degrees of freedom                                78          78
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.065

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.995       0.995
  Tucker-Lewis Index (TLI)                       0.993       0.993
                                                                  
  Robust Comparative Fit Index (CFI)                         0.995
  Robust Tucker-Lewis Index (TLI)                            0.993

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -9645.718   -9645.718
  Scaling correction factor                                  1.013
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -9611.594   -9611.594
  Scaling correction factor                                  1.012
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               19387.435   19387.435
  Bayesian (BIC)                             19565.217   19565.217
  Sample-size adjusted Bayesian (SABIC)      19412.989   19412.989

Root Mean Square Error of Approximation:

  RMSEA                                          0.027       0.026
  90 Percent confidence interval - lower         0.000       0.000
  90 Percent confidence interval - upper         0.047       0.046
  P-value H_0: RMSEA &lt;= 0.050                    0.973       0.977
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.027
  90 Percent confidence interval - lower                     0.000
  90 Percent confidence interval - upper                     0.048
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.965
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.030       0.030

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              16.913    0.774
    byfaminc          0.131    0.008   15.828    0.000    2.211    0.808
    bypared           0.066    0.005   13.734    0.000    1.108    0.829
  prevach =~                                                            
    bytxrstd          1.000                               8.630    0.858
    bytxmstd          0.980    0.049   19.853    0.000    8.457    0.856
    bytxsstd          0.977    0.053   18.505    0.000    8.430    0.847
    bytxhstd          0.965    0.052   18.668    0.000    8.330    0.844
  hw =~                                                                 
    hw12              1.000                               1.276    0.669
    hw10              0.963    0.148    6.496    0.000    1.228    0.714
  grades =~                                                             
    eng92             1.000                               2.466    0.915
    math92            0.853    0.043   19.977    0.000    2.105    0.798
    sci92             0.959    0.042   23.062    0.000    2.366    0.870
    soc92             1.044    0.034   31.117    0.000    2.574    0.917

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.304    0.033    9.233    0.000    0.596    0.596
  grades ~                                                              
    prevach           0.130    0.022    5.923    0.000    0.453    0.453
    hw                0.667    0.194    3.445    0.001    0.345    0.345
  hw ~                                                                  
    prevach           0.044    0.016    2.844    0.004    0.300    0.300
    famback           0.022    0.008    2.749    0.006    0.295    0.295

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng92             0.232    0.503    0.462    0.644    0.232    0.042
 .bytxmstd ~~                                                           
   .math92            1.899    0.517    3.670    0.000    1.899    0.234
 .bytxsstd ~~                                                           
   .sci92             0.260    0.611    0.426    0.670    0.260    0.037
 .bytxhstd ~~                                                           
   .soc92             0.204    0.581    0.350    0.726    0.204    0.034

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           52.406    1.267   41.367    0.000   52.406    2.398
   .byfaminc          9.844    0.159   61.966    0.000    9.844    3.599
   .bypared           3.216    0.077   41.634    0.000    3.216    2.407
   .bytxrstd         51.337    0.584   87.842    0.000   51.337    5.105
   .bytxmstd         52.177    0.575   90.798    0.000   52.177    5.280
   .bytxsstd         51.627    0.579   89.200    0.000   51.627    5.189
   .bytxhstd         51.796    0.575   90.130    0.000   51.796    5.245
   .hw12              3.115    0.116   26.946    0.000    3.115    1.634
   .hw10              2.536    0.101   25.024    0.000    2.536    1.474
   .eng92             6.130    0.156   39.189    0.000    6.130    2.276
   .math92            5.534    0.153   36.156    0.000    5.534    2.100
   .sci92             5.846    0.158   37.113    0.000    5.846    2.149
   .soc92             6.283    0.163   38.656    0.000    6.283    2.238

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          191.591   20.296    9.440    0.000  191.591    0.401
   .byfaminc          2.592    0.347    7.467    0.000    2.592    0.346
   .bypared           0.557    0.074    7.510    0.000    0.557    0.312
   .bytxrstd         26.646    3.670    7.261    0.000   26.646    0.264
   .bytxmstd         26.119    2.726    9.581    0.000   26.119    0.267
   .bytxsstd         27.924    3.161    8.834    0.000   27.924    0.282
   .bytxhstd         28.116    3.469    8.105    0.000   28.116    0.288
   .hw12              2.008    0.287    7.004    0.000    2.008    0.552
   .hw10              1.453    0.273    5.330    0.000    1.453    0.491
   .eng92             1.175    0.147    7.971    0.000    1.175    0.162
   .math92            2.519    0.230   10.975    0.000    2.519    0.363
   .sci92             1.800    0.192    9.397    0.000    1.800    0.243
   .soc92             1.257    0.183    6.879    0.000    1.257    0.159
    famback         286.051   32.782    8.726    0.000    1.000    1.000
   .prevach          48.024    5.785    8.302    0.000    0.645    0.645
   .hw                1.168    0.305    3.828    0.000    0.718    0.718
   .grades            3.202    0.386    8.302    0.000    0.526    0.526
</code></pre>
</div>
</div>
</section>
<section id="imputation" class="level3">
<h3 class="anchored" data-anchor-id="imputation">Imputation</h3>
<ul>
<li>semTools에서 제공하는 imputation이 통합된 lavaan 함수를 이용하면; <code>sem.mi()</code>
<ul>
<li>MICE를 이용해 회귀모형에 기반해 결측치를 추정한 여러 셋트의 데이터를 생성 후 평균내는 방식</li>
</ul></li>
<li>Machine learning 기반의 알고리즘들로 직접 결측값을 채워 새로운 데이터셋을 생성한 후 분석할 수도 있음.</li>
</ul>
<div id="cell-69" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="5">
<details class="code-fold">
<summary>Load data</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/chap 19 latent means/Homework means.sav"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">hw10 =</span> f1s36a2, <span class="at">hw12 =</span> f2s25f2) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  labelled<span class="sc">::</span><span class="fu">remove_labels</span>()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="ot">&lt;-</span> hw_mean <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-70" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="317">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>hw_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + byfaminc + bypared</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw12 + hw10</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng92 + math92 + sci92 + soc92</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng92</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math92</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci92</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ soc92</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>pred_mat <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">quickpred</span>(hw_mean, <span class="at">mincor =</span> <span class="fl">0.25</span>)  <span class="co"># r &gt; 0.25인 변수만 사용</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>sem_fit <span class="ot">&lt;-</span> <span class="fu">sem.mi</span>(hw_model,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> hw_mean,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimator =</span> <span class="st">"MLM"</span>,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">miPackage =</span> <span class="st">"mice"</span>, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">seed =</span> <span class="dv">123</span>,  <span class="co"># mice 패키지 사용</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">miArgs =</span> <span class="fu">list</span>(<span class="at">predictorMatrix =</span> pred_mat)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-71" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="318">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan.mi object based on 10 imputed data sets. 
See class?lavaan.mi help page for available methods. 

Convergence information:
The model converged on 10 imputed data sets 

Rubin's (1987) rules were used to pool point and SE estimates across 10 imputed data sets, and to calculate degrees of freedom for each parameter's t test and CI.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Test User Model:

                                              Standard      Scaled
  Test statistic                                66.798      66.063
  Degrees of freedom                                56          56
  P-value                                        0.153       0.168
  Average scaling correction factor                          1.011

Model Test Baseline Model:

  Test statistic                              2483.002    2485.266
  Degrees of freedom                                78          78
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.999

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.996       0.996
  Tucker-Lewis Index (TLI)                       0.994       0.994
                                                                  
  Robust Comparative Fit Index (CFI)                         0.996
  Robust Tucker-Lewis Index (TLI)                            1.000

Root Mean Square Error of Approximation:

  RMSEA                                          0.025       0.024
  Confidence interval - lower                    0.000       0.000
  Confidence interval - upper                    0.046       0.000
  P-value H_0: RMSEA &lt;= 0.05                     0.979       0.982
                                                                  
  Robust RMSEA                                               0.025
  Confidence interval - lower                                0.000
  Confidence interval - upper                                0.046

Standardized Root Mean Square Residual:

  SRMR                                           0.032       0.032</code></pre>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A lavaan.parameterEstimates: 39 x 12</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">lhs</th>
<th data-quarto-table-cell-role="th" scope="col">op</th>
<th data-quarto-table-cell-role="th" scope="col">rhs</th>
<th data-quarto-table-cell-role="th" scope="col">exo</th>
<th data-quarto-table-cell-role="th" scope="col">est</th>
<th data-quarto-table-cell-role="th" scope="col">se</th>
<th data-quarto-table-cell-role="th" scope="col">t</th>
<th data-quarto-table-cell-role="th" scope="col">df</th>
<th data-quarto-table-cell-role="th" scope="col">pvalue</th>
<th data-quarto-table-cell-role="th" scope="col">std.lv</th>
<th data-quarto-table-cell-role="th" scope="col">std.all</th>
<th data-quarto-table-cell-role="th" scope="col">label</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;int&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;lvn.vctr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>famback</td>
<td>=~</td>
<td>parocc</td>
<td>0</td>
<td>1.00000000</td>
<td>0.000000000</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>16.9496168</td>
<td>0.77384914</td>
<td></td>
</tr>
<tr class="even">
<td>famback</td>
<td>=~</td>
<td>byfaminc</td>
<td>0</td>
<td>0.13121803</td>
<td>0.008381035</td>
<td>15.6565414</td>
<td>Inf</td>
<td>2.997617e-55</td>
<td>2.2240953</td>
<td>0.81112072</td>
<td></td>
</tr>
<tr class="odd">
<td>famback</td>
<td>=~</td>
<td>bypared</td>
<td>0</td>
<td>0.06524749</td>
<td>0.004744518</td>
<td>13.7521842</td>
<td>Inf</td>
<td>4.941480e-43</td>
<td>1.1059200</td>
<td>0.82771626</td>
<td></td>
</tr>
<tr class="even">
<td>prevach</td>
<td>=~</td>
<td>bytxrstd</td>
<td>0</td>
<td>1.00000000</td>
<td>0.000000000</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>8.5903647</td>
<td>0.85607162</td>
<td></td>
</tr>
<tr class="odd">
<td>prevach</td>
<td>=~</td>
<td>bytxmstd</td>
<td>0</td>
<td>0.98568829</td>
<td>0.049618611</td>
<td>19.8652939</td>
<td>Inf</td>
<td>8.127497e-88</td>
<td>8.4674219</td>
<td>0.85759578</td>
<td></td>
</tr>
<tr class="even">
<td>prevach</td>
<td>=~</td>
<td>bytxsstd</td>
<td>0</td>
<td>0.98072154</td>
<td>0.051524979</td>
<td>19.0339045</td>
<td>3273.3990</td>
<td>1.072947e-76</td>
<td>8.4247557</td>
<td>0.84712100</td>
<td></td>
</tr>
<tr class="odd">
<td>prevach</td>
<td>=~</td>
<td>bytxhstd</td>
<td>0</td>
<td>0.96983846</td>
<td>0.051803967</td>
<td>18.7213163</td>
<td>2329.1752</td>
<td>5.767646e-73</td>
<td>8.3312661</td>
<td>0.84313210</td>
<td></td>
</tr>
<tr class="even">
<td>hw</td>
<td>=~</td>
<td>hw12</td>
<td>0</td>
<td>1.00000000</td>
<td>0.000000000</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>1.2995948</td>
<td>0.68696647</td>
<td></td>
</tr>
<tr class="odd">
<td>hw</td>
<td>=~</td>
<td>hw10</td>
<td>0</td>
<td>0.92385023</td>
<td>0.138226158</td>
<td>6.6836136</td>
<td>476.4311</td>
<td>6.531768e-11</td>
<td>1.2006310</td>
<td>0.70818514</td>
<td></td>
</tr>
<tr class="even">
<td>grades</td>
<td>=~</td>
<td>eng92</td>
<td>0</td>
<td>1.00000000</td>
<td>0.000000000</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>2.4578334</td>
<td>0.91456192</td>
<td></td>
</tr>
<tr class="odd">
<td>grades</td>
<td>=~</td>
<td>math92</td>
<td>0</td>
<td>0.85572904</td>
<td>0.042354997</td>
<td>20.2037326</td>
<td>5076.3862</td>
<td>2.281209e-87</td>
<td>2.1032395</td>
<td>0.79788580</td>
<td></td>
</tr>
<tr class="even">
<td>grades</td>
<td>=~</td>
<td>sci92</td>
<td>0</td>
<td>0.96374024</td>
<td>0.041243002</td>
<td>23.3673639</td>
<td>Inf</td>
<td>9.179699e-121</td>
<td>2.3687130</td>
<td>0.87133356</td>
<td></td>
</tr>
<tr class="odd">
<td>grades</td>
<td>=~</td>
<td>soc92</td>
<td>0</td>
<td>1.04663090</td>
<td>0.036653908</td>
<td>28.5544150</td>
<td>4510.0989</td>
<td>5.415972e-165</td>
<td>2.5724444</td>
<td>0.91650259</td>
<td></td>
</tr>
<tr class="even">
<td>bytxrstd</td>
<td>~~</td>
<td>eng92</td>
<td>0</td>
<td>0.20905253</td>
<td>0.517532041</td>
<td>0.4039412</td>
<td>Inf</td>
<td>6.862559e-01</td>
<td>0.2090525</td>
<td>0.03708374</td>
<td></td>
</tr>
<tr class="odd">
<td>bytxmstd</td>
<td>~~</td>
<td>math92</td>
<td>0</td>
<td>1.92330898</td>
<td>0.522066220</td>
<td>3.6840326</td>
<td>7901.0927</td>
<td>2.311070e-04</td>
<td>1.9233090</td>
<td>0.23835047</td>
<td></td>
</tr>
<tr class="even">
<td>bytxsstd</td>
<td>~~</td>
<td>sci92</td>
<td>0</td>
<td>0.18129467</td>
<td>0.612794899</td>
<td>0.2958489</td>
<td>9042.6888</td>
<td>7.673523e-01</td>
<td>0.1812947</td>
<td>0.02571671</td>
<td></td>
</tr>
<tr class="odd">
<td>bytxhstd</td>
<td>~~</td>
<td>soc92</td>
<td>0</td>
<td>0.20708355</td>
<td>0.588586907</td>
<td>0.3518317</td>
<td>Inf</td>
<td>7.249645e-01</td>
<td>0.2070836</td>
<td>0.03471214</td>
<td></td>
</tr>
<tr class="even">
<td>prevach</td>
<td>~</td>
<td>famback</td>
<td>0</td>
<td>0.30285173</td>
<td>0.031864614</td>
<td>9.5043275</td>
<td>2720.9412</td>
<td>4.261562e-21</td>
<td>0.5975556</td>
<td>0.59755562</td>
<td></td>
</tr>
<tr class="odd">
<td>grades</td>
<td>~</td>
<td>prevach</td>
<td>0</td>
<td>0.13345819</td>
<td>0.019806063</td>
<td>6.7382494</td>
<td>675.5309</td>
<td>3.436673e-11</td>
<td>0.4664492</td>
<td>0.46644925</td>
<td></td>
</tr>
<tr class="even">
<td>grades</td>
<td>~</td>
<td>hw</td>
<td>0</td>
<td>0.61750612</td>
<td>0.161308353</td>
<td>3.8281100</td>
<td>418.0890</td>
<td>1.488829e-04</td>
<td>0.3265102</td>
<td>0.32651023</td>
<td></td>
</tr>
<tr class="odd">
<td>hw</td>
<td>~</td>
<td>prevach</td>
<td>0</td>
<td>0.04578762</td>
<td>0.015843193</td>
<td>2.8900500</td>
<td>4097.4572</td>
<td>3.872039e-03</td>
<td>0.3026577</td>
<td>0.30265768</td>
<td></td>
</tr>
<tr class="even">
<td>hw</td>
<td>~</td>
<td>famback</td>
<td>0</td>
<td>0.02072202</td>
<td>0.007854752</td>
<td>2.6381509</td>
<td>1204.1109</td>
<td>8.443422e-03</td>
<td>0.2702614</td>
<td>0.27026141</td>
<td></td>
</tr>
<tr class="odd">
<td>parocc</td>
<td>~~</td>
<td>parocc</td>
<td>0</td>
<td>192.45185043</td>
<td>20.479141566</td>
<td>9.3974569</td>
<td>Inf</td>
<td>5.589774e-21</td>
<td>192.4518504</td>
<td>0.40115751</td>
<td></td>
</tr>
<tr class="even">
<td>byfaminc</td>
<td>~~</td>
<td>byfaminc</td>
<td>0</td>
<td>2.57197952</td>
<td>0.339150592</td>
<td>7.5835914</td>
<td>6823.9857</td>
<td>3.807425e-14</td>
<td>2.5719795</td>
<td>0.34208318</td>
<td></td>
</tr>
<tr class="odd">
<td>bypared</td>
<td>~~</td>
<td>bypared</td>
<td>0</td>
<td>0.56213098</td>
<td>0.072652460</td>
<td>7.7372601</td>
<td>6435.6708</td>
<td>1.171931e-14</td>
<td>0.5621310</td>
<td>0.31488580</td>
<td></td>
</tr>
<tr class="even">
<td>bytxrstd</td>
<td>~~</td>
<td>bytxrstd</td>
<td>0</td>
<td>26.89949774</td>
<td>3.649960535</td>
<td>7.3698051</td>
<td>4997.6575</td>
<td>1.989032e-13</td>
<td>26.8994977</td>
<td>0.26714138</td>
<td></td>
</tr>
<tr class="odd">
<td>bytxmstd</td>
<td>~~</td>
<td>bytxmstd</td>
<td>0</td>
<td>25.78761692</td>
<td>2.710712342</td>
<td>9.5132252</td>
<td>Inf</td>
<td>1.848411e-21</td>
<td>25.7876169</td>
<td>0.26452948</td>
<td></td>
</tr>
<tr class="even">
<td>bytxsstd</td>
<td>~~</td>
<td>bytxsstd</td>
<td>0</td>
<td>27.92974234</td>
<td>3.170372671</td>
<td>8.8096086</td>
<td>Inf</td>
<td>1.255836e-18</td>
<td>27.9297423</td>
<td>0.28238602</td>
<td></td>
</tr>
<tr class="odd">
<td>bytxhstd</td>
<td>~~</td>
<td>bytxhstd</td>
<td>0</td>
<td>28.23067795</td>
<td>3.475072847</td>
<td>8.1237658</td>
<td>Inf</td>
<td>4.519374e-16</td>
<td>28.2306780</td>
<td>0.28912826</td>
<td></td>
</tr>
<tr class="even">
<td>hw12</td>
<td>~~</td>
<td>hw12</td>
<td>0</td>
<td>1.88991456</td>
<td>0.285407615</td>
<td>6.6218085</td>
<td>4492.9683</td>
<td>3.965259e-11</td>
<td>1.8899146</td>
<td>0.52807707</td>
<td></td>
</tr>
<tr class="odd">
<td>hw10</td>
<td>~~</td>
<td>hw10</td>
<td>0</td>
<td>1.43274138</td>
<td>0.240963868</td>
<td>5.9458764</td>
<td>584.2203</td>
<td>4.733964e-09</td>
<td>1.4327414</td>
<td>0.49847381</td>
<td></td>
</tr>
<tr class="even">
<td>eng92</td>
<td>~~</td>
<td>eng92</td>
<td>0</td>
<td>1.18140710</td>
<td>0.154246192</td>
<td>7.6592302</td>
<td>8832.9652</td>
<td>2.067767e-14</td>
<td>1.1814071</td>
<td>0.16357650</td>
<td></td>
</tr>
<tr class="odd">
<td>math92</td>
<td>~~</td>
<td>math92</td>
<td>0</td>
<td>2.52496228</td>
<td>0.228097781</td>
<td>11.0696486</td>
<td>4517.9871</td>
<td>4.036156e-28</td>
<td>2.5249623</td>
<td>0.36337825</td>
<td></td>
</tr>
<tr class="even">
<td>sci92</td>
<td>~~</td>
<td>sci92</td>
<td>0</td>
<td>1.77939551</td>
<td>0.188242981</td>
<td>9.4526527</td>
<td>3875.5226</td>
<td>5.548686e-21</td>
<td>1.7793955</td>
<td>0.24077782</td>
<td></td>
</tr>
<tr class="odd">
<td>soc92</td>
<td>~~</td>
<td>soc92</td>
<td>0</td>
<td>1.26068628</td>
<td>0.190860744</td>
<td>6.6052676</td>
<td>Inf</td>
<td>3.968001e-11</td>
<td>1.2606863</td>
<td>0.16002300</td>
<td></td>
</tr>
<tr class="even">
<td>famback</td>
<td>~~</td>
<td>famback</td>
<td>0</td>
<td>287.28951040</td>
<td>33.319558160</td>
<td>8.6222485</td>
<td>Inf</td>
<td>6.565204e-18</td>
<td>1.0000000</td>
<td>1.00000000</td>
<td></td>
</tr>
<tr class="odd">
<td>prevach</td>
<td>~~</td>
<td>prevach</td>
<td>0</td>
<td>47.44441120</td>
<td>5.781226901</td>
<td>8.2066336</td>
<td>Inf</td>
<td>2.274763e-16</td>
<td>0.6429273</td>
<td>0.64292728</td>
<td></td>
</tr>
<tr class="even">
<td>hw</td>
<td>~~</td>
<td>hw</td>
<td>0</td>
<td>1.24576869</td>
<td>0.298623041</td>
<td>4.1717099</td>
<td>2183.9853</td>
<td>3.141502e-05</td>
<td>0.7376010</td>
<td>0.73760096</td>
<td></td>
</tr>
<tr class="odd">
<td>grades</td>
<td>~~</td>
<td>grades</td>
<td>0</td>
<td>3.22848941</td>
<td>0.382616586</td>
<td>8.4379233</td>
<td>Inf</td>
<td>3.230255e-17</td>
<td>0.5344345</td>
<td>0.53443448</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>kNN(k-nearest neighbors) imputation을 이용해서 대체된 값으로 채워진 데이터셋을 사용하면,</p>
<div id="cell-73" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="175">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>hw_mean_imp <span class="ot">&lt;-</span> VIM<span class="sc">::</span><span class="fu">kNN</span>(hw_mean, <span class="at">k =</span> <span class="dv">5</span>) <span class="co"># kNN imputation</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sem_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_mean_imp,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"MLMVS"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 141 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        35

  Number of observations                           300

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                62.574      46.436
  Degrees of freedom                                56      42.363
  P-value (Chi-square)                           0.254       0.308
  Scaling correction factor                                  1.348
    mean and variance adjusted correction                         

Model Test Baseline Model:

  Test statistic                              2607.768     303.657
  Degrees of freedom                                78       9.014
  P-value                                        0.000       0.000
  Scaling correction factor                                  8.588

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.997       0.986
  Tucker-Lewis Index (TLI)                       0.996       0.997

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -9861.267   -9861.267
  Loglikelihood unrestricted model (H1)      -9829.980   -9829.980
                                                                  
  Akaike (AIC)                               19792.534   19792.534
  Bayesian (BIC)                             19922.167   19922.167
  Sample-size adjusted Bayesian (SABIC)      19811.167   19811.167

Root Mean Square Error of Approximation:

  RMSEA                                          0.020       0.018
  90 Percent confidence interval - lower         0.000       0.000
  90 Percent confidence interval - upper         0.042       0.041
  P-value H_0: RMSEA &lt;= 0.050                    0.991       0.993
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.029       0.029

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              16.819    0.770
    byfaminc          0.130    0.008   15.666    0.000    2.194    0.810
    bypared           0.065    0.005   13.767    0.000    1.101    0.825
  prevach =~                                                            
    bytxrstd          1.000                               8.606    0.859
    bytxmstd          0.982    0.048   20.520    0.000    8.451    0.857
    bytxsstd          0.977    0.050   19.553    0.000    8.405    0.849
    bytxhstd          0.971    0.050   19.365    0.000    8.354    0.846
  hw =~                                                                 
    hw12              1.000                               1.300    0.693
    hw10              0.856    0.122    6.995    0.000    1.114    0.665
  grades =~                                                             
    eng92             1.000                               2.428    0.908
    math92            0.859    0.043   19.830    0.000    2.084    0.792
    sci92             0.968    0.042   23.301    0.000    2.349    0.869
    soc92             1.055    0.038   27.759    0.000    2.561    0.915

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.303    0.030    9.964    0.000    0.592    0.592
  grades ~                                                              
    prevach           0.124    0.020    6.093    0.000    0.439    0.439
    hw                0.649    0.166    3.912    0.000    0.348    0.348
  hw ~                                                                  
    prevach           0.049    0.015    3.199    0.001    0.323    0.323
    famback           0.024    0.008    3.054    0.002    0.307    0.307

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng92             0.261    0.506    0.516    0.606    0.261    0.046
 .bytxmstd ~~                                                           
   .math92            1.951    0.506    3.854    0.000    1.951    0.238
 .bytxsstd ~~                                                           
   .sci92             0.214    0.596    0.360    0.719    0.214    0.031
 .bytxhstd ~~                                                           
   .soc92             0.250    0.575    0.434    0.664    0.250    0.042

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          193.835   20.125    9.632    0.000  193.835    0.407
   .byfaminc          2.517    0.325    7.748    0.000    2.517    0.343
   .bypared           0.570    0.070    8.107    0.000    0.570    0.320
   .bytxrstd         26.309    3.520    7.474    0.000   26.309    0.262
   .bytxmstd         25.862    2.691    9.612    0.000   25.862    0.266
   .bytxsstd         27.376    3.071    8.915    0.000   27.376    0.279
   .bytxhstd         27.760    3.364    8.251    0.000   27.760    0.285
   .hw12              1.826    0.274    6.656    0.000    1.826    0.519
   .hw10              1.561    0.229    6.806    0.000    1.561    0.557
   .eng92             1.251    0.155    8.056    0.000    1.251    0.175
   .math92            2.590    0.237   10.925    0.000    2.590    0.373
   .sci92             1.787    0.185    9.679    0.000    1.787    0.245
   .soc92             1.273    0.190    6.706    0.000    1.273    0.163
    famback         282.885   32.385    8.735    0.000    1.000    1.000
   .prevach          48.061    5.582    8.609    0.000    0.649    0.649
   .hw                1.156    0.282    4.103    0.000    0.684    0.684
   .grades            3.138    0.366    8.576    0.000    0.532    0.532
</code></pre>
</div>
</div>
</section>
</section>
<section id="linearity" class="level1">
<h1>Linearity</h1>
<div id="cell-76" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>trendlines <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, ...){</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> mapping) <span class="sc">+</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> loess, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"orange"</span>, ...)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>hw_mean <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>Female, <span class="sc">-</span>ethnic) <span class="sc">|&gt;</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>(<span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> trendlines))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-54-output-1.png" width="810" height="810" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-78" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(eng92 <span class="sc">~</span> hw10, <span class="at">data=</span>hw_mean)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-56-output-1.png" width="480" height="400" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-79" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="324">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(eng92 <span class="sc">~</span> parocc, <span class="at">data=</span>hw_mean)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="diagnostics_files/figure-html/cell-57-output-1.png" width="480" height="400" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sem\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/chap22.html" class="pagination-link" aria-label="Latent Interactions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Latent Interactions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/exercises.html" class="pagination-link" aria-label="Exercises">
        <span class="nav-page-text">Exercises</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>