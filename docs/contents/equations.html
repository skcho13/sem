<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-10-22">

<title>Structural Equations –  CHA Statistics II in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/ml.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Structural Equations –  CHA Statistics II in R">
<meta property="og:description" content="Structural equations with latent variables by Bollen, Kenneth A. (1989)">
<meta property="og:site_name" content="CHA Statistics II in R">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Structural Equations</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics II in R</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages for SEM</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Keith’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multigroup Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/equations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">SEM Equations</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Kline’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/Kline/composite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reflective</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: Formative</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: PLS-PM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: HO</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#structural-equation-model-sem-matrix-representation" id="toc-structural-equation-model-sem-matrix-representation" class="nav-link active" data-scroll-target="#structural-equation-model-sem-matrix-representation">Structural Equation Model (SEM) Matrix Representation</a></li>
  <li><a href="#parameter-estimation" id="toc-parameter-estimation" class="nav-link" data-scroll-target="#parameter-estimation">Parameter Estimation</a>
  <ul>
  <li><a href="#데이터로부터-최선의-파라미터를-추정" id="toc-데이터로부터-최선의-파라미터를-추정" class="nav-link" data-scroll-target="#데이터로부터-최선의-파라미터를-추정">데이터로부터 최선의 파라미터를 추정</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation">Estimation</a></li>
  <li><a href="#model-indentification" id="toc-model-indentification" class="nav-link" data-scroll-target="#model-indentification">Model Indentification</a></li>
  </ul></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model Evaluation</a>
  <ul>
  <li><a href="#overall-fit-measures" id="toc-overall-fit-measures" class="nav-link" data-scroll-target="#overall-fit-measures">Overall Fit Measures</a>
  <ul class="collapse">
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  <li><a href="#chi-square-chi2-test" id="toc-chi-square-chi2-test" class="nav-link" data-scroll-target="#chi-square-chi2-test">Chi-Square( <span class="math inline">\(\chi^2\)</span>) Test</a></li>
  <li><a href="#incremental-fit-index" id="toc-incremental-fit-index" class="nav-link" data-scroll-target="#incremental-fit-index">Incremental Fit Index</a></li>
  <li><a href="#rmsea" id="toc-rmsea" class="nav-link" data-scroll-target="#rmsea">RMSEA</a></li>
  <li><a href="#cfi" id="toc-cfi" class="nav-link" data-scroll-target="#cfi">CFI</a></li>
  <li><a href="#srmr" id="toc-srmr" class="nav-link" data-scroll-target="#srmr">SRMR</a></li>
  </ul></li>
  <li><a href="#적합도에-평가에-대한-가이드라인-by-klein2023" id="toc-적합도에-평가에-대한-가이드라인-by-klein2023" class="nav-link" data-scroll-target="#적합도에-평가에-대한-가이드라인-by-klein2023">적합도에 평가에 대한 가이드라인 by Klein(2023)</a></li>
  <li><a href="#local-fit-measures" id="toc-local-fit-measures" class="nav-link" data-scroll-target="#local-fit-measures">Local Fit Measures</a></li>
  </ul></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison</a>
  <ul>
  <li><a href="#respecification" id="toc-respecification" class="nav-link" data-scroll-target="#respecification">Respecification</a>
  <ul class="collapse">
  <li><a href="#modification-indices" id="toc-modification-indices" class="nav-link" data-scroll-target="#modification-indices">Modification indices</a></li>
  </ul></li>
  <li><a href="#non-nested-models" id="toc-non-nested-models" class="nav-link" data-scroll-target="#non-nested-models">Non-nested Models</a>
  <ul class="collapse">
  <li><a href="#aic" id="toc-aic" class="nav-link" data-scroll-target="#aic">AIC</a></li>
  <li><a href="#bic" id="toc-bic" class="nav-link" data-scroll-target="#bic">BIC</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#power-and-precision" id="toc-power-and-precision" class="nav-link" data-scroll-target="#power-and-precision">Power and Precision</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Structural Equations</h1>
<p class="subtitle lead">Structural equations with latent variables by Bollen, Kenneth A. (1989)</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="1">
<details class="code-fold">
<summary>Load libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="structural-equation-model-sem-matrix-representation" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation-model-sem-matrix-representation">Structural Equation Model (SEM) Matrix Representation</h2>
<div style="line-height: 1.5em; font-size: .9em">
<p>Measures of political democracy and industrialization for 75 developing countries in 1960 and 1965</p>
<ul>
<li>y1. freedom of the press, 1960</li>
<li>y2. freedom of political opposition, 1960</li>
<li>y3. fairness of elections, 1960</li>
<li>x1. natural log of GNP per capita, 1960</li>
<li>x2. natural log of energy consumption per capita, 1960</li>
</ul>
</div>
<div class="columns">
<div class="column" style="width:55%;">
<p><img src="images/bolle-path-1.png" class="img-fluid" width="450"></p>
</div><div class="column" style="width:45%;">
<p><br> <br></p>
<div style="line-height: 2em; font-size: .9em">
<ul>
<li>외생변수(Exogenous variables): <span class="math inline">\(X1, X2\)</span></li>
<li>내생변수(Endogenous variables): <span class="math inline">\(Y1, Y2, Y3\)</span></li>
<li>경로계수(Path coefficients)
<ul>
<li><span class="math inline">\(\gamma\)</span>: <span class="math inline">\(X\)</span>와 <span class="math inline">\(Y\)</span>의 관계</li>
<li><span class="math inline">\(\beta\)</span>: <span class="math inline">\(Y\)</span>와 <span class="math inline">\(Y\)</span>의 관계</li>
</ul></li>
<li>오차항(Error terms): <span class="math inline">\(\zeta\)</span></li>
</ul>
</div>
</div>
</div>
<div style="line-height: 1.5em; font-size: .9em">
<p>Figure 4.2 Union Sentiment Model for Southern Textile Workers<br>
Source: p.&nbsp;83, Bollen, K. A. (1989). Structural equations with latent variables</p>
</div>
<p><strong>Matrix representation of the model:</strong></p>
<p><span class="math display">\[
\mathbf{Y} = \mathbf{B}\mathbf{Y} + \mathbf{\Gamma}\mathbf{X} + \boldsymbol{\zeta}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
y_1 \\ y_2 \\ y_3
\end{bmatrix} =
\begin{bmatrix}
0 &amp; 0 &amp; 0 \\
\beta_{21} &amp; 0 &amp; 0 \\
\beta_{31} &amp; \beta_{32} &amp; 0
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2 \\ y_3
\end{bmatrix} +
\begin{bmatrix}
0 &amp; \gamma_{12} \\
0 &amp; \gamma_{22} \\
\gamma_{31} &amp; 0
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} +
\begin{bmatrix}
\zeta_1 \\ \zeta_2 \\ \zeta_3
\end{bmatrix}
\]</span></p>
<p>가정 1: 내생변수의 오차항과 외생변수는 서로 독립; <span class="math inline">\(\zeta \perp X\)</span><br>
가정 2: 각 변수는 평균이 0이고, 변수들은 multivariate normal을 따름</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>The covariance matrix of exogenous variables:</p>
<p><span class="math display">\[
\mathbf{\Phi} =
\begin{bmatrix}
\phi_{11} &amp; \phi_{12} \\
\phi_{21} &amp; \phi_{22}
\end{bmatrix}
\]</span></p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>The covariance matrix of error terms:</p>
<p><span class="math display">\[
\mathbf{\Psi} =
\begin{bmatrix}
\psi_{11} &amp; 0 &amp; 0 \\
0 &amp; \psi_{22} &amp; 0 \\
0 &amp; 0 &amp; \psi_{33}
\end{bmatrix}
\]</span></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div style="line-height: 1.8em; font-size: .9em">
<ul>
<li><span class="math inline">\(\mathbf{Y}\)</span> is the vector of endogenous variables</li>
<li><span class="math inline">\(\mathbf{X}\)</span> is the vector of exogenous variables</li>
<li><span class="math inline">\(\mathbf{B}\)</span> is the matrix of path coefficients between endogenous variables</li>
<li><span class="math inline">\(\mathbf{\Gamma}\)</span> is the matrix of path coefficients from exogenous to endogenous variables</li>
</ul>
</div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div style="line-height: 1.8em; font-size: .9em">
<ul>
<li><span class="math inline">\(\boldsymbol{\zeta}\)</span> is the vector of error terms</li>
<li><span class="math inline">\(\mathbf{\Phi}\)</span> is the covariance matrix of exogenous variables</li>
<li><span class="math inline">\(\mathbf{\Psi}\)</span> is the covariance matrix of error terms</li>
</ul>
</div>
</div>
</div>
</div>
<div id="cell-3" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<details class="code-fold">
<summary>data and model</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A dataset from Bollen (1989) containing measures of political democracy and industrialization for 75 developing countries in 1960 and 1965. </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>bollen1989a <span class="ot">&lt;-</span> MIIVsem<span class="sc">::</span>bollen1989a <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fig 4.2</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">  y3 ~ x1 + y1 + y2</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">  y2 ~ x2 + y1</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">  y1 ~ x2</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> bollen1989a, <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-4" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients: betas &amp; gamma</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fit, <span class="at">what =</span> <span class="st">"est"</span>)<span class="sc">$</span>beta <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   y3   y2   y1   x1   x2
y3  0 0.06 0.76 0.36 0.00
y2  0 0.00 0.88 0.00 0.16
y1  0 0.00 0.00 0.00 0.56
x1  0 0.00 0.00 0.00 0.00
x2  0 0.00 0.00 0.00 0.00</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariances: psi &amp; phi</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fit, <span class="at">what =</span> <span class="st">"est"</span>)<span class="sc">$</span>psi <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     y3   y2   y1   x1   x2
y3 5.64                    
y2 0.00 9.71               
y1 0.00 0.00 6.09          
x1 0.00 0.00 0.00 0.53     
x2 0.00 0.00 0.00 0.98 2.25</code></pre>
</div>
</div>
</section>
<section id="parameter-estimation" class="level2">
<h2 class="anchored" data-anchor-id="parameter-estimation">Parameter Estimation</h2>
<p><img src="images/bollen-path-4.png" class="img-fluid" width="500"></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;86, Bollen, K. A. (1989). Structural equations with latent variables</p>
</div>
<p><span class="math inline">\(y_1 = \gamma_{11}x_1 + \zeta_1\)</span><br>
<span class="math inline">\(y_2 = \beta_{21}y_1 + \zeta_2\)</span></p>
<p>Matrix representation:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 15, 35]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><span class="math inline">\(\begin{bmatrix}
y_1 \\ y_2
\end{bmatrix} =
\begin{bmatrix}
0 &amp; 0 \\
\beta_{21} &amp; 0
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2
\end{bmatrix} +
\begin{bmatrix}
\gamma_{11} \\
0 \\
\end{bmatrix}
\begin{bmatrix}
x_1
\end{bmatrix} +
\begin{bmatrix}
\zeta_1 \\ \zeta_2
\end{bmatrix}\)</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: flex-start;">
<p><span class="math inline">\(\mathbf{\Phi} =
\begin{bmatrix}
\phi_{11}
\end{bmatrix}\)</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 35.0%;justify-content: flex-start;">
<p><span class="math inline">\(\mathbf{\Psi} =
\begin{bmatrix}
\psi_{11} &amp; \psi_{12}\\
\psi_{21} &amp; \psi_{22}\\
\end{bmatrix}\)</span></p>
</div>
</div>
</div>
<p>가정들:</p>
<ul>
<li>내생변수의 잔차는 외생변수와 독립: <span class="math inline">\(cov(\zeta_1, x_1) = 0\)</span>, <span class="math inline">\(cov(\zeta_2, x_1) = 0\)</span></li>
<li>내생변수의 잔차들은 서로 독립: <span class="math inline">\(cov(\zeta_1, \zeta_2) = 0\)</span> 즉, <span class="math inline">\(\psi_{12} = 0\)</span>
<ul>
<li>추정은 가능하나 non-recursive한 피드백 루프가 있는 모형이 됨.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Coveriance에 대한 성질">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Coveriance에 대한 성질
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(Cov(aX+bY,~ cU+dV) = ac~Cov(X, U) + ad~Cov(X, V) + bc~Cov(Y, U) + bd~Cov(Y, V)\)</span></p>
</div>
</div>
<p><span class="math inline">\(\begin{align}
  cov(y_1, y_2) &amp; = cov(\gamma_{11}x_1 + \zeta_1, \beta_{21}y_1 + \zeta_2) \\
                &amp; = \gamma_{11} \beta_{21} cov(x_1, y_1) + \gamma_{11} cov(x_1, \zeta_2) + \beta_{21} cov(y_1, \zeta_1) + cov(\zeta_1, \zeta_2) \\
                &amp; = \gamma_{11} \beta_{21} * \gamma_{11} \phi_{11} + \beta_{21} \psi_{11} \\
                &amp; = \beta_{21}( \gamma_{11}^2 \phi_{11} + \psi_{11})
\end{align}\)</span></p>
<ul>
<li><span class="math inline">\(cov(x_1, y_1) = cov(x_1, \gamma_{11}x_1 + \zeta_1) = \gamma_{11} cov(x_1, x_1) + cov(x_1, \zeta_1) = \gamma_{11} var(x_1) = \gamma_{11} \phi_{11}\)</span></li>
<li><span class="math inline">\(cov(y_1, \zeta_1) = cov(\gamma_{11}x_1 + \zeta_1, \zeta_1) = \gamma_{11} cov(x_1, \zeta_1) + cov(\zeta_1, \zeta_1) = var(\zeta_1) = \psi_{11}\)</span></li>
<li><span class="math inline">\(cov(\zeta_1, \zeta_2) = \psi_{12}\)</span></li>
</ul>
<p><span class="math display">\[\begin{equation}
\begin{bmatrix}
\text{VAR}(y_1) \\
\text{COV}(y_2, y_1) &amp; \text{VAR}(y_2) \\
\text{COV}(x_1, y_1) &amp; \text{COV}(x_1, y_2) &amp; \text{VAR}(x_1)
\end{bmatrix} =
\begin{bmatrix}
\gamma_{11}^2\phi_{11} + \psi_{11} \\
\beta_{21}(\gamma_{11}^2\phi_{11} + \psi_{11}) &amp; \beta_{21}^2(\gamma_{11}^2\phi_{11} + \psi_{11}) + \psi_{22} \\
\gamma_{11}\phi_{11} &amp; \beta_{21}\gamma_{11}\phi_{11} &amp; \phi_{11}
\end{bmatrix}
\end{equation}\]</span></p>
<p><br></p>
<section id="데이터로부터-최선의-파라미터를-추정" class="level3">
<h3 class="anchored" data-anchor-id="데이터로부터-최선의-파라미터를-추정">데이터로부터 최선의 파라미터를 추정</h3>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>기본적인 구조 모형의 가설(hypothesis)</strong>:</p>
<p><span class="math inline">\(\Sigma = \Sigma(\theta)\)</span><br>
즉, 모집단의 공분산 = 모수(parameter)로 표현되는(implied) 공분산</p>
</div>
</div>
</div>
<ul>
<li>모집단의 공분산에 대한 추정치: 관찰된 공분산 행렬 <span class="math inline">\(\mathbf{S}\)</span></li>
<li>파라미터로 표현된 공분산 행렬의 추정치: <span class="math inline">\(\hat{\Sigma}(\theta)\)</span></li>
</ul>
<p>이제 이 둘의 차 <span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta)\)</span>를 최소화하는 파라미터들(통칭 <span class="math inline">\(\theta\)</span>)를 찾고자 함.</p>
<p>예를 들어,</p>
<div id="cell-8" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariance matrix</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">  225.2</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">  32.1 100.3</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">  111.4 26.5 105.2'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"y1"</span>, <span class="st">"y2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # regressopm</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">  y2 ~ 0*x1 + y1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">  y1 ~ x1</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # variacne</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # y2 ~~ y1  # assumed to be uncorrelated</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">sample.cov =</span> cov, <span class="at">sample.nobs =</span> <span class="dv">200</span>, <span class="at">fixed.x =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  lhs op rhs     est     se      z pvalue ci.lower ci.upper
1  y2  ~  x1   0.000  0.000     NA     NA    0.000    0.000
2  y2  ~  y1   0.264  0.070  3.776  0.000    0.127    0.401
3  y1  ~  x1   0.143  0.046  3.092  0.002    0.052    0.233
4  y2 ~~  y2  97.708  9.771 10.000  0.000   78.557  116.858
5  y1 ~~  y1  95.246  9.525 10.000  0.000   76.578  113.914
6  x1 ~~  x1 224.074 22.407 10.000  0.000  180.156  267.992</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># implied covariance matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="st">"cov.all"</span>)[<span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x1   y1    y2
x1 224.1 31.9   8.4
y1  31.9 99.8  26.4
y2   8.4 26.4 104.7</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 공분산 행렬 차이: residual covariance matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(cov <span class="sc">-</span> sigma_hat) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x1  y1    y2
x1   1.1 0.2 103.0
y1   0.2 0.5   0.1
y2 103.0 0.1   0.5</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>즉, <span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta) =
\begin{bmatrix}
1.1 \\
0.2 &amp; 0.5 \\
103.0 &amp; 0.1 &amp; 0.5
\end{bmatrix}\)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>이는 어떤 다른 파라미터 값에 대해서도 이 공분산 차이보다 더 작을 수 없다는 의미임.<br>
한편, 어떤 의미에서 차이가 작다는지를 정의해야 함.</p>
</blockquote>
</section>
<section id="estimation" class="level3">
<h3 class="anchored" data-anchor-id="estimation">Estimation</h3>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta)\)</span>가 작다는 것을 어떻게 정의할 것인가?<br>
혹은, 두 행렬 <span class="math inline">\(\mathbf{S}\)</span>, <span class="math inline">\(\hat{\Sigma}(\theta)\)</span> 사이의 거리를 어떻게 정의할 것인가?</p>
<blockquote class="blockquote">
<p>Fitting function(목적 함수)를 통해 그 함수가 최소가 되는 파라미터를 찾는 방식</p>
</blockquote>
</div>
</div>
</div>
<ul>
<li>Likelihood의 관점에서 <span class="math inline">\(\mathbf{S}\)</span>와 <span class="math inline">\(\hat{\Sigma}(\theta)\)</span>의 거리를 측정: maximum likelihood estimation(MLE); scale invariant, scale free
<ul>
<li><span class="math inline">\(F_{ML} = log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta)) - log|S| - (p + q)\)</span></li>
</ul></li>
<li>각 성분들의 제곱의 합이 최소가 되도록 추정: unweighted least squares(ULS); scale에 따라 변함.
<ul>
<li><span class="math inline">\(F_{ULS} = \frac{1}{2} tr[(\mathbf{S} - \Sigma(\theta))^2]\)</span></li>
</ul></li>
<li>Fully weighted least squares(WLS): 적절한 <span class="math inline">\(\mathbf{W}\)</span>를 선택해 공분산의 크기를 조정, 분포에 대한 가정 없으나 큰 표본을 요구함.
<ul>
<li><span class="math inline">\(F_{WLS} = \frac{1}{2} tr\left[\left[\left(\mathbf{S} - \Sigma(\theta)\right)\mathbf{W}^{-1}\right]^2\right]\)</span></li>
<li>Generalized least squares(GLS): <span class="math inline">\(\mathbf{W}\)</span>를 <span class="math inline">\(\mathbf{S}\)</span>로 선택하는 경우; scale invariant, scale free</li>
</ul></li>
</ul>
<p><strong>Maximum Likelihood Estimation</strong></p>
<p>관측 변수들이 multivariate normal distribution을 따른다고 가정하면,</p>
<ul>
<li><p>Log-likelihood <span class="math inline">\(\displaystyle L(\theta) = \frac{-N(p + q)}{2}log(2\pi) - \frac{N}{2}\left(log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta))\right)\)</span></p></li>
<li><p><span class="math inline">\(F_{ML} = log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta)) - log|S| - (p + q)\)</span></p></li>
</ul>
<p>즉, likelihood를 최대화하는 것은 <span class="math inline">\(F_{ML}\)</span>를 최소화하는 것과 동일함.</p>
<p>Fitting function으로써 <span class="math inline">\(F_{ML}\)</span>의 장점은 asymptotic properties를 가지고 있음.</p>
<ul>
<li>Multivariate normal을 가정하고, N이 충분히 클 때,</li>
<li>주어진 모형이 참이라면, random sampling 변화에 따라 <span class="math inline">\((N-1)*F_{ML}\)</span>은 <span class="math inline">\(\chi^2\)</span> 분포 따름</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Non-normality에 대한 대응">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-normality에 대한 대응
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Robust ML</li>
<li>Bootstrapping: Bollen-Stine bootstrap</li>
<li>분포에 대한 가정이 없는 방법: WLS(fully weighted least squares)</li>
</ul>
<p>ML 파라미터 추정치는 일반적으로 robust하나, 표준오차는 문제가 될 수 있음.<br>
다음과 같은 ML에 대한 robust estimation들은 표준오차에 대한 보정을 제공함.</p>
<ol type="1">
<li>Option “MLM” is for complete data sets only and generates the mean-adjusted Satorra-Bentler scaled chi-square.</li>
<li>Option “MLR” can be applied in complete or incomplete data sets, and it generates a mean adjusted chi-square based on the Yuan-Bentler T2 statistic. Because this method accommodates missing data, it is the most flexible option listed here.</li>
<li>Option “MLMV” is for complete data sets only and computes a mean- and variance-adjusted scaled chi-square.</li>
<li>Option “MLMVS” generates a mean- and variance adjusted chi-square with a correction for heteroscedasticity by Satterthwaite (1941). Model degrees of freedom are estimated, and the method is for complete data sets.</li>
</ol>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;137, 163, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
</section>
<section id="model-indentification" class="level3">
<h3 class="anchored" data-anchor-id="model-indentification">Model Indentification</h3>
<p>위의 예에서,</p>
<ul>
<li>파라미터를 추정하기 위해 주어진 정보의 갯수: 3+2+1=6개
<ul>
<li>관찰 변수가 <span class="math inline">\(p\)</span>개 일 때, <span class="math inline">\(p(p+1)/2\)</span></li>
</ul></li>
<li>추정하고자 하는 파라미터의 개수: 5개</li>
</ul>
<p>즉, 식은 6개이며 미지수는 5개이므로 추정가능함!<br>
이 때, <strong>자유도(degree of freedom) df</strong> = 6 - 5 = 1</p>
<ul>
<li>over-identified (과대 식별): df &gt; 0, 그 차이(자유도)가 클수록 유리함!</li>
<li>just-identified (적정 식별): df = 0, 포화 모형 (saturated model)</li>
<li>under-identified model (과소 식별): df &lt; 0, 파라미터 추정 불가능</li>
</ul>
<div id="cell-17" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">estimate =</span> F) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 10 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                               139.381
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.000</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># info for parameters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">parTable</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id lhs op rhs user block group free ustart exo label plabel   start     est
1  1  y2  ~  x1    1     1     1    0      0   0         .p1.   0.000   0.000
2  2  y2  ~  y1    1     1     1    1     NA   0         .p2.   0.111   0.264
3  3  y1  ~  x1    1     1     1    2     NA   0         .p3.   0.143   0.143
4  4  y2 ~~  y2    0     1     1    3     NA   0         .p4.  48.671  97.708
5  5  y1 ~~  y1    0     1     1    4     NA   0         .p5.  95.246  95.246
6  6  x1 ~~  x1    0     1     1    5     NA   0         .p6. 224.074 224.074
      se
1  0.000
2  0.070
3  0.046
4  9.771
5  9.525
6 22.407</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation" class="level1">
<h1>Model Evaluation</h1>
<p>모형에 대한 평가는 1) 변수들 간의 관계성 2) 그 관계의 크기 모두에 대해 이루어져야 함.<br>
이를 위해 전체적인 평가(overal fit measures)와 부분적인 평가(local/component fit measures)로 나누어 살펴봄.</p>
<section id="overall-fit-measures" class="level2">
<h2 class="anchored" data-anchor-id="overall-fit-measures">Overall Fit Measures</h2>
<p>두 행렬 <span class="math inline">\(\mathbf{S}\)</span>와 <span class="math inline">\(\hat{\Sigma}(\theta)\)</span>간의 거리를 측정하여 모형이 전체적으로 얼마나 적합한지를 평가함.<br>
부분적인(local) 적합도를 살펴보는 것으로는 드러나지 못하는 “전체적 부적절함”을 판별할 수는 지표를 얻을 수 있음.</p>
<ul>
<li>반대로, 전체적으로 적합하다고 해서 부분적으로 적합하다는 보장은 없음.</li>
<li>따라서, 여러 측면에서 동시에 평가하는 것이 중요함!</li>
</ul>
<section id="residuals" class="level3">
<h3 class="anchored" data-anchor-id="residuals">Residuals</h3>
<p>Ideally, all residuals should be near zero for a “good” model. But the sample residuals are affected by several factors: (1) the departure of <span class="math inline">\(\Sigma\)</span> from <span class="math inline">\(\Sigma(\theta)\)</span>, (2) the scales of the observed variables, and (3) sampling fluctuations</p>
<ul>
<li>Coveriance residuals: 두 공분산의 차이 <span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta)\)</span>를 직접 확인</li>
<li>Correlation residuals: 각 공분산을 표준화하여 (변수들의 단위와 독립적인) 상관계수로 변환 후 비교
<ul>
<li><span class="math inline">\(\displaystyle r_{ij} = \frac{\sigma_{ij}}{\sqrt{\sigma_{ii}\sigma_{jj}}}\)</span>, <span class="math inline">\(\sigma_{ij}\)</span>: 해당 공분산</li>
<li>그 값이 0.1 이상이면 주의</li>
</ul></li>
<li>Standardized residuals: 표준오차로 나눈 잔차들을 비교
<ul>
<li>divided by the square root of the asymptotic variance of these residuals (by lavaan)</li>
<li>표본의 크기를 고려해 분산을 조정한 값</li>
<li>N이 충분히 크다면, z-score로 이해할 수 있음</li>
<li>2.0 이상이면 유의(significant)하다고 보고 주의; 단, 표본크기에 대한 가설검증의 취약성을 그대로 지님.</li>
</ul></li>
</ul>
<p><strong><em>표본의 크기가 커질수록, 공분산/상관 잔차의 값이 줄어드는 경향이 있음.</em></strong></p>
<p>예제: Reisenzein(1986)의 실험</p>
<div class="callout callout-style-simple callout-note callout-titled" title="연구 내용">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
연구 내용
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>지하철에서 한 사람이 쓰러지는 가상의 시나리오에서 동정심과 분노가 도움 행동을 매개하는지를 조사</li>
<li>절반의 참가자에게는 그 사람이 술에 취했다는 정보 제공, 나머지 절반에게는 병에 걸렸다는 정보 제공</li>
<li>동정심과 분노는 각각 세 가지 지표로 측정됨</li>
</ul>
<p>동정심<br>
x1: 그 사람에 대해 얼마나 동정심(sympathy)을 느끼십니까?<br>
x2: 나는 이 사람에게 연민(pity)을 느낍니다.<br>
x3: 이 사람에 대해 얼마나 걱정(concern)이 되십니까?</p>
<p>분노<br>
x4: 그 사람에게 얼마나 화가 나시나요?<br>
x5: 그 사람에게 얼마나 짜증을 느끼시겠습니까?<br>
x6: 그 사람 때문에 기분이 나빠질 것입니다.</p>
</div>
</div>
</div>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;260, Bollen, K. A. (1989). Structural equations with latent variables</p>
</div>
<p><img src="images/bollen-fig7-4.png" class="img-fluid" width="550"></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Figure 7.4 Confirmatory Factor Analysis Model for Sympathy (<span class="math inline">\(\xi_1\)</span>) and Anger (<span class="math inline">\(\xi_2\)</span>).<br>
Each Measured with Three Indicators (<span class="math inline">\(X_1\)</span> to <span class="math inline">\(X_6\)</span>)</p>
</div>
<p>Matrix representation for the CFA model:</p>
<p><span class="math inline">\(x_1 = \lambda_{11}\xi_1 + \delta_1\)</span>, &nbsp; <span class="math inline">\(x_2 = \lambda_{21}\xi_1 + \delta_2\)</span>, &nbsp;<span class="math inline">\(x_3 = \lambda_{31}\xi_1 + \delta_3\)</span>,<br>
<span class="math inline">\(x_4 = \lambda_{42}\xi_2 + \delta_4\)</span>, &nbsp;<span class="math inline">\(x_5 = \lambda_{52}\xi_2 + \delta_5\)</span>, &nbsp;<span class="math inline">\(x_6 = \lambda_{62}\xi_2 + \delta_6\)</span></p>
<p><span class="math inline">\(\begin{bmatrix}
x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \\ x_6
\end{bmatrix} =
\begin{bmatrix}
\lambda_{11} &amp; 0 \\
\lambda_{21} &amp; 0 \\
\lambda_{31} &amp; 0 \\
0 &amp; \lambda_{42} \\
0 &amp; \lambda_{52} \\
0 &amp; \lambda_{62}
\end{bmatrix}
\begin{bmatrix}
\xi_1 \\ \xi_2
\end{bmatrix} +
\begin{bmatrix}
\delta_1 \\ \delta_2 \\ \delta_3 \\ \delta_4 \\ \delta_5 \\ \delta_6
\end{bmatrix}\)</span></p>
<p><span class="math inline">\(\mathbf{x} = \mathbf{\Lambda}\mathbf{\xi} + \boldsymbol{\delta}\)</span></p>
<p>가정: <span class="math inline">\(COV(\xi_i, \delta_j) = 0\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>The covariance matrix of exogenous variables:</p>
<p><span class="math display">\[\mathbf{\Phi} =
\begin{bmatrix}
\phi_{11} &amp;  \\
\phi_{21} &amp; \phi_{22}
\end{bmatrix}
\]</span></p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>The covariance matrices of the errors of measurement</p>
<p><span class="math display">\[\mathbf{\Theta_{\delta}} =
\begin{bmatrix}
V(\delta_1) \\
0 &amp; V(\delta_2) \\
0 &amp; 0 &amp; V(\delta_3) \\
0 &amp; 0 &amp; 0 &amp; V(\delta_4) \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; V(\delta_5) \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; V(\delta_6)
\end{bmatrix}
\]</span></p>
</div>
</div>
</div>
<div id="cell-22" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fig 7.4</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">  6.982</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">  4.686 6.047</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">  4.335 3.307 5.037 </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">  -2.294 -1.453 -1.979 5.569</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">  -2.209 -1.262 -1.738 3.931 5.328</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">  -1.671 -1.401 -1.564 3.915 3.601 4.977</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>, <span class="st">"x6"</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>model_sa <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">  sympathy =~ x1 + x2 + x3</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">  anger =~ x4 + x5 + x6</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>fit_sa <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_sa, <span class="at">sample.cov =</span> cov, <span class="at">sample.nobs =</span> <span class="dv">138</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coveriance residuals</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  0.028  0.000                            
x3 -0.016 -0.027  0.000                     
x4 -0.073  0.247 -0.387  0.000              
x5 -0.170  0.297 -0.277 -0.030  0.000       
x6  0.334  0.136 -0.126  0.013  0.020  0.000
</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation residuals</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa, <span class="at">type =</span> <span class="st">"cor"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  0.004  0.000                            
x3 -0.003 -0.005  0.000                     
x4 -0.012  0.043 -0.074  0.000              
x5 -0.028  0.053 -0.054 -0.006  0.000       
x6  0.057  0.025 -0.025  0.002  0.004  0.000
</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardized residuals</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa, <span class="at">type =</span> <span class="st">"standardized"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "standardized"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  1.353  0.000                            
x3 -1.035 -0.379  0.000                     
x4 -0.392  0.871 -1.503  0.000              
x5 -0.723  0.967 -1.006 -1.203  0.000       
x6  1.585  0.483 -0.493  0.568  0.566  0.000
</code></pre>
</div>
</div>
<p><strong>Normalized vs standardized residuals</strong>: ratios of covariance residuals over the standard error of the sample covariance, not the standard error of the difference between sample and predicted values.</p>
<div id="cell-27" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized residuals</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa, <span class="at">type =</span> <span class="st">"normalized"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  0.042  0.000                            
x3 -0.026 -0.049  0.000                     
x4 -0.130  0.488 -0.809  0.000              
x5 -0.311  0.604 -0.601 -0.053  0.000       
x6  0.644  0.284 -0.285  0.023  0.038  0.000
</code></pre>
</div>
</div>
</section>
<section id="chi-square-chi2-test" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-chi2-test">Chi-Square( <span class="math inline">\(\chi^2\)</span>) Test</h3>
<p>공분산의 잔차들이 모집단에서 0과 다른지에 대한 통계적 검증하고자 함.</p>
<ul>
<li>위에서 standardize한 residuals를 이용하는 것은 대략적인 테스트임.</li>
<li>소위, simultaneous significance test, 즉 모든 공분산이 0인지를 동시에 검증하는 것이 필요함.</li>
</ul>
<!-- It would be helpful to have a test of whether the residuals depart from the population values of zero. The normalized residuals provide a very rough test of statistical significance, but without prior specification of the individual element that is tested and with the tendency of these residuals to be too small, the probability levels associated with the test are not accurate.

It would be extremely helpful to have a simultaneous significance test of the hypothesis that all population residuals in $[\Sigma - \Sigma(\theta)]$ are zero. The test should take into account N and df and should be based on the sample residuals. The next section presents such a significance test. -->
<p>Chi-Square( <span class="math inline">\(\chi^2\)</span>) Test</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\Sigma\)</span> = <span class="math inline">\(\Sigma(\theta)\)</span> ; 공분산 행렬과 모수로 표현된 공분산 행렬이 같다. 즉, 연구자의 모형은 데이터와 완전히 일치함!</li>
<li><span class="math inline">\(H_0\)</span> 가정하에, sampling error로부터 <span class="math inline">\((N-1)*F_{ML}\)</span> 값들은 점근적으로 <span class="math inline">\(\chi^2(df_M)\)</span> 분포 따름</li>
<li>이는 포화모형(완전한 모형)에 비해 연구자의 “제한이 가해진 모형” 간의 (likelihood) 차이가 특정 분포를 따른다는 것을 의미함.
<ul>
<li>Log-likelihood ratio: <span class="math inline">\(\displaystyle -2log\left(\frac{L_0}{L_1}\right) = (N-1)F_{ML} \sim \chi^2(df_M)\)</span>
<ul>
<li><span class="math inline">\(L_0\)</span>: the likelihood maximized for the researcher’s model under <span class="math inline">\(H_0\)</span></li>
<li><span class="math inline">\(L_1\)</span>: the same quantity for an unrestricted model</li>
</ul></li>
<li><span class="math inline">\(df_M\)</span>: the difference in the number of parameters between the two models</li>
</ul></li>
</ul>
<p>위의 CFA의 예에서,</p>
<p><span class="math inline">\(\begin{align}
  \chi^2_{ML} = (N)*F_{ML}(S, \hat{\Sigma}(\theta)) &amp; = N*\left(log|\Sigma(\theta)| + tr(\Sigma^{-1}(\theta)S) - log|S| - (p + q)\right) \\
  &amp; = 138 * 0.0698 = 9.632 \\
\end{align}\)</span></p>
<p>이 값은 다음과 같이 해석할 수 있음.</p>
<p><span class="math inline">\(\begin{align}
  -2log\left(\frac{L_0}{L_1}\right) &amp; = -2(logL_0 - logL_1) \\
  &amp; = -2*[-1654.635 - (-1649.817)] = 9.635 \\
\end{align}\)</span></p>
<p>Degree of freedom = <span class="math inline">\(\displaystyle\frac{6*7}{2} - 13 = 21 - 13 = 8\)</span></p>
<div class="callout callout-style-simple callout-note callout-titled" title="Chi-Square 분포 특성">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chi-Square 분포 특성
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>자유도(df)가 커질수록 분포의 모양이 정규분포에 가까워짐</li>
<li>평균 = df, 분산 = 2df</li>
</ul>
</div>
</div>
<div id="cell-30" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="19">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="equations_files/figure-html/cell-19-output-1.png" width="640" height="400" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-33" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="22">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="equations_files/figure-html/cell-22-output-1.png" width="620" height="400" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\chi^2\)</span> 분포로부터 <span class="math inline">\(p = 0.292\)</span>, Bootstrap 샘플 중 29.8%</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\Sigma\)</span> = <span class="math inline">\(\Sigma(\theta)\)</span>이 참이라면, 상정한 모형의 <span class="math inline">\(\chi^2\)</span> 값 9.6보다 더 큰 <span class="math inline">\(\chi^2\)</span>값이 나올 확률이 대략 30%임.</li>
<li>이는 완전한 모형(포화모형)과 (likelihood 관점에서) 크게 다르지 않다는 것을 의미함.</li>
<li>기존의 관행처럼 <span class="math inline">\(p\)</span> &lt; 0.05 일 때, 모형이 완전한 적합도을 보이지 못한다고 판단할 수 있음.</li>
<li>즉, 공분산의 잔차 중 일부가 모집단에서 0이 아닐 수 있음을 의미함.</li>
</ul>
<div id="cell-35" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting function의 최소값</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(fit_sa, <span class="st">"fmin"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">nd =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fmin 
0.0349 </code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정한 모형의 log-likelihood &amp; unrestricted 모형의 log-likelihood, chi-square 값</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_sa, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"logl"</span>, <span class="st">"unrestricted.logl"</span>)) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            chisq            pvalue              logl unrestricted.logl 
            9.635             0.292         -1657.646         -1652.828 </code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_sa, <span class="at">fit.measures =</span> T, <span class="at">estimates =</span> F) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           138

Model Test User Model:
                                                      
  Test statistic                                 9.635
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.292

Model Test Baseline Model:

  Test statistic                               473.058
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.996
  Tucker-Lewis Index (TLI)                       0.993

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1657.646
  Loglikelihood unrestricted model (H1)      -1652.828
                                                      
  Akaike (AIC)                                3341.291
  Bayesian (BIC)                              3379.345
  Sample-size adjusted Bayesian (SABIC)       3338.218

Root Mean Square Error of Approximation:

  RMSEA                                          0.038
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.111
  P-value H_0: RMSEA &lt;= 0.050                    0.526
  P-value H_0: RMSEA &gt;= 0.080                    0.217

Standardized Root Mean Square Residual:

  SRMR                                           0.030</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="$\chi^2$ Test에서 주의할 점">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="math inline">\(\chi^2\)</span> Test에서 주의할 점
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>변수들이 multivariate normal에서 벗어날수록 (특히 kurtosis) bias가 발생할 수 있음</li>
<li>표본의 크기가 충분히 커야 함; 최소 100개 이상
<ul>
<li>파라미터의 수에 비례해서 더 많은 표본이 필요함; 가령 <em>N &lt; 200, p &gt; 30</em> 이면, <span class="math inline">\(\chi^2\)</span> 값이 부풀려짐.</li>
</ul></li>
<li>변수 간의 상관관계가 높을수록 틀린 모형에 대한 <span class="math inline">\(\chi^2\)</span> 값이 커짐</li>
<li>측정에 대한 신뢰도(reliability)가 낮을수록 통계적 검증력(power)를 낮춰 가설을 기각하기 어려움.</li>
<li>영가설이 “완벽한 모형”(<span class="math inline">\(\Sigma = \Sigma(\theta)\)</span>)이라는 점에서 현실적인 가설이 아님</li>
<li>기존의 가설 검증의 문제점을 그대로 지니고 있음; statistical significance vs.&nbsp;substantive significance
<ul>
<li>N이 큰 경우, <span class="math inline">\(\chi^2\)</span>값이 커져 가설을 쉽게 기각할 수 있음; 실제로는 <span class="math inline">\(\Sigma\)</span>와 <span class="math inline">\(\Sigma(\theta)\)</span>의 차이가 사소함에도 불구하고, 완벽한 모형은 아니라고 판단할 수 있음.</li>
<li>반대로, N이 작은 경우, <span class="math inline">\(\chi^2\)</span>값이 작아져 가설을 기각하기 어려움; 실제로는 <span class="math inline">\(\Sigma\)</span>와 <span class="math inline">\(\Sigma(\theta)\)</span>의 차이가 크더라도 완벽한 모형으로 판단할 수 있음.</li>
</ul></li>
</ul>
</div>
</div>
<p>모든 적합도 지수는 <span class="math inline">\(\mathbf{S}\)</span>와 <span class="math inline">\(\hat{\Sigma}(\theta)\)</span>의 함수임.<br>
특히, fitting function <span class="math inline">\(F_{ML}\)</span>은 <span class="math inline">\(\mathbf{S}\)</span>와 <span class="math inline">\(\hat{\Sigma}(\theta)\)</span>의 차이를 측정해주는 스칼러 함수임.</p>
<ul>
<li><span class="math inline">\(F_{ML} \to 0\)</span> as <span class="math inline">\(N \to \infty\)</span></li>
<li>추정할 파라미터를 늘리면 <span class="math inline">\(F_{ML}\)</span>는 감소함; 즉, 항상 더 나쁜 모형이 됨.</li>
</ul>
<p><span class="math inline">\(F_{ML}\)</span> 값 자체는 해석하기 어렵기 때문에, <span class="math inline">\(F_{ML}\)</span>을 이용한 <span class="math inline">\(\mathbf{S}\)</span>와 <span class="math inline">\(\hat{\Sigma}(\theta)\)</span>의 차이를 측정해주는 다른 지표들이 유용함.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Model fit indices">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model fit indices
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\chi^2\)</span> 테스트가 가설 검증의 논리로 yes/no를 판단하는 것인 반면,<br>
적합도 지표들은 모형이 데이터에 얼마나 잘 부합하는지를 연속적인 값으로 표현함.</p>
<p>과거 많은 지표들이 제안되어 왔으나, 시뮬레이션 연구등을 통해 현재까지 살아남아 널리 사용되고 보고되는 지표들은<br>
<strong>RMSEA, CFI/TLI, SRMR</strong></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="일화">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
일화
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>Sörbom(2001)이 Karl Jöreskog와 함께 한 1985년 워크숍에 대한 일화는 방금 설명한 근사적 적합도 지수에 대한 맥락을 제공합니다.</em><br>
<em>우리는 방금 GFI와 AGFI를 프로그램에 추가했습니다. Karl은 강의에서 카이 제곱만 있으면 충분하다고 말했습니다. 그러자 한 참가자가 “그럼 왜 GFI를 추가했나요?”라고 물었습니다. 그러자 Karl은 “음, 사용자들이 LISREL이 항상 그렇게 큰 카이 제곱을 생성하면 사용을 중단하겠다고 위협합니다. 그래서 사람들을 행복하게 할 무언가를 발명해야 했습니다. GFI가 그 목적에 부합합니다. (p.&nbsp;10)</em><br>
by Google Translate</p>
</blockquote>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;164, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
</section>
<section id="incremental-fit-index" class="level3">
<h3 class="anchored" data-anchor-id="incremental-fit-index">Incremental Fit Index</h3>
<p>Base 모형과 비교하여 (추가된 파라미터로 인해) 연구자의 모형이 얼마나 개선되었는지를 측정함.<br>
Base 모형은 기본적으로 가장 적합도가 낮은 모형, 즉 모든 변수들이 서로 독립이라고 가정한 모형으로 선택: <em>baseline model, indepdendent(null) model</em><br>
이는 <span class="math inline">\(R^2\)</span>와 유사한 접근임.</p>
<p><span class="math inline">\(\displaystyle\Delta_1 = \frac{\chi^2_b - \chi^2_m}{\chi^2_b - df_m}\)</span></p>
<ul>
<li>N의 크기에 덜 영향을 받도록 조정했음.</li>
<li>연구자의 모형이 맞다면, 분자의 값들의 평균을 분모의 값으로 이해할 수 있음. (<span class="math inline">\(E(\chi^2_m) = df_m\)</span>)</li>
</ul>
<p><strong>Tucker–Lewis Index (TLI)</strong>: Tucker &amp; Lewis (1973), Bentler &amp; Bonnett (1980)</p>
<p>TLI = <span class="math inline">\(\displaystyle\frac{\chi^2_b/df_b - \chi^2_m/df_m}{\chi^2_b/df_b - 1}\)</span></p>
<ul>
<li>동일한 <span class="math inline">\(F_{ML}\)</span>을 가질 때, 더 복잡한 모형(파라미터의 개수가 더 많은)이 더 낮은 <span class="math inline">\(df_m\)</span>를 가지게 되어 더 높은 값을 갖도록 함.</li>
<li>소위 parsimony-adjusted, 혹은 complexity에 대한 penalty를 부여함.</li>
<li>동시에 N에 따른 표본분포의 평균이 변하지 않도록 조정함.</li>
</ul>
</section>
<section id="rmsea" class="level3">
<h3 class="anchored" data-anchor-id="rmsea">RMSEA</h3>
<p>Steiger–Lind Root Mean Square Error of Approximation (Steiger, 1990)</p>
<p><span class="math inline">\(\displaystyle RMSEA = \sqrt{\frac{\hat{\delta}}{df_m(N-1)}} = \sqrt{\frac{\chi^2_{ML} - df_m}{df_m(N-1)}} = \sqrt{\frac{F_{ML}}{df_m} - \frac{1}{N-1}}\)</span></p>
<ul>
<li>연구자의 모형이 맞다면, <span class="math inline">\(\chi^2_{ML}\)</span> 값의 표본 분포가 <span class="math inline">\(\chi^2(df_m)\)</span>를 따르는데 반해,</li>
<li>연구자의 모형이 맞지 않다면, non-central <span class="math inline">\(\chi^2(df_m, ~\delta)\)</span> 분포를 따름
<ul>
<li><span class="math inline">\(\delta\)</span>: non-centrality parameter</li>
<li>평균은 <span class="math inline">\(df_m + \delta\)</span>임.</li>
</ul></li>
<li><span class="math inline">\(\delta\)</span>: 완전한 모형에서 벗어난 정도라도 볼 수 있고, <span class="math inline">\(\chi^2_{ML} - df_m\)</span>로 추정할 수 있음.
<ul>
<li><span class="math inline">\(\delta = 0\)</span>이면, 연구자의 모형이 완벽하고 central <span class="math inline">\(\chi^2(df_m)\)</span> 분포를 따름.</li>
<li>음수가 되지 않도록 <span class="math inline">\(max(\chi^2_{ML} - df_m, 0)\)</span>으로 계산함.</li>
</ul></li>
</ul>
<p>RMSEA에 대한 confidence interval:<br>
<span class="math inline">\(\displaystyle RMSEA_{lower} = \sqrt{max\left(0, \frac{\hat{\delta}_{.05}}{(N-1)df_m}\right)}\)</span>, &nbsp;&nbsp; <span class="math inline">\(\displaystyle RMSEA_{upper} = \sqrt{\frac{\hat{\delta}_{.95}}{(N-1)df_m}}\)</span></p>
<p>RMSEA &lt;= 0.05에 대한 가설검증: 0.05보다 작을 때, 모형이 데이터에 잘 부합한다고 보고 가설검증의 기준으로 사용함.</p>
<div class="callout callout-style-default callout-note callout-titled" title="RMSEA의 해석">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RMSEA의 해석
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Browne과 Cudeck(1993)은 <span class="math inline">\(\hat\epsilon\)</span> ≤ .05가 유리한 결과라고 제안했지만, Chen et al.(2008)의 이후 컴퓨터 시뮬레이션 연구 결과는 <span class="math inline">\(\hat\epsilon\)</span>이 단독으로 사용되든 90% 신뢰 구간과 함께 사용되든 .05 또는 다른 값의 보편적 임계값을 거의 뒷받침하지 않는다는 것을 나타냈습니다.</em><br>
<em>Browne과 Cudeck(1993)은 또한 <span class="math inline">\(\hat\epsilon\)</span> ≥ .10이 모델 적합도가 낮음을 나타낼 수 있지만 보장은 없다고 제안했습니다.</em></p>
<p><em>Browne and Cudeck (1993) suggested that <span class="math inline">\(\hat\epsilon\)</span> ≤ .05 is a favorable result, but results of later computer simulation studies by Chen et al.&nbsp;(2008) indicated little support for a universal threshold of .05—or any other value—regardless of whether <span class="math inline">\(\hat\epsilon\)</span> is used alone or jointly with its 90% confidence interval.</em><br>
<em>Browne and Cudeck (1993) also suggested that <span class="math inline">\(\hat\epsilon\)</span> ≥ .10 may indicate poor model fit, but there is no guarantee.</em></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;167, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
<p>예를 들어, 위의 CFA 예에서, 표본의 크기 N=200으로 생성된 데이터로부터 얻은 결과로 보면,<br>
<span class="math inline">\(\chi^2_{ML}(8) = 13.963\)</span>을 얻고, <span class="math inline">\(\hat\delta = 13.963 - 8 = 5.963\)</span>임.<br>
따라서, <span class="math inline">\(\chi^2_{ML}\)</span>값의 표본 분포는 <span class="math inline">\(\chi^2(8, ~5.963)\)</span>를 따름.</p>
<div id="cell-40" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="205">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(cov, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">type =</span> <span class="st">"exact"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>mod_sa <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">  sympathy =~ x1 + x2 + x3</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">  anger =~ x4 + x5 + x6</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>fit_sa <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod_sa, <span class="at">data =</span> df)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_sa, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>)) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df 
13.963  8.000 </code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="98">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="equations_files/figure-html/cell-27-output-1.png" width="595" height="467" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-42" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="206">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_sa, <span class="fu">c</span>(<span class="st">"rmsea"</span>, <span class="st">"rmsea.ci.lower"</span>, <span class="st">"rmsea.ci.upper"</span>, <span class="st">"rmsea.pvalue"</span>)) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         rmsea rmsea.ci.lower rmsea.ci.upper   rmsea.pvalue 
         0.061          0.000          0.113          0.317 </code></pre>
</div>
</div>
</section>
<section id="cfi" class="level3">
<h3 class="anchored" data-anchor-id="cfi">CFI</h3>
<p>Comparative Fit Index</p>
<p><span class="math inline">\(\displaystyle CFI = \frac{\hat\delta_b - \hat\delta_m}{\hat\delta_b}\)</span></p>
<ul>
<li><span class="math inline">\(\hat\delta_b = max(0, \chi^2_{b} - df_m)\)</span>, &nbsp; <span class="math inline">\(\hat\delta_m = max(0, \chi^2_{ML} - df_m)\)</span><br>
</li>
<li>Base 모형에 비해 연구자 모형의 non-centrality parameter가 얼마나 줄었는지 그 비율을 측정함.</li>
<li>TLI와 상관이 매우 높아, 주로 두 지표 중 하나만 보고함.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="CFI의 해석">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
CFI의 해석
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Hu와 Bentler(1995)는 CFI ≥ .95가 유리한 결과라고 제안했는데, 이 기준은 Hu와 Bentler(1999)와 같은 일부 후기 몬테카를로 연구의 결과와 일반적으로 일치합니다. 하지만 훨씬 더 최근의 시뮬레이션 연구의 결과는 모델의 변화와 데이터의 비정규성 정도에 대한 CFI에 대한 특정 임계값의 일반성을 뒷받침하지 못했습니다(Fan &amp; Sivo, 2005; Yuan, 2005). Brosseau-Liard와 Savalei(2014)가 설명한 비정규성에 대한 CFI의 robust 형태는 lavaan이 robust ML 방법에 따라 인쇄합니다.</em></p>
<p><em>Hu and Bentler (1995) suggested that CFI ≥ .95 is a favorable result, a benchmark generally consistent with results from some later Monte Carlo studies, such as Hu and Bentler (1999). But results from even more recent simulation studies failed to support the generality of any specific cutoff for the CFI over variations in models and degrees of nonnormality in the data (Fan &amp; Sivo, 2005; Yuan, 2005). Robust forms of the CFI for nonnormal described by Brosseau-Liard and Savalei (2014) are printed by lavaan for robust ML methods.</em></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;169, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
</section>
<section id="srmr" class="level3">
<h3 class="anchored" data-anchor-id="srmr">SRMR</h3>
<p>Standardized Root Mean Square Residual</p>
<p><span class="math inline">\(\displaystyle SRMR = \sqrt{Ave\left[\left(\frac{\sigma_{ij} - \hat\sigma_{ij}}{\sqrt{\sigma_{ii}\sigma_{jj}}}\right)^2\right]}\)</span></p>
<ul>
<li>상관계수의 잔차의 제곱의 평균에 대한 제곱근에 근사로 볼 수 있음.</li>
<li>대략적으로 상관계수의 차이의 평균으로 해석할 수 있음.</li>
<li>프로그램마다 조금 다르게 계산될 수 있음.</li>
<li>SRMR &lt; .08 일반적으로 유리한 것으로 간주됨(Hu &amp; Bentler, 1999)</li>
<li>하지만, 잔차 상관행렬의 각 성분을 직접 살펴보는 것이 더 좋음; 절대값이 0.1 이상이면 주의</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled" title="Thresholds for Fit Indices">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Thresholds for Fit Indices
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keith’s 교재 14장 ADVICE: MEASURES OF FIT 참고.</p>
<p>다음은 Kline’s(2023)에서 발췌</p>
<p><em>연속 근사 적합 지수에 대한 자연스러운 질문은 “허용 가능한” 또는 “좋은” 모델 적합도를 나타내는 값 범위와 관련이 있습니다. 안타깝게도 이 질문에 대한 간단한 답은 없습니다. 근사 적합 지수 값과 사양 오류의 심각성 또는 유형 사이에 카이 제곱 검정과 마찬가지로 직접적인 대응 관계가 없기 때문입니다. 또한 SEM에 대한 문헌이나 웹 페이지에서 볼 수 있는 RMSEA, CFI, SRMR 등의 지수에 대한 많은 해석 지침 또는 경험 규칙은 신뢰할 수 없습니다. 즉, 다양한 분야에서 분석된 광범위한 모델과 데이터에서 모델이 데이터에 “좋은” 적합도와 “나쁜” 적합도를 실제로 구별한다는 증거가 거의 없습니다.</em></p>
<p><em>A natural question about continuous approximate fit indexes involves the range of values indicating “acceptable” or even “good” model fit. Well, unfortunately, there is no simple answer to this question because there is no direct correspondence between values of approximate fit indexes and the seriousness or types of specification error, just as for the chi-square test. Also, many interpretive guidelines or rules of thumb for the RMSEA, CFI, and SRMR, among other indexes, seen in the literature or web pages about SEM are untrustworthy; that is, there is little evidence that they actually differentiate between model “good” versus “poor” fit to the data across the wide range of models and data analyzed in different disciplines.</em></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;170, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Dynamic (flexible) thresholds">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dynamic (flexible) thresholds
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://flexiblecutoffs.org/">Flexible Cutoffs: Package FCO</a><br>
Tailored cutoff values are generated for the RMSEA, CFI, TLI, and SRMR depending on the CFA model, the degree of nonnormality, and the amount of accepted uncertainty.</p>
<p><a href="https://github.com/melissagwolf/dynamic">Dynamic Fit Index Cutoffs For Latent Variable Models</a><br>
Simulates fit index cutoffs for latent variable models that are tailored to the user’s model statement, model type, and sample size.</p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;171, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
</div>
</div>
<p>Keith’s 교재 14장 ADVICE: MEASURES OF FIT 참고</p>
<p>흔히 적용하는 적합도 지수의 임계값들:<br>
<img src="images/table14-5.png" class="img-fluid" width="700"></p>
</section>
</section>
<section id="적합도에-평가에-대한-가이드라인-by-klein2023" class="level2">
<h2 class="anchored" data-anchor-id="적합도에-평가에-대한-가이드라인-by-klein2023">적합도에 평가에 대한 가이드라인 by Klein(2023)</h2>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;172, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
</div>
<p>번역 by Google Translate</p>
<p>다음에 설명된 방법은 SEM(Appelbaum et al., 2018)에 대한 보고 표준과 일치하며 연구자에게 과거 경험에서 사실이었던 것보다 더 많은 정보를 보고할 것을 요구합니다.</p>
<ol type="1">
<li><p>동시 추정 방법을 사용하는 경우 자유도와 p 값이 있는 모델 카이 제곱을 보고합니다. 결과 변수가 이분형이고 경로 계수가 이진 로지스틱 또는 프로빗 회귀 방법을 사용하여 추정되는 경우와 같이 모델 카이 제곱을 사용할 수 없는 일부 분석이 있습니다. 예를 들어 Muthén 및 Muthén(1998–2017, 3장)을 참조하세요. 그러나 이는 예외적인 경우입니다.</p></li>
<li><p>모델이 정확한 적합성 검정(exact-fit test)에 <strong><em>실패하면</em></strong> (a) 직접 그렇게 말하고 <strong><em>표본 크기에 관계없이</em></strong> (b) 모델을 잠정적으로 거부합니다. 다음으로 (c) 부적합의 크기와 가능한 원인을 모두 진단합니다(로컬 적합성 검사). 그 이유는 통계적으로 유의하지만 미미한 모델-데이터 불일치를 감지하여 실패를 설명하는 것입니다. 이는 대규모 샘플에서 발생할 가능성이 가장 높습니다. 모델을 거부하기로 한 초기 결정은 철회될 수 있지만, 관찰된 모델-데이터 불일치가 실제로 중요하지 않은 이유에 대한 설명과 함께 로컬 적합성 증거에 근거해야 합니다.</p></li>
<li><p>모델이 정확한 적합성 검정(exact-fit test)을 <strong><em>통과하더라도</em></strong> 여전히 지역적 적합성을 검사해야 합니다. 그 이유는 통계적으로 유의하지 않지만 모델에 의심을 품기에 충분히 큰 모델-데이터 불일치를 감지하는 것입니다. 이는 소규모 샘플에서 발생할 가능성이 가장 높습니다. <strong><em>지역적 적합성에 대한 증거가 상당한 불일치를 나타내는 경우 카이제곱 검정을 통과했더라도 모델을 거부해야 합니다.</em></strong></p></li>
<li><p>상관 관계, 표준화 또는 정규화된 잔차와 같은 잔차 행렬을 원고 본문에 보고합니다. 모델이 너무 커서 다루기 힘들다면 (a) 보충 자료에 이러한 표를 제공하고 (b) 논문에 더 큰 잔차의 위치와 부호와 같은 잔차 패턴을 설명합니다. 모델이 어떻게 잘못 지정되었는지 이해하는 데 진단적 가치가 있을 수 있는 패턴을 찾습니다. <strong><em>잔차에 대한 정보가 없는 결과 보고서는 불충분합니다.</em></strong> 불행히도 이 분야에서 불완전한 보고는 예외가 아니라 표준입니다. 예를 들어, 조직 관리 분야에서 발표된 144개의 SEM 연구를 검토한 결과, 이러한 작업의 약 17%에서만 잔차가 언급되었습니다(Zhang et al., 2021).</p></li>
<li><p>근사적 적합 지수 값을 보고하는 경우 이 장에서 앞서 설명한 최소 집합(RMSEA, CFI, SRMR)에 대한 값을 포함합니다. <strong><em>그러나 이러한 전역적 적합 통계에 대해 고정 또는 동적 임계값에만 의존하여 모델을 유지하는 것을 정당화하려고 하지 마십시오.</em></strong> 이는 특히 모델이 정확한 적합 테스트(exact-fit test)에 실패하고 잔차 패턴이 사소하지 않은 모형의 설정 오류(specification error)를 시사하는 경우에 해당합니다.</p></li>
<li><p>초기 모델을 다시 지정하는 경우 그렇게 하는 근거를 설명하세요. 또한 잔차와 같은 진단 통계가 재지정에서 어떤 역할을 했는지 설명해야 합니다. <strong><em>즉, 모델에 대한 양적 결과, 관련 이론, 원래 모델의 수정 사항 간의 연결을 지적하세요</em></strong>(3장). 정확한 적합도 검정(exact-fit test)에 여전히 실패한 다시 지정된 모델을 유지하는 경우 모델-데이터 불일치가 진정으로 미미하다는 것을 보여주세요. 그렇지 않으면 모델에 대한 상당한 공분산 증거가 없다는 것을 보여주지 못한 것입니다.</p></li>
<li><p>모델 적합도에 대한 통계적 증거는 중요하지만 모델을 유지할지 여부를 결정하는 유일한 요소는 아닙니다. <strong><em>예를 들어, 연구 문제를 감안할 때 파라미터 추정치는 타당해야 합니다.</em></strong> 동일한 인과 과정으로 생성된 향후 재현연구들에서 데이터 세트에 적합할 가능성이 합리적으로 높은 모델은 특정 데이터 세트에 잘 맞는 모델보다 선호되어야 합니다. 이는 잠재적으로 임의의 모든 데이터에 적합할 수 있는 복잡하고 과도하게 많은 파라미터가 포함된 모델의 경우에 특히 그렇습니다. 이러한 모델은 (a) 보다 간결한 모델보다 반증 가능성이 낮고 (b) 샘플과 설정의 변화에 ​​대해 일반화할 가능성이 낮습니다(Preacheret al., 2013).</p></li>
<li><p>모델이 유지되는 경우 연구자는 각각 동일한 데이터를 정확히 또는 거의 잘 설명하는 동등하거나 거의 동등한 버전보다 해당 모델이 선호되어야 하는 이유를 설명해야 합니다. 이 단계는 통계적 단계보다 훨씬 논리적이며, 심각한 경쟁 모델을 구별하기 위해 향후 연구에서 수행할 수 있는 작업을 설명하는 것도 포함됩니다. 동등하거나 거의 동등한 모델에 대한 완전한 보고는 드뭅니다. 따라서 신중한 독자는 이런 방식으로 자신의 SEM 분석을 두드러지게 만들 수 있습니다.</p></li>
<li><p>어떤 모델도 유지되지 않는 경우 분석에서 테스트한 이론에 대한 의미를 설명하는 데 학자로서의 기술이 필요합니다.</p></li>
</ol>
<p>결국 모델을 유지했는지 여부에 관계없이 진정한 영예는 최선을 다해 철저한 평가 프로세스를 논리적인 끝까지 따르는 데서 나옵니다. 시인 랄프 왈도 에머슨은 이렇게 말했습니다. 잘한 일에 대한 보상은 그것을 해냈다는 것입니다(Mikis, 2012, p.&nbsp;294).</p>
<div class="callout callout-style-default callout-note callout-titled" title="원문">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
원문
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The method outlined next is consistent with reporting standards for SEM (Appelbaum et al., 2018) and also calls on researchers to report more information about model fit than has been true in past experience:</p>
<ol type="1">
<li><p>If you use a simultaneous estimation method, report the model chi-square with its degrees of freedom and p value. There are some analyses, such as when outcome variables are dichotomous and path coefficients are estimated using methods for binary logistic or probit regression, where a model chi-square may be unavailable—see Muthén and Muthén (1998–2017, chap.&nbsp;3) for examples—but these are exceptional cases.</p></li>
<li><p>If the model fails the exact-fit test, then (a) directly say so and, regardless of sample size, (b) tentatively reject the model. Next, (c) diagnose both the magnitude and possible sources of misfit (inspect local fit). The rationale is to detect statistically significant but slight model–data discrepancies that explain the failure. This is most likely to happen in a large sample. The initial decision to reject the model could be rescinded, but only based on local fit evidence along with explanation about why observed model–data discrepancies are actually inconsequential.</p></li>
<li><p>If the model passes the exact-fit test, you still have to inspect local fit. The rationale is to detect model–data discrepancies that are not statistically significant but still great enough to cast doubt on the model. This most likely occurs in a small sample. If evidence about local fit indicates appreciable discrepancies, then the model should be rejected even though it passed the chisquare test.</p></li>
<li><p>Report a matrix of residuals, such as correlation, standardized, or normalized residuals, in the body of the manuscript. If the model is so large that doing so would be unwieldy, then (a) provide such tables in the supplemental materials and (b) describe in the manuscript the pattern of residuals, such as the locations of larger residuals and their signs. Look for patterns that may be of diagnostic value in understanding how the model may be misspecified. Any report of the results without information about the residuals is deficient. Unfortunately, incomplete reporting in this area is the norm rather than the exception. For example, in our review of 144 published SEM studies in the area of organizational management, residuals were mentioned in only about 17% of these works (Zhang et al., 2021).</p></li>
<li><p>If you report values of approximate fit indexes, then include those for the minimal set described earlier in this chapter. But do not try to justify retaining the model by depending solely on thresholds, either fixed or dynamic, for such global fit statistics. This is especially true if the model failed the exact-fit test and the pattern of residuals suggests a specification error that is not trivial.</p></li>
<li><p>If you respecify the initial model, explain the rationale for doing so. You should also explain the role that diagnostic statistics, such as residuals, played in the respecification. That is, point out the connections between the numerical results for the model, relevant theory, and modifications to the original model (Chapter 3). If you retain a respecified model that still fails the exact-fit test, then demonstrate that model–data discrepancies are truly slight; otherwise, you have neglected to show that there is no appreciable covariance evidence against the model.</p></li>
<li><p>Statistical evidence about model fit is important, but it is not the sole factor in deciding whether to retain a model. For example, the parameter estimates should make sense, given the research problem. Models with reasonable prospects for fitting data sets in future replications generated by the same causal processes should be preferred over models that fit a particular data set well. This is especially true for complex, overparameterized models that could potentially fit just about any arbitrary data. Such models are (a) less falsifiable than more parsimonious models and (b) less likely to generalize over variations in samples and settings (Preacheret al., 2013).</p></li>
<li><p>If a model is retained, then the researcher should explain why that model should be preferred over equivalent or near-equivalent versions that, respectively explain the same data exactly as well or nearly as well. This step is much more logical than statistical, and it also involves describing what might be done in future research to differentiate between any serious competing models. Complete reporting about equivalent or near-equivalent models is rare; thus, conscientious readers can really distinguish their own SEM analyses by addressing this issue. The generation and assessment of equivalent versions of structural models are covered in the next chapter.</p></li>
<li><p>If no model is retained, then your skills as a scholar are needed to explain the implications for the theory tested in your analysis.</p></li>
</ol>
<p>At the end of the day, regardless of whether or not you have a retained a model, the real honor comes from following, to the best of your ability, a thorough evaluation process to its logical end. The poet Ralph Waldo Emerson put it this way: The reward of a thing well done is to have done it (Mikis, 2012, p.&nbsp;294).</p>
</div>
</div>
</div>
</section>
<section id="local-fit-measures" class="level2">
<h2 class="anchored" data-anchor-id="local-fit-measures">Local Fit Measures</h2>
<p><strong>Parameter estimation</strong></p>
<ul>
<li>개별 파라미터의 추정값이 기대 혹은 이론과 얼마나 부합하는지 평가</li>
<li>부적절한 추정값은 모형의 부적합을 나타낼 수 있음; 모집단에서 불가능한 추정값
<ul>
<li>추정된 분산이 음수일 때; Heywood case</li>
<li>추정된 상관계수가 1보다 클 때</li>
</ul></li>
<li>실제로 경계값(boundary)일 가능성이 있다면 수용할 수 있음</li>
<li>그렇지 않다면,
<ul>
<li>모형이 심하게 잘못 지정되었을 가능성이 있음</li>
<li>이상치(outlier)가 존재할 수 있음</li>
<li>매우 이상한 표본을 사용했을 수 있음</li>
</ul></li>
</ul>
<p><strong><span class="math inline">\(R^2\)</span></strong>: 잔차의 분산(<span class="math inline">\(1-R^2\)</span>)을 통해 설명력을 평가할 필요가 있음</p>
</section>
</section>
<section id="model-comparison" class="level1">
<h1>Model Comparison</h1>
<p><strong>Nested Models</strong>: 원래의 모형에 제약을 가하거나 추가해 위계적으로 파라미터들를 공유하는(포함하는/포함되는) 모형들</p>
<ul>
<li>주로, 파라미터를 0으로 제약하거나, 두 파라미터가 동일하다고 제약</li>
<li>각 모형에 대한 <span class="math inline">\(\chi^2\)</span>값의 차이를 통해 비교함; chi-square difference test
<ul>
<li>그 차이가 <span class="math inline">\(df\)</span> = 두 모형의 자유도 차이, <span class="math inline">\(\chi^2\)</span> 분포를 따름</li>
<li>두 모형의 likelihood가 동일하다는 가설을 검정함; (log) likelihood ratio test</li>
</ul></li>
</ul>
<p>가령, (밑 박스 안의 그림) 모형 2: <span class="math inline">\(\chi^2(5) = 18.300, ~p = .003\)</span>&nbsp;을 얻고,<br>
직접 효과 b를 추정하는 모형 1: <span class="math inline">\(\chi^2(4) = 9.100, ~p = .059\)</span>&nbsp;을 얻었다면,</p>
<p><span class="math inline">\(\Delta df = 5 - 4 = 1\)</span>,<br>
<span class="math inline">\(\Delta\chi^2 = 18.300 - 9.100 = 9.200, ~p = .002\)</span>,</p>
<ul>
<li>즉, 직접 효과가 없다고 제약을 가한 모형2가 통계적으로 유의하게 나쁜 모형임</li>
<li>모형 1은 그 자체로 <span class="math inline">\(\chi^2\)</span> 테스트를 통과했으므로, 모형 1을 유지하는 것이 적절함.</li>
<li>단, 모형 1에 대한 다른 지표들도 충분히 좋다는 전제하에</li>
</ul>
<p>lavaan 패키지에서</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod2)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 또는 </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(mod1, mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled" title="Non-normal 데이터에 대한 robust ML로 추정하는 경우">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Non-normal 데이터에 대한 robust ML로 추정하는 경우
</div>
</div>
<div class="callout-body-container callout-body">
<p>Robust ML로 추정하는 경우 chi-square 값이 보정되기 때문에, chi-square difference test도 보정된 값으로 계산해야 함.<br>
참고: p.&nbsp;186, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
<p><code>lavTestLRT()</code> 함수를 사용하면 자동으로 보정된 값을 표시/계산함.</p>
</div>
</div>
<section id="respecification" class="level2">
<h2 class="anchored" data-anchor-id="respecification">Respecification</h2>
<p>모형이 데이터에 부합하지 않는다고 판단될 때, 모형의 specification을 조정하여 모형을 개선할 수 있음.</p>
<ul>
<li>탐색적 분석의 성격이 강하므로, 가이드/조언 정도로 접근할 필요가 있음.<br>
</li>
<li>이론적 정당화가 반드시 필요함.</li>
<li>이상적으로, 새로운 표본을 이용하여 재검증하는 것이 바람직함.</li>
</ul>
<p>다음과 같이 기계적인 절차를 통한 적합도 개선은 피해야 함.</p>
<ul>
<li>파라미터를 추가로 추정(free parameter)하는 절차를 통해 점차 적합도를 계속 높일 수 있음</li>
<li>적합도가 높아져 데이터에 더 잘 적합(fit)되지만, 그것이 더 진실된 모형이 되는 것은 아님.
<ul>
<li>모형의 복잡도가 증가하는 것에 대한 패널티가 적용되는 적합도 지수도 있음.</li>
</ul></li>
<li>반대로, 파라미터의 제약을 늘려 적합도가 심각히 낮아지지 않는 선까지 모형을 단순화할 수 있음.</li>
</ul>
<div class="callout callout-style-simple callout-tip callout-titled" title="Emprical vs. Theoretical">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Emprical vs.&nbsp;Theoretical
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>가령, 아래 그림에서 b를 free parameter로 추정한 후 유의하지 않다고 통계적으로 파악되었기 때문에 경로 b에 제약을 가해 오른쪽 모형을 만드는 것은 올바르지 못함; empirical/statistical-based<br>
</li>
<li>모형에 대한 설정은 이론적인 근거를 바탕으로 해야 함; theory/substantive-based</li>
</ul>
<p><img src="images/fig12-2.png" class="img-fluid" width="350"> <img src="images/fig12-2f.png" class="img-fluid" width="350"></p>
</div>
</div>
<div class="columns">
<div class="column" style="width:60%;">
<p>예제: <strong>CFA of perceived air quality:</strong> an environmental study of the relation between objective and subjective air quality</p>
<ul>
<li>x1: overall air quality</li>
<li>x2: the clarity</li>
<li>x3: color</li>
<li>x4: odor</li>
</ul>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;297, Bollen, K. A. (1989). Structural Equations with Latent Variables.</p>
</div>
</div><div class="column" style="width:40%;">
<p><img src="images/cfa-airquality.png" class="img-fluid" width="300"></p>
</div>
</div>
<div id="cell-55" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="st">  0.331</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="st">  0.431 1.160</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">  0.406 0.847 0.898</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">  0.216 0.272 0.312 0.268</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"overall"</span>, <span class="st">"clarity"</span>, <span class="st">"color"</span>, <span class="st">"odor"</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>model_air <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="st">  air_quality =~ overall + clarity + color + odor</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>fit_air <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_air, <span class="at">sample.cov =</span> cov, <span class="at">sample.nobs =</span> <span class="dv">74</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_air, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> <span class="st">"std.all"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 23 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         8

  Number of observations                            74

Model Test User Model:
                                                      
  Test statistic                                21.194
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               211.967
  Degrees of freedom                                 6
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.907
  Tucker-Lewis Index (TLI)                       0.720

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -234.488
  Loglikelihood unrestricted model (H1)       -223.891
                                                      
  Akaike (AIC)                                 484.975
  Bayesian (BIC)                               503.408
  Sample-size adjusted Bayesian (SABIC)        478.197

Root Mean Square Error of Approximation:

  RMSEA                                          0.360
  90 Percent confidence interval - lower         0.232
  90 Percent confidence interval - upper         0.506
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.063

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)  Std.all
  air_quality =~                                               
    overall           1.000                               0.817
    clarity           1.977    0.223    8.865    0.000    0.863
    color             1.894    0.195    9.717    0.000    0.939
    odor              0.754    0.117    6.445    0.000    0.685

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)  Std.all
   .overall           0.109    0.022    5.023    0.000    0.332
   .clarity           0.293    0.066    4.427    0.000    0.256
   .color             0.104    0.043    2.396    0.017    0.118
   .odor              0.140    0.025    5.654    0.000    0.531
    air_quality       0.218    0.052    4.186    0.000    1.000
</code></pre>
</div>
</div>
<p>Color의 측정오차와 clarity의 측정오차가 상관관계가 있을 수 있음.</p>
<blockquote class="blockquote">
<p><em>“설문지를 실시한 사람은 일부 응답자가 색상과 선명도 질문의 차이를 구별하는 데 어려움을 겪었다고 밝혔습니다. 이는 맑은 공기는 색상이 없을 것으로 예상하고, 반대로 공기의 색상이 나쁘면 선명도 평가도 나쁠 것이기 때문에 타당해 보였습니다. 한 지표에 대한 응답 오류가 부분적으로 구분할 수 없는 다른 지표의 오류와 상관관계가 있을 수 있기 때문에 선명도 측정 오류가 색상 측정 오류와 상관관계가 있었을 수 있습니다.”</em></p>
</blockquote>
<div id="cell-57" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>model_air_modi <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="st">  air_quality =~ overall + clarity + color + odor</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="st">  color ~~ clarity</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>fit_air_modi <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_air_modi, <span class="at">sample.cov =</span> cov, <span class="at">sample.nobs =</span> <span class="dv">74</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_air_modi, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> <span class="st">"std.all"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 26 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         9

  Number of observations                            74

Model Test User Model:
                                                      
  Test statistic                                 5.581
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.018

Model Test Baseline Model:

  Test statistic                               211.967
  Degrees of freedom                                 6
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.978
  Tucker-Lewis Index (TLI)                       0.867

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -226.681
  Loglikelihood unrestricted model (H1)       -223.891
                                                      
  Akaike (AIC)                                 471.363
  Bayesian (BIC)                               492.099
  Sample-size adjusted Bayesian (SABIC)        463.737

Root Mean Square Error of Approximation:

  RMSEA                                          0.249
  90 Percent confidence interval - lower         0.082
  90 Percent confidence interval - upper         0.466
  P-value H_0: RMSEA &lt;= 0.050                    0.029
  P-value H_0: RMSEA &gt;= 0.080                    0.952

Standardized Root Mean Square Residual:

  SRMR                                           0.024

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)  Std.all
  air_quality =~                                               
    overall           1.000                               0.940
    clarity           1.438    0.208    6.914    0.000    0.722
    color             1.396    0.175    7.959    0.000    0.797
    odor              0.738    0.096    7.679    0.000    0.771

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)  Std.all
 .clarity ~~                                                   
   .color             0.256    0.076    3.364    0.001    0.608

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)  Std.all
   .overall           0.038    0.025    1.493    0.135    0.115
   .clarity           0.547    0.107    5.116    0.000    0.478
   .color             0.323    0.072    4.501    0.000    0.365
   .odor              0.107    0.022    4.852    0.000    0.405
    air_quality       0.289    0.059    4.923    0.000    1.000
</code></pre>
</div>
</div>
<section id="modification-indices" class="level3">
<h3 class="anchored" data-anchor-id="modification-indices">Modification indices</h3>
<ul>
<li>파라미터가 추가로 추정할 때 <span class="math inline">\(\chi^2\)</span> 값이 얼마나 감소하는지를 추정; Lagrangian multiplier test</li>
<li>한번에 하나씩 변화시켜야 함; 하나를 수정하면, 다른 것들이 영향을 받을 수 있음</li>
</ul>
<div id="cell-59" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationIndices</span>(fit_air, <span class="at">sort =</span> T) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs op     rhs     mi    epc sepc.lv sepc.all sepc.nox
13 clarity ~~   color 16.282  0.342   0.342    1.959    1.959
12 overall ~~    odor 16.282  0.069   0.069    0.558    0.558
14 clarity ~~    odor  9.906 -0.097  -0.097   -0.479   -0.479
11 overall ~~   color  9.906 -0.123  -0.123   -1.159   -1.159
10 overall ~~ clarity  0.254 -0.019  -0.019   -0.108   -0.108
15   color ~~    odor  0.254 -0.014  -0.014   -0.115   -0.115</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_air, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>)) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_air_modi, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>)) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df 
21.194  2.000 
chisq    df 
5.581 1.000 </code></pre>
</div>
</div>
<div id="cell-61" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="39">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-Squared Difference Test</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_air, fit_air_modi) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 또는 </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(fit_air, fit_air_modi) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

             Df    AIC    BIC   Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
fit_air_modi  1 471.36 492.10  5.5814                                          
fit_air       2 484.98 503.41 21.1940     15.613 0.44437       1  7.774e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Chi-Squared Difference Test

             Df    AIC    BIC   Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
fit_air_modi  1 471.36 492.10  5.5814                                          
fit_air       2 484.98 503.41 21.1940     15.613 0.44437       1  7.774e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>공분산 잔차을 통해 수정한다면?</p>
<ul>
<li>잔차가 높은 변수 쌍에 문제가 있다는 것을 일부 암시해주지만, 반드시 문제가 있다고 볼 수 없음.</li>
<li>implied covariance는 여러 파라미터들의 함수이므로 복잡하게 작용됨.</li>
</ul>
<div id="cell-63" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_air, <span class="at">type =</span> <span class="st">"cor"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
        overll clarty  color   odor
overall  0.000                     
clarity -0.009  0.000              
color   -0.023  0.019  0.000       
odor     0.166 -0.103 -0.007  0.000
</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="35">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_air, <span class="at">type =</span> <span class="st">"normalized"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
        overll clarty  color   odor
overall  0.000                     
clarity -0.065  0.000              
color   -0.157  0.129  0.000       
odor     1.153 -0.797 -0.054  0.000
</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_air, <span class="at">type =</span> <span class="st">"standardized"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "standardized"

$cov
        overll clarty  color   odor
overall  0.000                     
clarity -0.532  0.000              
color   -3.700  3.200  0.000       
odor     3.200 -3.700 -0.532  0.000
</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Tips for Inspecting the Residuals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tips for Inspecting the Residuals
</div>
</div>
<div class="callout-body-container callout-body">
<p>Source: p.&nbsp;173, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</p>
<p>잔차에 대해 보고하는 것이 중요하지만, 카이제곱 검정의 결과와 근사 적합 지수 값과 마찬가지로 잔차 크기와 모델의 잘못된 지정(specification) 유형 또는 정도 사이에는 신뢰할 수 있는 연관성이 없다는 점을 알아야 합니다.</p>
<p>예를 들어 상대적으로 작은 상관 잔차로 나타나는 지정(specification) 오류의 정도는 경미할 수도 있지만 심각할 수도 있습니다. 한 가지 이유는 다음 장에서 정의되는 수정 지수(modification index)를 포함한 잔차(residuals) 및 기타 진단 통계 값 자체가 잘못된 지정의 영향을 받기 때문입니다. 두 번째 이유는 모델의 한 부분의 잘못된 지정으로 인해 모델의 다른 부분의 추정이 왜곡되어 전역 추정(global estimation)으로 오류가 전파되기 때문입니다. 세 번째는 잔차가 동일하지만 인과 효과의 모순된 패턴을 갖는 등가(equivalent) 모델입니다. 그러나 우리는 일반적으로 모델의 어느 부분이 잘못된지 미리 알 수 없으므로 잔차가 우리에게 말하는 것을 정확히 이해하기 어려울 수 있습니다.</p>
<p>잔차 패턴을 검사하는 것이 때로는 도움이 될 수 있습니다. <span class="math inline">\(r_{XY}\)</span> &gt; 0인 한 쌍의 변수 X와 Y가 간접적인 인과 경로로만 연결되어 있다고 가정합니다. 해당 쌍의 잔차는 양수입니다. 즉, 모델이 해당 쌍의 연관성을 과소 예측한다는 의미입니다. 이 경우 X와 Y 사이에 직접적인 인과관계가 없다는 가설은 의심스러울 수 있으며, 따라서 이들 사이에 직접적인 인과관계를 추가하는 재지정(re-specification)이 고려해 볼 수 있습니다. 또 다른 가능성은 두 변수가 모두 내생변수인 경우 교란(disturbance) 상관 관계를 지정하는 것입니다. 그러나 모델에 추가할 효과 유형(인과 대 비인과 관계) 또는 방향성(예: X가 Y를 유발하고 Y가 X를 유발함)은 잔차가 우리에게 말해 줄 수 있는 것이 아닙니다. 전역 적합(global fit) 통계에 마법이 없는 것처럼 진단 통계에도 마법이 없습니다. 적어도 연구자들이 재지정(respecificaiton)에 대해 매우 신중하게 생각해야 하는 부담을 덜어줄 수 있는 것은 없습니다.</p>
<p><em>번역 by Google Translate</em></p>
</div>
</div>
</section>
</section>
<section id="non-nested-models" class="level2">
<h2 class="anchored" data-anchor-id="non-nested-models">Non-nested Models</h2>
<p><em>Source: pp.&nbsp;190-194, Klein, R. B. (2023). Principles and Practice of Structural Equation Modeling (5e)</em></p>
<p>동일한 데이터, 동일한 변수로 구성된 두 개의 서로 다른 모형이 내포되어 있지 않은 경우</p>
<ul>
<li>서로 다른 이론에 기반한 두 개 이상의 모형을 비교하는 경우가 종종 발생</li>
<li>모델 적합도와 모델 복잡성을 모두 반영하여 이 두 속성이 서로 균형 이루도록 함; 복잡성에 대한 페널티가 부과</li>
<li>비슷한 적합도를 가진 모형 중에서는 더 간단한 모형을 선호함; 모집단에서의 일반화 가능성이 높음!</li>
<li>현재까지 매우 신뢰할 만한 지표는 없음</li>
<li>정보이론에 기반하거나 bootstrapping을 통한 방법이 제안됨</li>
</ul>
<section id="aic" class="level3">
<h3 class="anchored" data-anchor-id="aic">AIC</h3>
<p>Akaike Information Criterion</p>
<ul>
<li>3가지 버전이 있음; 프로그램마다 다름<br>
</li>
<li>두 모형에 대한 차이를 보는 것이 목적이므로, 어떤 버전도 상관 없음</li>
<li>표본의 수가 커질 수록, <span class="math inline">\(L_0\)</span>가 감소하는데, 따라서 복잡성에 대한 페널티의 상대적 중요성이 감소함.</li>
</ul>
<p>연구자 모형의 log-likelihood를 <span class="math inline">\(L_0\)</span>, free parameter의 수를 <span class="math inline">\(q\)</span>라 하면,</p>
<p><span class="math inline">\(AIC = -2\log L_0 + 2q\)</span> <span class="math inline">\(\begin{align}
AIC_2 &amp; = \chi^2_{ML} + 2q \\~
  &amp; = -2\log L_0 + 2\log L_1 + 2q, ~~ L_1: likelihood ~for ~the ~perfect ~model\\
\end{align}\)</span><br>
<span class="math inline">\(AIC_3 = \chi^2_{ML} - 2df_M\)</span></p>
</section>
<section id="bic" class="level3">
<h3 class="anchored" data-anchor-id="bic">BIC</h3>
<p>Bayesian Information Criterion</p>
<ul>
<li>모형의 복잡성에 대한 페널티가 AIC에 비해 (표본이 커질 수록) 더 큼</li>
<li>표본의 수가 커질 수록 <span class="math inline">\(L_0\)</span>가 감소하는 것을 상쇄시키면서 복잡성에 대한 페널티를 더 강하게 부과함.</li>
<li>AIC와 BIC는 전혀 다른 이론적 기반을 가지고 있음</li>
</ul>
<p><span class="math inline">\(BIC = -2\log L_0 + q\log N\)</span><br>
<span class="math inline">\(BIC_2 = \chi^2_{ML} + q\log N\)</span></p>
<ul>
<li>AIC는 BIC보다 복잡한 모델을 선호하는 경향이 있음.</li>
<li>모델이 너무 복잡해지는 과적합(overfitting)이 우려되는 경우, BIC가 더 적합할 수 있음.</li>
<li>모델이 너무 단순해지는 과소적합(underfitting)이 더 큰 문제라면, AIC가 유리할 수 있음.</li>
<li>탐색적 요인 분석에서 잠재 변수를 정확하게 추정하는 것이 목표일 때:
<ul>
<li>요인을 너무 많이 추정하는 것이 더 큰 오류로 간주된다면, BIC가 AIC보다 나은 선택일 수 있음.</li>
<li>요인을 너무 적게 추정하는 것이 더 심각한 오류라면, AIC가 더 유리할 수 있음.</li>
</ul></li>
<li>Lin et al.&nbsp;(2017)의 매개경로 모델 시뮬레이션 결과에 따르면:
<ul>
<li>잘못 지정된 파라미터가 적을 때, AIC가 더 정확했으며, BIC는 지나치게 간결한 모델을 선택하는 경향이 있었음.</li>
<li>잘못 지정된 파라미터가 많을 때, BIC가 더 정확해졌고, AIC는 지나치게 복잡한 모델을 선택함.</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="power-and-precision" class="level1">
<h1>Power and Precision</h1>
<p>A prior (prospective) power analysis</p>
<ul>
<li>The probability of detecting a true effect</li>
<li>여러 방법이 제안되어 있음; Kline(2023) 참고</li>
</ul>
<p><img src="images/kline-fig10-3.png" class="img-fluid" width="620"></p>
<p>In Table 10.3 at N = 373, if the model does not have close fit in the population, the probability of correctly rejecting in significance testing the close-fit hypothesis is .317. The minimum sample size required for power ≥ .90 is N = 1,997.</p>
<p>The MacCallum-RMSEA method (MacCallum et al., 1996): based on the noncentral chi-square distribution and the RMSEA.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findRMSEApower</span>(rmsea0, rmseaA, df, n, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">group =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Power at N = 373</strong></p>
<div id="cell-74" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exact fit</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEApower</span>(<span class="dv">0</span>, .<span class="dv">05</span>, <span class="dv">5</span>, <span class="dv">373</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3378327</code></pre>
</div>
</div>
<div id="cell-75" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># close fit</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEApower</span>(.<span class="dv">05</span>, .<span class="dv">08</span>, <span class="dv">5</span>, <span class="dv">373</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3172584</code></pre>
</div>
</div>
<div id="cell-76" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not-close fit</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEApower</span>(.<span class="dv">05</span>, .<span class="dv">01</span>, <span class="dv">5</span>, <span class="dv">373</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2291066</code></pre>
</div>
</div>
<div id="cell-77" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># poor fit</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEApower</span>(.<span class="dv">10</span>, .<span class="dv">05</span>, <span class="dv">5</span>, <span class="dv">373</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6127939</code></pre>
</div>
</div>
<p><strong>Minimum N for power at least .90</strong></p>
<div id="cell-79" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exact fit</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEAsamplesize</span>(<span class="dv">0</span>, .<span class="dv">05</span>, <span class="dv">5</span>, .<span class="dv">90</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1319</code></pre>
</div>
</div>
<div id="cell-80" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># close fit</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEAsamplesize</span>(.<span class="dv">05</span>, .<span class="dv">08</span>, <span class="dv">5</span>, .<span class="dv">90</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1997</code></pre>
</div>
</div>
<div id="cell-81" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># not-close fit</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEAsamplesize</span>(.<span class="dv">05</span>, .<span class="dv">01</span>, <span class="dv">5</span>, .<span class="dv">90</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1527</code></pre>
</div>
</div>
<div id="cell-82" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># poor fit</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">findRMSEAsamplesize</span>(.<span class="dv">10</span>, .<span class="dv">05</span>, <span class="dv">5</span>, .<span class="dv">90</span>, .<span class="dv">05</span>, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 758</code></pre>
</div>
</div>
<!-- > 이러한 맥락에서 일반적으로 자유도가 많은 모델을 다루는 것을 선호한다는 점에 유의하는 것도 중요합니다. 자유도 개념의 직관적인 의미는 모델을 부정(disconfirm)할 수 있는 차원이기 때문입니다. 따라서 모델의 자유도가 많을수록 모델을 거부할 수 있는 차원이 많아지고, 따라서 데이터에 대해 테스트할 때 모델을 부정할 수 있는 가능성이 높아집니다. 포퍼의 논리에 따르면 경험적 과학은 모델을 확증할 수 없고 부인할 수만 있기 때문에 이는 테스트 프로세스의 바람직한 특징입니다. 따라서 연구된 현상을 그럴듯하게 설명하는 두 가지 모델이 있는 경우, 자유도가 더 높은 모델이 데이터 설명 및 설명 수단으로 더 강력한 후보로 고려될 수 있습니다. 그 이유는 더 많은 자유도를 가진 모델이 거부될 가능성이 더 높기 때문이며, 거부되지 않았다면 그 모델을 통해 얻은 결과를 더 신뢰할 수 있는 것으로 볼 수 있기 때문입니다. 이러한 추론은 본질적으로 SEM 문헌에서 널리 논의되는 파시모니(parsimony) 원칙의 개념적 기초입니다(예: Raykov & Marcoulides, 1999 및 이에 대한 참고 문헌). 따라서 경험적 과학의 목표는 반증가능한(falsifiable) 이론을 수립하는 것이라고 주장하는 포퍼의 논리는 파시모니(parsimony) 원칙의 적용을 통해 촉진됩니다. 더 간결한(parsimonious) 모델이 수용 가능한 것으로 밝혀지면, 덜 간결한 모델보다 거부될 가능성이 더 높기 때문에 더 많은 신뢰를 가질 수 있습니다. 그러나 연구자들은 파시모니(parsimony) 원칙을 기계적이고 융통성 없이 적용하면 잘못된 모델에 유리한 결론을 내리고, 올바른 모델과 양립할 수 없는 함의를 도출할 수 있다는 점에 주의를 기울여야 합니다. (번역 by DeepL)

::: {style="line-height: 1.5em; font-size: .9em"}
Source: p. 42, Raykov, T., & Marcoulides, G. A. (2006). A first course in structural equation modeling (2e)
::: -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sem\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/ml.html" class="pagination-link" aria-label="ML Estimation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">ML Estimation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>