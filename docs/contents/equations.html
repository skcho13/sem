<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-09-30">

<title>Structural Equations –  CHA Statistics II in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/ml.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Structural Equations –  CHA Statistics II in R">
<meta property="og:description" content="Multiple Regression and Beyond (3e) by Timothy Z. Keith">
<meta property="og:site_name" content="CHA Statistics II in R">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Structural Equations</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics II in R</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages for SEM</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Keith’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multigroup Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/equations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">SEM Equations</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Kline’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/Kline/composite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reflective</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: Formative</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: PLS-PM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: HO</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#structural-equation-model-sem-matrix-representation" id="toc-structural-equation-model-sem-matrix-representation" class="nav-link active" data-scroll-target="#structural-equation-model-sem-matrix-representation">Structural Equation Model (SEM) Matrix Representation</a></li>
  <li><a href="#parameter-estimation" id="toc-parameter-estimation" class="nav-link" data-scroll-target="#parameter-estimation">Parameter Estimation</a>
  <ul>
  <li><a href="#데이터로부터-최선의-파라미터를-추정" id="toc-데이터로부터-최선의-파라미터를-추정" class="nav-link" data-scroll-target="#데이터로부터-최선의-파라미터를-추정">데이터로부터 최선의 파라미터를 추정</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation">Estimation</a></li>
  <li><a href="#model-indentification" id="toc-model-indentification" class="nav-link" data-scroll-target="#model-indentification">Model Indentification</a></li>
  </ul></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model Evaluation</a>
  <ul>
  <li><a href="#overall-fit-measures" id="toc-overall-fit-measures" class="nav-link" data-scroll-target="#overall-fit-measures">Overall Fit Measures</a>
  <ul class="collapse">
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals"><strong>Residuals</strong></a></li>
  <li><a href="#chi-square-chi2-test" id="toc-chi-square-chi2-test" class="nav-link" data-scroll-target="#chi-square-chi2-test"><strong>Chi-Square( <span class="math inline">\(\chi^2\)</span>) Test</strong></a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Structural Equations</h1>
<p class="subtitle lead">Multiple Regression and Beyond (3e) by Timothy Z. Keith</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<details class="code-fold">
<summary>Load libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="structural-equation-model-sem-matrix-representation" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation-model-sem-matrix-representation">Structural Equation Model (SEM) Matrix Representation</h2>
<div style="line-height: 1.5em; font-size: .9em">
<p>Measures of political democracy and industrialization for 75 developing countries in 1960 and 1965</p>
<ul>
<li>y1. freedom of the press, 1960</li>
<li>y2. freedom of political opposition, 1960</li>
<li>y3. fairness of elections, 1960</li>
<li>x1. natural log of GNP per capita, 1960</li>
<li>x2. natural log of energy consumption per capita, 1960</li>
</ul>
</div>
<div class="columns">
<div class="column" style="width:55%;">
<p><img src="images/bolle-path-1.png" class="img-fluid" width="450"></p>
</div><div class="column" style="width:45%;">
<p><br> <br></p>
<div style="line-height: 2em; font-size: .9em">
<ul>
<li>외생변수(Exogenous variables): <span class="math inline">\(X1, X2\)</span></li>
<li>내생변수(Endogenous variables): <span class="math inline">\(Y1, Y2, Y3\)</span></li>
<li>경로계수(Path coefficients)
<ul>
<li><span class="math inline">\(\gamma\)</span>: <span class="math inline">\(X\)</span>와 <span class="math inline">\(Y\)</span>의 관계</li>
<li><span class="math inline">\(\beta\)</span>: <span class="math inline">\(Y\)</span>와 <span class="math inline">\(Y\)</span>의 관계</li>
</ul></li>
<li>오차항(Error terms): <span class="math inline">\(\zeta\)</span></li>
</ul>
</div>
</div>
</div>
<div style="line-height: 1.5em; font-size: .9em">
<p>Figure 4.2 Union Sentiment Model for Southern Textile Workers<br>
Source: p.&nbsp;83, Bollen, K. A. (1989). Structural equations with latent variables</p>
</div>
<p><strong>Matrix representation of the model:</strong></p>
<p><span class="math display">\[
\mathbf{Y} = \mathbf{B}\mathbf{Y} + \mathbf{\Gamma}\mathbf{X} + \boldsymbol{\zeta}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
y_1 \\ y_2 \\ y_3
\end{bmatrix} =
\begin{bmatrix}
0 &amp; 0 &amp; 0 \\
\beta_{21} &amp; 0 &amp; 0 \\
\beta_{31} &amp; \beta_{32} &amp; 0
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2 \\ y_3
\end{bmatrix} +
\begin{bmatrix}
0 &amp; \gamma_{12} \\
0 &amp; \gamma_{22} \\
\gamma_{31} &amp; 0
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} +
\begin{bmatrix}
\zeta_1 \\ \zeta_2 \\ \zeta_3
\end{bmatrix}
\]</span></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>The covariance matrix of exogenous variables:</p>
<p><span class="math display">\[
\mathbf{\Phi} =
\begin{bmatrix}
\phi_{11} &amp; \phi_{12} \\
\phi_{21} &amp; \phi_{22}
\end{bmatrix}
\]</span></p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>The covariance matrix of error terms:</p>
<p><span class="math display">\[
\mathbf{\Psi} =
\begin{bmatrix}
\psi_{11} &amp; 0 &amp; 0 \\
0 &amp; \psi_{22} &amp; 0 \\
0 &amp; 0 &amp; \psi_{33}
\end{bmatrix}
\]</span></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 50]">
<div class="quarto-layout-row">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div style="line-height: 1.8em; font-size: .9em">
<ul>
<li><span class="math inline">\(\mathbf{Y}\)</span> is the vector of endogenous variables</li>
<li><span class="math inline">\(\mathbf{X}\)</span> is the vector of exogenous variables</li>
<li><span class="math inline">\(\mathbf{B}\)</span> is the matrix of path coefficients between endogenous variables</li>
<li><span class="math inline">\(\mathbf{\Gamma}\)</span> is the matrix of path coefficients from exogenous to endogenous variables</li>
</ul>
</div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div style="line-height: 1.8em; font-size: .9em">
<ul>
<li><span class="math inline">\(\boldsymbol{\zeta}\)</span> is the vector of error terms</li>
<li><span class="math inline">\(\mathbf{\Phi}\)</span> is the covariance matrix of exogenous variables</li>
<li><span class="math inline">\(\mathbf{\Psi}\)</span> is the covariance matrix of error terms</li>
</ul>
</div>
</div>
</div>
</div>
<div id="cell-3" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="41">
<details class="code-fold">
<summary>data and model</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A dataset from Bollen (1989) containing measures of political democracy and industrialization for 75 developing countries in 1960 and 1965. </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>bollen1989a <span class="ot">&lt;-</span> MIIVsem<span class="sc">::</span>bollen1989a <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fig 4.2</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">  y3 ~ x1 + y1 + y2</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">  y2 ~ x2 + y1</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">  y1 ~ x2</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> bollen1989a, <span class="at">fixed.x =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-4" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="49">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients: betas &amp; gamma</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fit, <span class="at">what =</span> <span class="st">"est"</span>)<span class="sc">$</span>beta <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   y3   y2   y1   x1   x2
y3  0 0.06 0.76 0.36 0.00
y2  0 0.00 0.88 0.00 0.16
y1  0 0.00 0.00 0.00 0.56
x1  0 0.00 0.00 0.00 0.00
x2  0 0.00 0.00 0.00 0.00</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="50">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariances: psi &amp; phi</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fit, <span class="at">what =</span> <span class="st">"est"</span>)<span class="sc">$</span>psi <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     y3   y2   y1   x1   x2
y3 5.64                    
y2 0.00 9.71               
y1 0.00 0.00 6.09          
x1 0.00 0.00 0.00 0.53     
x2 0.00 0.00 0.00 0.98 2.25</code></pre>
</div>
</div>
</section>
<section id="parameter-estimation" class="level2">
<h2 class="anchored" data-anchor-id="parameter-estimation">Parameter Estimation</h2>
<p><img src="images/bollen-path-4.png" class="img-fluid" width="500"></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Source: p.&nbsp;86, Bollen, K. A. (1989). Structural equations with latent variables</p>
</div>
<p><span class="math inline">\(y_1 = \gamma_{11}x_1 + \zeta_1\)</span><br>
<span class="math inline">\(y_2 = \beta_{21}y_1 + \zeta_2\)</span></p>
<p>Matrix representation:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[50, 15, 35]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><span class="math inline">\(\begin{bmatrix}
y_1 \\ y_2
\end{bmatrix} =
\begin{bmatrix}
0 &amp; 0 \\
\beta_{21} &amp; 0
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2
\end{bmatrix} +
\begin{bmatrix}
\gamma_{11} \\
0 \\
\end{bmatrix}
\begin{bmatrix}
x_1
\end{bmatrix} +
\begin{bmatrix}
\zeta_1 \\ \zeta_2
\end{bmatrix}\)</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: flex-start;">
<p><span class="math inline">\(\mathbf{\Phi} =
\begin{bmatrix}
\phi_{11}
\end{bmatrix}\)</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 35.0%;justify-content: flex-start;">
<p><span class="math inline">\(\mathbf{\Psi} =
\begin{bmatrix}
\psi_{11} &amp; \psi_{12}\\
\psi_{21} &amp; \psi_{22}\\
\end{bmatrix}\)</span></p>
</div>
</div>
</div>
<p>가정들:</p>
<ul>
<li>내생변수의 잔차는 외생변수와 독립: <span class="math inline">\(cov(\zeta_1, x_1) = 0\)</span>, <span class="math inline">\(cov(\zeta_2, x_1) = 0\)</span></li>
<li>내생변수의 잔차들은 서로 독립: <span class="math inline">\(cov(\zeta_1, \zeta_2) = 0\)</span> 즉, <span class="math inline">\(\psi_{12} = 0\)</span>
<ul>
<li>추정은 가능하나 non-recursive한 피드백 루프가 있는 모형이 됨.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Coveriance에 대한 성질">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Coveriance에 대한 성질
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(Cov(aX+bY,~ cU+dV) = ac~Cov(X, U) + ad~Cov(X, V) + bc~Cov(Y, U) + bd~Cov(Y, V)\)</span></p>
</div>
</div>
<p><span class="math inline">\(\begin{align}
  cov(y_1, y_2) &amp; = cov(\gamma_{11}x_1 + \zeta_1, \beta_{21}y_1 + \zeta_2) \\
                &amp; = \gamma_{11} \beta_{21} cov(x_1, y_1) + \gamma_{11} cov(x_1, \zeta_2) + \beta_{21} cov(y_1, \zeta_1) + cov(\zeta_1, \zeta_2) \\
                &amp; = \gamma_{11} \beta_{21} * \gamma_{11} \phi_{11} + \beta_{21} \psi_{11} \\
                &amp; = \beta_{21}( \gamma_{11}^2 \phi_{11} + \psi_{11})
\end{align}\)</span></p>
<ul>
<li><span class="math inline">\(cov(x_1, y_1) = cov(x_1, \gamma_{11}x_1 + \zeta_1) = \gamma_{11} cov(x_1, x_1) + cov(x_1, \zeta_1) = \gamma_{11} var(x_1) = \gamma_{11} \phi_{11}\)</span></li>
<li><span class="math inline">\(cov(y_1, \zeta_1) = cov(\gamma_{11}x_1 + \zeta_1, \zeta_1) = \gamma_{11} cov(x_1, \zeta_1) + cov(\zeta_1, \zeta_1) = var(\zeta_1) = \psi_{11}\)</span></li>
<li><span class="math inline">\(cov(\zeta_1, \zeta_2) = \psi_{12}\)</span></li>
</ul>
<p><span class="math display">\[\begin{equation}
\begin{bmatrix}
\text{VAR}(y_1) \\
\text{COV}(y_2, y_1) &amp; \text{VAR}(y_2) \\
\text{COV}(x_1, y_1) &amp; \text{COV}(x_1, y_2) &amp; \text{VAR}(x_1)
\end{bmatrix} =
\begin{bmatrix}
\gamma_{11}^2\phi_{11} + \psi_{11} \\
\beta_{21}(\gamma_{11}^2\phi_{11} + \psi_{11}) &amp; \beta_{21}^2(\gamma_{11}^2\phi_{11} + \psi_{11}) + \psi_{22} \\
\gamma_{11}\phi_{11} &amp; \beta_{21}\gamma_{11}\phi_{11} &amp; \phi_{11}
\end{bmatrix}
\end{equation}\]</span></p>
<p><br></p>
<section id="데이터로부터-최선의-파라미터를-추정" class="level3">
<h3 class="anchored" data-anchor-id="데이터로부터-최선의-파라미터를-추정">데이터로부터 최선의 파라미터를 추정</h3>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>기본적인 구조 모형의 가설(hypothesis)</strong>:</p>
<p><span class="math inline">\(\Sigma = \Sigma(\theta)\)</span></p>
<p>즉, 모집단의 공분산 = 모수(parameter)로 표현되는(implied) 공분산</p>
</div>
</div>
</div>
<ul>
<li>모집단의 공분산에 대한 추정치: 관찰된 공분산 행렬 <span class="math inline">\(\mathbf{S}\)</span></li>
<li>파라미터로 표현된 공분산 행렬의 추정치: <span class="math inline">\(\hat{\Sigma}(\theta)\)</span></li>
</ul>
<p>이제 이 둘의 차 <span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta)\)</span>를 최소화하는 파라미터들(통칭 <span class="math inline">\(\theta\)</span>)를 찾고자 함.</p>
<p>예를 들어,</p>
<div id="cell-8" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="73">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariance matrix</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">  225.2</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">  32.1 100.3</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">  111.4 26.5 105.2'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"y1"</span>, <span class="st">"y2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="74">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # regressopm</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">  y2 ~ 0*x1 + y1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">  y1 ~ x1</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # variacne</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # y2 ~~ y1  # assumed to be uncorrelated</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">sample.cov =</span> cov, <span class="at">sample.nobs =</span> <span class="dv">200</span>, <span class="at">fixed.x =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="75">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  lhs op rhs     est     se      z pvalue ci.lower ci.upper
1  y2  ~  x1   0.000  0.000     NA     NA    0.000    0.000
2  y2  ~  y1   0.264  0.070  3.776  0.000    0.127    0.401
3  y1  ~  x1   0.143  0.046  3.092  0.002    0.052    0.233
4  y2 ~~  y2  97.708  9.771 10.000  0.000   78.557  116.858
5  y1 ~~  y1  95.246  9.525 10.000  0.000   76.578  113.914
6  x1 ~~  x1 224.074 22.407 10.000  0.000  180.156  267.992</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="76">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a> sigma_hat <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="st">"cov.all"</span>)[<span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a> sigma_hat <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x1   y1    y2
x1 224.1 31.9   8.4
y1  31.9 99.8  26.4
y2   8.4 26.4 104.7</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="77">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 공분산 행렬 차이: residual covariance matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(cov <span class="sc">-</span> sigma_hat) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x1  y1    y2
x1   1.1 0.2 103.0
y1   0.2 0.5   0.1
y2 103.0 0.1   0.5</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>즉, <span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta) =
\begin{bmatrix}
1.1 \\
0.2 &amp; 0.5 \\
103.0 &amp; 0.1 &amp; 0.5
\end{bmatrix}\)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>이는 어떤 다른 파라미터 추정치에 대해서도 이 공분산 차이보다 더 작을 수 없다는 의미임.<br>
한편, 어떤 의미에서 차이가 작다는지를 정의해야 함.</p>
</blockquote>
</section>
<section id="estimation" class="level3">
<h3 class="anchored" data-anchor-id="estimation">Estimation</h3>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta)\)</span>가 작다는 것을 어떻게 정의할 것인가?<br>
혹은, 두 행렬 <span class="math inline">\(\mathbf{S}\)</span>, <span class="math inline">\(\hat{\Sigma}(\theta)\)</span> 사이의 거리를 어떻게 정의할 것인가?</p>
<blockquote class="blockquote">
<p>Fiting function(목적 함수)를 통해 그 함수가 최소가 되는 파라미터를 찾는 방식</p>
</blockquote>
</div>
</div>
</div>
<ul>
<li>Likelihood의 관점에서 추정: maximum likelihood estimation(MLE)
<ul>
<li><span class="math inline">\(F_{ML} = log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta)) - log|S| - (p + q)\)</span></li>
</ul></li>
<li>각 성분들의 제곱의 합이 최소가 되도록 추정: unweighted least squares(ULS)
<ul>
<li><span class="math inline">\(F_{ULS} = \frac{1}{2} tr[(\mathbf{S} - \hat{\Sigma}(\theta))^2]\)</span></li>
</ul></li>
<li>Generalized least squares(GLS)
<ul>
<li><span class="math inline">\(F_{GLS} = \frac{1}{2} tr\left[\left(I - \hat{\Sigma}(\theta)\mathbf{S}^{-1}\right)^2\right]\)</span></li>
</ul></li>
</ul>
<p><strong>Maximum Likelihood Estimation</strong></p>
<p>관측 변수들이 multivariate normal distribution을 따른다고 가정하면,</p>
<ul>
<li><p>Log-likelihood <span class="math inline">\(\displaystyle L(\theta) = \frac{-N(p + q)}{2}log(2\pi) - \frac{N}{2}\left(log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta))\right)\)</span></p></li>
<li><p><span class="math inline">\(F_{ML} = log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta)) - log|S| - (p + q)\)</span></p></li>
</ul>
<p>즉, likelihood를 최대화하는 것은 <span class="math inline">\(F_{ML}\)</span>를 최소화하는 것과 동일함.</p>
<p>Fitting function으로써 <span class="math inline">\(F_{ML}\)</span>의 장점은 asymptotic properties를 가지고 있음.</p>
<ul>
<li>Multivariate normal을 가정하고, N이 충분히 클 때,</li>
<li>주어진 모형이 참이라면, random sampling 변화에 따라 <span class="math inline">\((N-1)*F_{ML}\)</span>은 <span class="math inline">\(\chi^2\)</span> 분포 따름</li>
</ul>
</section>
<section id="model-indentification" class="level3">
<h3 class="anchored" data-anchor-id="model-indentification">Model Indentification</h3>
<p>위의 예에서,</p>
<ul>
<li>파라미터를 추정하기 위해 주어진 정보의 갯수: 3+2+1=6개
<ul>
<li>관찰 변수가 <span class="math inline">\(p\)</span>개 일 때, <span class="math inline">\(p(p+1)/2\)</span></li>
</ul></li>
<li>추정하고자 하는 파라미터의 개수: 5개</li>
</ul>
<p>즉, 식은 6개이며 미지수는 5개이므로 추정가능함!<br>
이 때, <strong>자유도(degree of freedom) df</strong> = 6 - 5 = 1</p>
<ul>
<li>over-identified (과대 식별): df &gt; 0, 그 차이(자유도)가 클수록 유리함!</li>
<li>just-identified (적정 식별): df = 0, 포화 모형 (saturated model)</li>
<li>under-identified model (과소 식별): df &lt; 0, 파라미터 추정 불가능</li>
</ul>
<div id="cell-17" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="79">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">estimate =</span> F) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-18 ended normally after 10 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                               139.381
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.000</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="82">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># info for parameters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">parTable</span>(fit) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id lhs op rhs user block group free ustart exo label plabel   start     est
1  1  y2  ~  x1    1     1     1    0      0   0         .p1.   0.000   0.000
2  2  y2  ~  y1    1     1     1    1     NA   0         .p2.   0.111   0.264
3  3  y1  ~  x1    1     1     1    2     NA   0         .p3.   0.143   0.143
4  4  y2 ~~  y2    0     1     1    3     NA   0         .p4.  48.671  97.708
5  5  y1 ~~  y1    0     1     1    4     NA   0         .p5.  95.246  95.246
6  6  x1 ~~  x1    0     1     1    5     NA   0         .p6. 224.074 224.074
      se
1  0.000
2  0.070
3  0.046
4  9.771
5  9.525
6 22.407</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation" class="level1">
<h1>Model Evaluation</h1>
<p>모형에 대한 평가는 1) 변수들 간의 관계성 2) 그 관계의 크기 모두에 대해 이루어져야 함.<br>
이를 위해 전체적인 평가(overal fit measures)와 부분적인 평가(local/component fit measures)로 나누어 살펴봄.</p>
<section id="overall-fit-measures" class="level2">
<h2 class="anchored" data-anchor-id="overall-fit-measures">Overall Fit Measures</h2>
<p>두 행렬 <span class="math inline">\(\mathbf{S}\)</span>와 <span class="math inline">\(\hat{\Sigma}(\theta)\)</span>간의 거리를 측정하여 모형이 전체적으로 얼마나 적합한지를 평가함.<br>
부분적인(local) 적합도를 살펴보는 것으로는 드러나지 못하는 “전체적 부적절함”을 판별할 수는 지표를 얻을 수 있음.</p>
<ul>
<li>반대로, 전체적으로 적합하다고 해서 부분적으로 적합하다는 보장은 없음.</li>
<li>따라서, 여러 측면에서 동시에 평가하는 것이 중요함!</li>
</ul>
<section id="residuals" class="level3">
<h3 class="anchored" data-anchor-id="residuals"><strong>Residuals</strong></h3>
<p>Ideally, all residuals should be near zero for a “good” model. But the sample residuals are affected by several factors: (1) the departure of <span class="math inline">\(\Sigma\)</span> from <span class="math inline">\(\Sigma(\theta)\)</span>, (2) the scales of the observed variables, and (3) sampling fluctuations</p>
<ul>
<li>Coveriance residuals: 두 공분산의 차이 <span class="math inline">\(\mathbf{S} - \hat{\Sigma}(\theta)\)</span>를 직접 확인</li>
<li>Correlation residuals: 각 공분산을 표준화하여 (변수들의 단위와 독립적인) 상관계수로 변환 후 비교
<ul>
<li><span class="math inline">\(\displaystyle r_{ij} = \frac{\sigma_{ij}}{\sqrt{\sigma_{ii}\sigma_{jj}}}\)</span>, <span class="math inline">\(\sigma_{ij}\)</span>: 해당 공분산</li>
<li>그 값이 0.1 이상이면 주의</li>
</ul></li>
<li>Standardized residuals: 표준오차로 나눈 잔차들을 비교
<ul>
<li>divided by the square root of the asymptotic variance of these residuals (by lavaan)</li>
<li>표본의 크기를 고려해 분산을 조정한 값</li>
<li>N이 충분히 크다면, z-score로 이해할 수 있음</li>
<li>2.0 이상이면 유의(significant)하다고 보고 주의; 단, 표본크기에 대한 가설검증의 취약성을 그대로 지님.</li>
</ul></li>
</ul>
<p><strong><em>표본의 크기가 커질수록, 공분산/상관 잔차의 값이 줄어드는 경향이 있음.</em></strong></p>
<p>예제: Reisenzein(1986)의 실험</p>
<div class="callout callout-style-simple callout-note callout-titled" title="연구 내용">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
연구 내용
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>지하철에서 한 사람이 쓰러지는 가상의 시나리오에서 동정심과 분노가 도움 행동을 매개하는지를 조사</li>
<li>절반의 참가자에게는 그 사람이 술에 취했다는 정보 제공, 나머지 절반에게는 병에 걸렸다는 정보 제공</li>
<li>동정심과 분노는 각각 세 가지 지표로 측정됨</li>
</ul>
<p>동정심<br>
x1: 그 사람에 대해 얼마나 동정심(sympathy)을 느끼십니까?<br>
x2: 나는 이 사람에게 연민(pity)을 느낍니다.<br>
x3: 이 사람에 대해 얼마나 걱정(concern)이 되십니까?</p>
<p>분노<br>
x4: 그 사람에게 얼마나 화가 나시나요?<br>
x5: 그 사람에게 얼마나 짜증을 느끼시겠습니까?<br>
x6: 그 사람 때문에 기분이 나빠질 것입니다.</p>
</div>
</div>
</div>
<p><img src="images/bollen-fig7-4.png" class="img-fluid" width="550"></p>
<div style="line-height: 1.5em; font-size: .9em">
<p>Figure 7.4 Confirmatory Factor Analysis Model for Sympathy (<span class="math inline">\(\xi_1\)</span>) and Anger (<span class="math inline">\(\xi_2\)</span>). Each Measured with Three Indicators (<span class="math inline">\(X_1\)</span> to <span class="math inline">\(X_6\)</span>)</p>
<p>Source: p.&nbsp;260, Bollen, K. A. (1989). Structural equations with latent variables</p>
</div>
<div id="cell-21" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="161">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fig 7.4</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">  6.982</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">  4.686 6.047</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">  4.335 3.307 5.037 </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">  -2.294 -1.453 -1.979 5.569</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">  -2.209 -1.262 -1.738 3.931 5.328</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">  -1.671 -1.401 -1.564 3.915 3.601 4.977</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>, <span class="st">"x6"</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>model_sa <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">  sympathy =~ x1 + x2 + x3</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">  anger =~ x4 + x5 + x6</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>fit_sa <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_sa, <span class="at">sample.cov =</span> cov, <span class="at">sample.nobs =</span> <span class="dv">138</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="162">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coveriance residuals</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "raw"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  0.028  0.000                            
x3 -0.016 -0.027  0.000                     
x4 -0.073  0.247 -0.387  0.000              
x5 -0.170  0.297 -0.277 -0.030  0.000       
x6  0.334  0.136 -0.126  0.013  0.020  0.000
</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation residuals</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa, <span class="at">type =</span> <span class="st">"cor"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  0.004  0.000                            
x3 -0.003 -0.005  0.000                     
x4 -0.012  0.043 -0.074  0.000              
x5 -0.028  0.053 -0.054 -0.006  0.000       
x6  0.057  0.025 -0.025  0.002  0.004  0.000
</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardized residuals</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa, <span class="at">type =</span> <span class="st">"standardized"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "standardized"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  1.353  0.000                            
x3 -1.035 -0.379  0.000                     
x4 -0.392  0.871 -1.503  0.000              
x5 -0.723  0.967 -1.006 -1.203  0.000       
x6  1.585  0.483 -0.493  0.568  0.566  0.000
</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized residuals</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit_sa, <span class="at">type =</span> <span class="st">"normalized"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       x1     x2     x3     x4     x5     x6
x1  0.000                                   
x2  0.042  0.000                            
x3 -0.026 -0.049  0.000                     
x4 -0.130  0.488 -0.809  0.000              
x5 -0.311  0.604 -0.601 -0.053  0.000       
x6  0.644  0.284 -0.285  0.023  0.038  0.000
</code></pre>
</div>
</div>
</section>
<section id="chi-square-chi2-test" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-chi2-test"><strong>Chi-Square( <span class="math inline">\(\chi^2\)</span>) Test</strong></h3>
<p>공분산의 잔차들이 모집단에서 0과 다른지에 대한 통계적 검증하고자 함.</p>
<ul>
<li>위에서 standardize한 residuals를 이용하는 것은 대략적인 테스트임.</li>
<li>소위, simultaneous significance test, 즉 모든 공분산이 0인지를 동시에 검증하는 것이 필요함.</li>
</ul>
<!-- It would be helpful to have a test of whether the residuals depart from the population values of zero. The normalized residuals provide a very rough test of statistical significance, but without prior specification of the individual element that is tested and with the tendency of these residuals to be too small, the probability levels associated with the test are not accurate.

It would be extremely helpful to have a simultaneous significance test of the hypothesis that all population residuals in $[\Sigma - \Sigma(\theta)]$ are zero. The test should take into account N and df and should be based on the sample residuals. The next section presents such a significance test. -->
<p>Chi-Square( <span class="math inline">\(\chi^2\)</span>) Test</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\Sigma\)</span> = <span class="math inline">\(\Sigma(\theta)\)</span> ; 공분산 행렬과 모수로 표현된 공분산 행렬이 같다. 즉, 연구자의 모형은 데이터와 완전히 일치함!</li>
<li><span class="math inline">\(H_0\)</span> 가정하에, sampling error로부터 <span class="math inline">\((N-1)*F_{ML}\)</span> 값들은 점근적으로 <span class="math inline">\(\chi^2(df_M)\)</span> 분포 따름</li>
<li>이는 포화모형(완전한 모형)에 비해 연구자의 “제한이 가해진 모형” 간의 (likelihood) 차이가 특정 분포를 따른다는 것을 의미함.
<ul>
<li>Log-likelihood ratio: <span class="math inline">\(\displaystyle -2log\left(\frac{L_0}{L_1}\right) = (N-1)F_{ML} \sim \chi^2(df_M)\)</span>
<ul>
<li><span class="math inline">\(L_0\)</span>: the likelihood maximized for the researcher’s model under <span class="math inline">\(H_0\)</span></li>
<li><span class="math inline">\(L_1\)</span>: the same quantity for an unrestricted model</li>
</ul></li>
<li><span class="math inline">\(df_M\)</span>: the difference in the number of parameters between the two models</li>
</ul></li>
</ul>
<p>위의 CFA의 예에서,</p>
<p><span class="math inline">\(\begin{align}
  \chi^2_{ML} = (N)*F_{ML}(S, \hat{\Sigma}(\theta)) &amp; = N*\left(log|\Sigma(\theta)| + tr(\Sigma^{-1}(\theta)S) - log|S| - (p + q)\right) \\
  &amp; = 138 * 0.0698 = 9.632 \\
\end{align}\)</span></p>
<p>이 값은 다음과 같이 해석할 수 있음.</p>
<p><span class="math inline">\(\begin{align}
  -2log\left(\frac{L_0}{L_1}\right) &amp; = -2(logL_0 - logL_1) \\
  &amp; = -2*[-1654.635 - (-1649.817)] = 9.635 \\
\end{align}\)</span></p>
<p>Degree of freedom = <span class="math inline">\(\displaystyle\frac{6*7}{2} - 13 = 21 - 13 = 8\)</span></p>
<div id="cell-28" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="146">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="equations_files/figure-html/cell-19-output-1.png" width="640" height="400" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-31" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="160">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="equations_files/figure-html/cell-22-output-1.png" width="620" height="400" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\chi^2\)</span> 분포로부터 <span class="math inline">\(p = 0.292\)</span>, Bootstrap 샘플 중 29.8%</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\Sigma\)</span> = <span class="math inline">\(\Sigma(\theta)\)</span>이 참이라면, 상정한 모형의 <span class="math inline">\(\chi^2\)</span> 값 9.6보다 더 큰 <span class="math inline">\(\chi^2\)</span>값이 나올 확률이 대략 30%임.</li>
<li>이는 완전한 모형(포화모형)과 (likelihood 관점에서) 크게 다르지 않다는 것을 의미함.</li>
<li>기존의 관행처럼 <span class="math inline">\(p\)</span> &lt; 0.05 일 때, 모형이 완전한 적합도을 보이지 못한다고 판단할 수 있음.</li>
<li>즉, 공분산의 잔차 중 일부가 모집단에서 0이 아닐 수 있음을 의미함.</li>
</ul>
<div id="cell-33" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="163">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting function의 최소값</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(fit_sa, <span class="st">"fmin"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">nd =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fmin 
0.0349 </code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="164">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정한 모형의 log-likelihood &amp; unrestricted 모형의 log-likelihood, chi-square 값</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_sa, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"logl"</span>, <span class="st">"unrestricted.logl"</span>)) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            chisq            pvalue              logl unrestricted.logl 
            9.635             0.292         -1654.635         -1649.817 </code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="165">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_sa, <span class="at">fit.measures =</span> T, <span class="at">estimates =</span> F) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                           138

Model Test User Model:
                                                      
  Test statistic                                 9.635
  Degrees of freedom                                 8
  P-value (Chi-square)                           0.292

Model Test Baseline Model:

  Test statistic                               473.058
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.996
  Tucker-Lewis Index (TLI)                       0.993

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1654.635
  Loglikelihood unrestricted model (H1)      -1649.817
                                                      
  Akaike (AIC)                                3335.269
  Bayesian (BIC)                              3373.324
  Sample-size adjusted Bayesian (SABIC)       3332.196

Root Mean Square Error of Approximation:

  RMSEA                                          0.038
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.111
  P-value H_0: RMSEA &lt;= 0.050                    0.526
  P-value H_0: RMSEA &gt;= 0.080                    0.217

Standardized Root Mean Square Residual:

  SRMR                                           0.030</code></pre>
</div>
</div>
<!-- > 이러한 맥락에서 일반적으로 자유도가 많은 모델을 다루는 것을 선호한다는 점에 유의하는 것도 중요합니다. 자유도 개념의 직관적인 의미는 모델을 부정(disconfirm)할 수 있는 차원이기 때문입니다. 따라서 모델의 자유도가 많을수록 모델을 거부할 수 있는 차원이 많아지고, 따라서 데이터에 대해 테스트할 때 모델을 부정할 수 있는 가능성이 높아집니다. 포퍼의 논리에 따르면 경험적 과학은 모델을 확증할 수 없고 부인할 수만 있기 때문에 이는 테스트 프로세스의 바람직한 특징입니다. 따라서 연구된 현상을 그럴듯하게 설명하는 두 가지 모델이 있는 경우, 자유도가 더 높은 모델이 데이터 설명 및 설명 수단으로 더 강력한 후보로 고려될 수 있습니다. 그 이유는 더 많은 자유도를 가진 모델이 거부될 가능성이 더 높기 때문이며, 거부되지 않았다면 그 모델을 통해 얻은 결과를 더 신뢰할 수 있는 것으로 볼 수 있기 때문입니다. 이러한 추론은 본질적으로 SEM 문헌에서 널리 논의되는 파시모니(parsimony) 원칙의 개념적 기초입니다(예: Raykov & Marcoulides, 1999 및 이에 대한 참고 문헌). 따라서 경험적 과학의 목표는 반증가능한(falsifiable) 이론을 수립하는 것이라고 주장하는 포퍼의 논리는 파시모니(parsimony) 원칙의 적용을 통해 촉진됩니다. 더 간결한(parsimonious) 모델이 수용 가능한 것으로 밝혀지면, 덜 간결한 모델보다 거부될 가능성이 더 높기 때문에 더 많은 신뢰를 가질 수 있습니다. 그러나 연구자들은 파시모니(parsimony) 원칙을 기계적이고 융통성 없이 적용하면 잘못된 모델에 유리한 결론을 내리고, 올바른 모델과 양립할 수 없는 함의를 도출할 수 있다는 점에 주의를 기울여야 합니다. (번역 by DeepL)

::: {style="line-height: 1.5em; font-size: .9em"}
Source: p. 42, Raykov, T., & Marcoulides, G. A. (2006). A first course in structural equation modeling (2e)
::: -->


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sem\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/ml.html" class="pagination-link" aria-label="ML Estimation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">ML Estimation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>