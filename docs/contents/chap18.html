<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-11-18">

<title>Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions –  CHA Statistics II in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/chap19.html" rel="next">
<link href="../contents/chap17.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions –  CHA Statistics II in R">
<meta property="og:description" content="Multiple Regression and Beyond (3e) by Timothy Z. Keith">
<meta property="og:site_name" content="CHA Statistics II in R">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics II in R</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages for SEM</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Keith’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Variable SEM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap18.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multigroup Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagnostics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEM Equations</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Kline’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/Kline/composite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reflective</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: Formative</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: PLS-PM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: HO</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#initial-model" id="toc-initial-model" class="nav-link active" data-scroll-target="#initial-model">Initial Model</a>
  <ul>
  <li><a href="#가족배경이-성적에-미치는-효과" id="toc-가족배경이-성적에-미치는-효과" class="nav-link" data-scroll-target="#가족배경이-성적에-미치는-효과">가족배경이 성적에 미치는 효과</a></li>
  <li><a href="#소수인종이-성적에-미치는-영향" id="toc-소수인종이-성적에-미치는-영향" class="nav-link" data-scroll-target="#소수인종이-성적에-미치는-영향">소수인종이 성적에 미치는 영향</a></li>
  <li><a href="#using-csem" id="toc-using-csem" class="nav-link" data-scroll-target="#using-csem">Using cSEM</a></li>
  </ul></li>
  <li><a href="#competing-models" id="toc-competing-models" class="nav-link" data-scroll-target="#competing-models">Competing models</a></li>
  <li><a href="#panel-models" id="toc-panel-models" class="nav-link" data-scroll-target="#panel-models">Panel Models</a></li>
  <li><a href="#multigroup-models" id="toc-multigroup-models" class="nav-link" data-scroll-target="#multigroup-models">Multigroup Models</a>
  <ul>
  <li><a href="#measurement-constraints" id="toc-measurement-constraints" class="nav-link" data-scroll-target="#measurement-constraints">Measurement Constraints</a></li>
  <li><a href="#effect-of-homework-across-groups" id="toc-effect-of-homework-across-groups" class="nav-link" data-scroll-target="#effect-of-homework-across-groups">Effect of Homework Across Groups</a></li>
  <li><a href="#all-effects-across-groups" id="toc-all-effects-across-groups" class="nav-link" data-scroll-target="#all-effects-across-groups">All Effects Across Groups</a></li>
  <li><a href="#all-effects-and-errors-across-groups" id="toc-all-effects-and-errors-across-groups" class="nav-link" data-scroll-target="#all-effects-and-errors-across-groups">All Effects and Errors Across Groups</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions</h1>
<p class="subtitle lead">Multiple Regression and Beyond (3e) by Timothy Z. Keith</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 18, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="298">
<details class="code-fold">
<summary>Load libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manymome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>A Latent Variable Homework Model</strong><br>
Single indicators와 correlated errors를 가지는 모형을 구성</p>
<section id="initial-model" class="level2">
<h2 class="anchored" data-anchor-id="initial-model">Initial Model</h2>
<p><img src="images/fig18-1.png" class="img-fluid" width="700"></p>
<div id="cell-4" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="300">
<details class="code-fold">
<summary>Load the dataset</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/chap 18 latent var SEM 2/HW latent matrix.sav"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>hwcov <span class="ot">&lt;-</span> hw[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> hw<span class="sc">$</span>varname_[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">sds =</span> hw[<span class="dv">16</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">16</span>]  <span class="sc">|&gt;</span> <span class="fu">as.double</span>())</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a dataset with the same covariance matrix</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>hw_sim <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(hwcov, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"exact"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># replace Minority values to 1 if it &gt; 0.3, otherwise 0</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>hw_sim <span class="ot">&lt;-</span> hw_sim <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Minority =</span> <span class="fu">ifelse</span>(Minority <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-5" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="301">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hw_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # measurement model</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">  EthnicMinor =~ Minority</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  HW =~ hw10 + hw_8</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">  # residual covariacne/variance</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Minority ~~ 0.0099*Minority</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">  # structural model</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch ~ b1*Famback + b2*EthnicMinor</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades ~ b3*PrevAch + b4*HW</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">  HW ~ b5*PrevAch + b6*Famback + b7*EthnicMinor</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effects; famback &gt; homework &gt; grades</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">  ind_fam := b4*b6</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effects; ethnicminor &gt; homework &gt; grades</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">  ind_ethinic := b4*b7</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>hw_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model, <span class="at">sample.cov =</span> hwcov, <span class="at">sample.nobs =</span> <span class="dv">1000</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 277 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        39

  Number of observations                          1000

Model Test User Model:
                                                      
  Test statistic                               204.654
  Degrees of freedom                                66
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              8392.044
  Degrees of freedom                                91
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.983
  Tucker-Lewis Index (TLI)                       0.977

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -33331.251
  Loglikelihood unrestricted model (H1)     -33228.924
                                                      
  Akaike (AIC)                               66740.502
  Bayesian (BIC)                             66931.905
  Sample-size adjusted Bayesian (SABIC)      66808.039

Root Mean Square Error of Approximation:

  RMSEA                                          0.046
  90 Percent confidence interval - lower         0.039
  90 Percent confidence interval - upper         0.053
  P-value H_0: RMSEA &lt;= 0.050                    0.825
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.029

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  EthnicMinor =~                                                        
    Minority          1.000                               0.434    0.975
  Famback =~                                                            
    parocc            1.000                              16.760    0.776
    bypared           0.062    0.003   21.618    0.000    1.032    0.805
    byfaminc          0.100    0.005   19.224    0.000    1.683    0.667
  PrevAch =~                                                            
    bytxrstd          1.000                               8.806    0.855
    bytxmstd          0.997    0.030   33.754    0.000    8.782    0.844
    bytxsstd          0.990    0.030   33.537    0.000    8.718    0.846
    bytxhstd          0.967    0.029   32.925    0.000    8.513    0.837
  HW =~                                                                 
    hw10              1.000                               1.126    0.592
    hw_8              0.453    0.060    7.553    0.000    0.510    0.451
  Grades =~                                                             
    eng_12            1.000                               2.471    0.924
    math_12           0.896    0.024   37.832    0.000    2.213    0.820
    sci_12            0.957    0.022   43.705    0.000    2.364    0.878
    ss_12             1.062    0.022   48.218    0.000    2.625    0.914

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  PrevAch ~                                                             
    Famback   (b1)    0.278    0.020   13.656    0.000    0.529    0.529
    EthnicMnr (b2)   -1.774    0.645   -2.749    0.006   -0.087   -0.087
  Grades ~                                                              
    PrevAch   (b3)    0.145    0.012   12.580    0.000    0.518    0.518
    HW        (b4)    0.601    0.132    4.569    0.000    0.274    0.274
  HW ~                                                                  
    PrevAch   (b5)    0.053    0.008    6.643    0.000    0.413    0.413
    Famback   (b6)    0.013    0.004    3.122    0.002    0.198    0.198
    EthnicMnr (b7)    0.281    0.123    2.293    0.022    0.108    0.108

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.704    0.248    2.844    0.004    0.704    0.128
 .bytxmstd ~~                                                           
   .math_12           2.856    0.342    8.350    0.000    2.856    0.331
 .bytxsstd ~~                                                           
   .sci_12            0.920    0.285    3.227    0.001    0.920    0.130
 .bytxhstd ~~                                                           
   .ss_12             0.533    0.277    1.927    0.054    0.533    0.082
  EthnicMinor ~~                                                        
    Famback          -2.136    0.277   -7.709    0.000   -0.294   -0.294

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Minority          0.010                               0.010    0.050
   .parocc          185.127   13.017   14.222    0.000  185.127    0.397
   .bypared           0.580    0.046   12.697    0.000    0.580    0.353
   .byfaminc          3.528    0.193   18.276    0.000    3.528    0.555
   .bytxrstd         28.555    1.718   16.625    0.000   28.555    0.269
   .bytxmstd         31.233    1.821   17.153    0.000   31.233    0.288
   .bytxsstd         30.165    1.767   17.067    0.000   30.165    0.284
   .bytxhstd         30.864    1.774   17.399    0.000   30.864    0.299
   .hw10              2.352    0.202   11.639    0.000    2.352    0.650
   .hw_8              1.018    0.058   17.562    0.000    1.018    0.797
   .eng_12            1.052    0.074   14.115    0.000    1.052    0.147
   .math_12           2.378    0.122   19.545    0.000    2.378    0.327
   .sci_12            1.653    0.094   17.625    0.000    1.653    0.228
   .ss_12             1.364    0.090   15.133    0.000    1.364    0.165
    EthnicMinor       0.188    0.009   21.242    0.000    1.000    1.000
    Famback         280.913   21.604   13.003    0.000    1.000    1.000
   .PrevAch          53.163    3.514   15.130    0.000    0.686    0.686
   .HW                0.915    0.182    5.020    0.000    0.722    0.722
   .Grades            3.150    0.202   15.604    0.000    0.516    0.516

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    ind_fam           0.008    0.003    2.727    0.006    0.054    0.054
    ind_ethinic       0.169    0.079    2.138    0.032    0.030    0.030
</code></pre>
</div>
</div>
<p><strong>비표준화 결과</strong></p>
<p>어떤 단위로 측정되었는가?<br>
Grades: 0 (an F average) to 12 (A+)<br>
Homework:<br>
<img src="images/hw-scale.png" class="img-fluid" width="300"></p>
<p><img src="images/fig18-6.png" class="img-fluid" width="700"></p>
<section id="가족배경이-성적에-미치는-효과" class="level3">
<h3 class="anchored" data-anchor-id="가족배경이-성적에-미치는-효과">가족배경이 성적에 미치는 효과</h3>
<p>소수인종 변수를 통제한 상태에서</p>
<p>All (direct/indirect) paths from family background to grades: total effect</p>
<div id="cell-8" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="302">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the simulated data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>hw_fit_sim <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model, <span class="at">data =</span> hw_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="303">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manymome)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># All indirect paths from family background to grades: total effect</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>paths <span class="ot">&lt;-</span> <span class="fu">all_indirect_paths</span>(hw_fit_sim, <span class="at">x =</span> <span class="st">"Famback"</span>, <span class="at">y =</span> <span class="st">"Grades"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>paths <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
all_indirect_paths(fit = hw_fit_sim, x = "Famback", y = "Grades")
Path(s): 
  path                              
1 Famback -&gt; PrevAch -&gt; HW -&gt; Grades
2 Famback -&gt; PrevAch -&gt; Grades      
3 Famback -&gt; HW -&gt; Grades           </code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="304">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ind_est_std <span class="ot">&lt;-</span> <span class="fu">many_indirect_effects</span>(paths,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> hw_fit_sim, <span class="at">R =</span> <span class="dv">1000</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_ci =</span> <span class="cn">TRUE</span>, <span class="at">boot_type =</span> <span class="st">"bc"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_y =</span> <span class="cn">TRUE</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>ind_est_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=12s  </code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>
==  Indirect Effect(s) (Both x-variable(s) and y-variable(s) Standardized)  ==
                                     std CI.lo CI.hi Sig
Famback -&gt; PrevAch -&gt; HW -&gt; Grades 0.059 0.034 0.108 Sig
Famback -&gt; PrevAch -&gt; Grades       0.284 0.229 0.336 Sig
Famback -&gt; HW -&gt; Grades            0.050 0.013 0.098 Sig

 - [CI.lo to CI.hi] are 95.0% bias-corrected confidence intervals by
   nonparametric bootstrapping with 1000 samples.
 - std: The standardized indirect effects.
 </code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="305">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total effect (all indirects + directs) from family background to grades</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ind_est_std[[<span class="dv">1</span>]] <span class="sc">+</span> ind_est_std[[<span class="dv">2</span>]] <span class="sc">+</span> ind_est_std[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
== Indirect Effect (Both ‘Famback’ and ‘Grades’ Standardized) ==
                                                        
 Path:                Famback -&gt; PrevAch -&gt; HW -&gt; Grades
 Path:                Famback -&gt; PrevAch -&gt; Grades      
 Path:                Famback -&gt; HW -&gt; Grades           
 Function of Effects: 0.392                             
 95.0% Bootstrap CI:  [0.342 to 0.442]                  

Computation of the Function of Effects:
 ((Famback-&gt;PrevAch-&gt;HW-&gt;Grades)
+(Famback-&gt;PrevAch-&gt;Grades))
+(Famback-&gt;HW-&gt;Grades) 


Bias-corrected confidence interval formed by nonparametric bootstrapping with
1000 bootstrap samples.</code></pre>
</div>
</div>
<p>특정 간접효과를 테스트하려면,</p>
<div id="cell-13" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="306">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">indirect_effect</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> hw_fit_sim,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Famback"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Grades"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="fu">c</span>(<span class="st">"HW"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_out =</span> out_med,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_y =</span> <span class="cn">TRUE</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ==  Indirect Effect(s) (Both x-variable(s) and y-variable(s) Standardized)  ==</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   std CI.lo CI.hi Sig</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># famback -&gt; prevach -&gt; hw -&gt; grades 0.060 0.034 0.105 Sig</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># famback -&gt; prevach -&gt; grades       0.274 0.222 0.325 Sig</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># famback -&gt; hw -&gt; grades            0.054 0.018 0.102 Sig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
== Indirect Effect (Both ‘Famback’ and ‘Grades’ Standardized) ==
                                         
 Path:            Famback -&gt; HW -&gt; Grades
 Indirect Effect: 0.050                  

Computation Formula:
  (b.HW~Famback)*(b.Grades~HW)*sd_Famback/sd_Grades

Computation:
  (0.01251)*(0.58685)*(16.70928)/(2.47203)

Coefficients of Component Paths:
       Path Coefficient
 HW~Famback      0.0125
  Grades~HW      0.5868

NOTE:
- The effects of the component paths are from the model, not standardized.</code></pre>
</div>
</div>
</section>
<section id="소수인종이-성적에-미치는-영향" class="level3">
<h3 class="anchored" data-anchor-id="소수인종이-성적에-미치는-영향">소수인종이 성적에 미치는 영향</h3>
<p>가족배경 변수를 통제한 상태에서</p>
<p>All (direct/indirect) paths from minority to grades: total effect<br>
소수인종 변수가 카테고리 변수(더미)이므로 해석에 유의</p>
<div id="cell-15" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="307">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All indirect paths from minority to grades: total effect</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>paths2 <span class="ot">&lt;-</span> <span class="fu">all_indirect_paths</span>(hw_fit_sim,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"EthnicMinor"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Grades"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>paths2 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
all_indirect_paths(fit = hw_fit_sim, x = "EthnicMinor", y = "Grades")
Path(s): 
  path                                  
1 EthnicMinor -&gt; PrevAch -&gt; HW -&gt; Grades
2 EthnicMinor -&gt; PrevAch -&gt; Grades      
3 EthnicMinor -&gt; HW -&gt; Grades           </code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="308">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ind_est_std2 <span class="ot">&lt;-</span> <span class="fu">many_indirect_effects</span>(paths2,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> hw_fit_sim, <span class="at">R =</span> <span class="dv">1000</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_ci =</span> <span class="cn">TRUE</span>, <span class="at">boot_type =</span> <span class="st">"bc"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_x =</span> <span class="cn">FALSE</span>,  <span class="co"># categorical variable</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_y =</span> <span class="cn">TRUE</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ind_est_std2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=14s  </code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>
==  Indirect Effect(s) (y-variable(s) Standardized)  ==
                                          ind  CI.lo CI.hi Sig
EthnicMinor -&gt; PrevAch -&gt; HW -&gt; Grades -0.013 -0.040 0.001    
EthnicMinor -&gt; PrevAch -&gt; Grades       -0.061 -0.144 0.013    
EthnicMinor -&gt; HW -&gt; Grades             0.036 -0.017 0.110    

 - [CI.lo to CI.hi] are 95.0% bias-corrected confidence intervals by
   nonparametric bootstrapping with 1000 samples.
 - std: The partially standardized indirect effects. 
 - y-variable(s) standardized.
 </code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="309">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total effect (all indirects + directs) from minority to grades</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ind_est_std2[[<span class="dv">1</span>]] <span class="sc">+</span> ind_est_std2[[<span class="dv">2</span>]] <span class="sc">+</span> ind_est_std2[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
== Indirect Effect (‘Grades’ Standardized) ==
                                                            
 Path:                EthnicMinor -&gt; PrevAch -&gt; HW -&gt; Grades
 Path:                EthnicMinor -&gt; PrevAch -&gt; Grades      
 Path:                EthnicMinor -&gt; HW -&gt; Grades           
 Function of Effects: -0.037                                
 95.0% Bootstrap CI:  [-0.146 to 0.073]                     

Computation of the Function of Effects:
 ((EthnicMinor-&gt;PrevAch-&gt;HW-&gt;Grades)
+(EthnicMinor-&gt;PrevAch-&gt;Grades))
+(EthnicMinor-&gt;HW-&gt;Grades) 


Bias-corrected confidence interval formed by nonparametric bootstrapping with
1000 bootstrap samples.</code></pre>
</div>
</div>
</section>
<section id="using-csem" class="level3">
<h3 class="anchored" data-anchor-id="using-csem">Using cSEM</h3>
<div id="cell-19" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="81">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>hw_model_c <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="st">  EthnicMinor &lt;~ Minority</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Famback =~ bypared + byfaminc + parocc</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">  HW =~ hw_8 + hw10</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch ~ Famback + EthnicMinor</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades ~ PrevAch + HW</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">  HW ~ PrevAch + Famback + EthnicMinor</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>hw_raw_imp <span class="ot">&lt;-</span> VIM<span class="sc">::</span><span class="fu">kNN</span>(hw_raw, <span class="at">k =</span> <span class="dv">10</span>) <span class="co"># kNN imputation</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>csem_fit <span class="ot">&lt;-</span> cSEM<span class="sc">::</span><span class="fu">csem</span>(<span class="at">.data =</span> hw_raw_imp, <span class="at">.model =</span> hw_model_c, <span class="at">.resample_method =</span> <span class="st">"bootstrap"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>cSEM<span class="sc">::</span><span class="fu">summarize</span>(csem_fit) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>________________________________________________________________________________
----------------------------------- Overview -----------------------------------

    General information:
    ------------------------
    Estimation status                  = Ok
    Number of observations             = 1000
    Weight estimator                   = PLS-PM
    Inner weighting scheme             = "path"
    Type of indicator correlation      = Pearson
    Path model estimator               = OLS
    Second-order approach              = NA
    Type of path model                 = Linear
    Disattenuated                      = Yes (PLSc)

    Resample information:
    ---------------------
    Resample method                    = "bootstrap"
    Number of resamples                = 499
    Number of admissible results       = 499
    Approach to handle inadmissibles   = "drop"
    Sign change option                 = "none"
    Random seed                        = -2108795247

    Construct details:
    ------------------
    Name         Modeled as     Order         Mode      

    Famback      Common factor  First order   "modeA"   
    EthnicMinor  Composite      First order   "modeB"   
    PrevAch      Common factor  First order   "modeA"   
    HW           Common factor  First order   "modeA"   
    Grades       Common factor  First order   "modeA"   

----------------------------------- Estimates ----------------------------------

Estimated path coefficients:
============================
                                                                       CI_percentile   
  Path                     Estimate  Std. error   t-stat.   p-value         95%        
  PrevAch ~ Famback          0.5106      0.0329   15.5174    0.0000 [ 0.4430; 0.5748 ] 
  PrevAch ~ EthnicMinor      0.1479      0.0298    4.9656    0.0000 [ 0.0882; 0.2120 ] 
  HW ~ Famback               0.2906      0.0611    4.7567    0.0000 [ 0.1712; 0.4087 ] 
  HW ~ EthnicMinor          -0.0768      0.0416   -1.8460    0.0649 [-0.1578; 0.0048 ] 
  HW ~ PrevAch               0.3990      0.0526    7.5870    0.0000 [ 0.2923; 0.5058 ] 
  Grades ~ PrevAch           0.9138      0.0183   50.0302    0.0000 [ 0.8726; 0.9471 ] 
  Grades ~ HW                0.0520      0.0273    1.9072    0.0565 [-0.0013; 0.1070 ] 

Estimated loadings:
===================
                                                                         CI_percentile   
  Loading                    Estimate  Std. error   t-stat.   p-value         95%        
  Famback =~ bypared           0.8671      0.0283   30.6345    0.0000 [ 0.8147; 0.9216 ] 
  Famback =~ byfaminc          0.7187      0.0292   24.5833    0.0000 [ 0.6549; 0.7723 ] 
  Famback =~ parocc            0.6377      0.0297   21.4724    0.0000 [ 0.5812; 0.6921 ] 
  EthnicMinor =~ Minority      1.0000          NA        NA        NA [     NA;     NA ] 
  PrevAch =~ bytxrstd          0.8544      0.0126   67.7681    0.0000 [ 0.8308; 0.8799 ] 
  PrevAch =~ bytxmstd          0.9006      0.0114   79.0640    0.0000 [ 0.8793; 0.9237 ] 
  PrevAch =~ bytxsstd          0.7997      0.0152   52.5398    0.0000 [ 0.7698; 0.8269 ] 
  PrevAch =~ bytxhstd          0.8270      0.0120   68.9822    0.0000 [ 0.8043; 0.8500 ] 
  HW =~ hw_8                   0.5542      0.0375   14.7949    0.0000 [ 0.4851; 0.6271 ] 
  HW =~ hw10                   0.6502      0.0415   15.6741    0.0000 [ 0.5718; 0.7342 ] 
  Grades =~ eng_12             0.8727      0.0112   77.8085    0.0000 [ 0.8519; 0.8938 ] 
  Grades =~ math_12            0.8948      0.0100   89.7146    0.0000 [ 0.8757; 0.9138 ] 
  Grades =~ sci_12             0.8469      0.0127   66.8316    0.0000 [ 0.8231; 0.8709 ] 
  Grades =~ ss_12              0.8323      0.0112   74.2255    0.0000 [ 0.8102; 0.8522 ] 

Estimated weights:
==================
                                                                         CI_percentile   
  Weight                     Estimate  Std. error   t-stat.   p-value         95%        
  Famback &lt;~ bypared           0.4646      0.0157   29.5174    0.0000 [ 0.4378; 0.4985 ] 
  Famback &lt;~ byfaminc          0.3851      0.0147   26.2405    0.0000 [ 0.3544; 0.4151 ] 
  Famback &lt;~ parocc            0.3417      0.0143   23.8715    0.0000 [ 0.3138; 0.3697 ] 
  EthnicMinor &lt;~ Minority      1.0000          NA        NA        NA [     NA;     NA ] 
  PrevAch &lt;~ bytxrstd          0.2848      0.0041   68.8855    0.0000 [ 0.2763; 0.2927 ] 
  PrevAch &lt;~ bytxmstd          0.3001      0.0041   73.7641    0.0000 [ 0.2917; 0.3083 ] 
  PrevAch &lt;~ bytxsstd          0.2665      0.0042   63.1437    0.0000 [ 0.2578; 0.2742 ] 
  PrevAch &lt;~ bytxhstd          0.2756      0.0035   77.9316    0.0000 [ 0.2686; 0.2822 ] 
  HW &lt;~ hw_8                   0.5571      0.0323   17.2637    0.0000 [ 0.4908; 0.6183 ] 
  HW &lt;~ hw10                   0.6536      0.0310   21.1039    0.0000 [ 0.5915; 0.7171 ] 
  Grades &lt;~ eng_12             0.2818      0.0035   80.7576    0.0000 [ 0.2753; 0.2894 ] 
  Grades &lt;~ math_12            0.2889      0.0035   83.7396    0.0000 [ 0.2824; 0.2959 ] 
  Grades &lt;~ sci_12             0.2734      0.0034   81.1639    0.0000 [ 0.2667; 0.2798 ] 
  Grades &lt;~ ss_12              0.2688      0.0031   87.7297    0.0000 [ 0.2630; 0.2747 ] 

Estimated construct correlations:
=================================
                                                                        CI_percentile   
  Correlation               Estimate  Std. error   t-stat.   p-value         95%        
  Famback ~~ EthnicMinor      0.4010      0.0298   13.4688    0.0000 [ 0.3428; 0.4550 ] 

------------------------------------ Effects -----------------------------------

Estimated total effects:
========================
                                                                       CI_percentile   
  Total effect             Estimate  Std. error   t-stat.   p-value         95%        
  PrevAch ~ Famback          0.5106      0.0329   15.5174    0.0000 [ 0.4430; 0.5748 ] 
  PrevAch ~ EthnicMinor      0.1479      0.0298    4.9656    0.0000 [ 0.0882; 0.2120 ] 
  HW ~ Famback               0.4943      0.0507    9.7457    0.0000 [ 0.3976; 0.5888 ] 
  HW ~ EthnicMinor          -0.0178      0.0429   -0.4151    0.6781 [-0.0993; 0.0674 ] 
  HW ~ PrevAch               0.3990      0.0526    7.5870    0.0000 [ 0.2923; 0.5058 ] 
  Grades ~ Famback           0.4923      0.0316   15.5768    0.0000 [ 0.4326; 0.5538 ] 
  Grades ~ EthnicMinor       0.1342      0.0281    4.7690    0.0000 [ 0.0758; 0.1961 ] 
  Grades ~ PrevAch           0.9345      0.0101   92.7573    0.0000 [ 0.9130; 0.9524 ] 
  Grades ~ HW                0.0520      0.0273    1.9072    0.0565 [-0.0013; 0.1070 ] 

Estimated indirect effects:
===========================
                                                                      CI_percentile   
  Indirect effect         Estimate  Std. error   t-stat.   p-value         95%        
  HW ~ Famback              0.2037      0.0298    6.8409    0.0000 [ 0.1470; 0.2667 ] 
  HW ~ EthnicMinor          0.0590      0.0143    4.1148    0.0000 [ 0.0327; 0.0910 ] 
  Grades ~ Famback          0.4923      0.0316   15.5768    0.0000 [ 0.4326; 0.5538 ] 
  Grades ~ EthnicMinor      0.1342      0.0281    4.7690    0.0000 [ 0.0758; 0.1961 ] 
  Grades ~ PrevAch          0.0208      0.0109    1.8974    0.0578 [-0.0005; 0.0440 ] 
________________________________________________________________________________</code></pre>
</div>
</div>
</section>
</section>
<section id="competing-models" class="level2">
<h2 class="anchored" data-anchor-id="competing-models">Competing models</h2>
<p><img src="images/table18-2.png" class="img-fluid" width="700"></p>
<p><img src="images/fig18-8.png" class="img-fluid" width="700"></p>
<div id="cell-21" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Measurement model</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>hw_model_cfa <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">  EthnicMinor =~ Minority</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Famback =~ bypared + byfaminc + parocc</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">  HW =~ hw_8 + hw10</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Minority ~~ 0.0099*Minority</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>hw_fit_cfa <span class="ot">&lt;-</span> <span class="fu">cfa</span>(hw_model_cfa, <span class="at">sample.cov =</span> hwcov, <span class="at">sample.nobs =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="84">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit, hw_fit_cfa) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

           Df   AIC   BIC  Chisq Chisq diff     RMSEA Df diff Pr(&gt;Chisq)
hw_fit_cfa 64 66742 66944 202.47                                        
hw_fit     66 66741 66932 204.65     2.1889 0.0097196       2     0.3347

####################### Model Fit Indices ###########################
              chisq df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_cfa 202.465† 64   .000 .047  .983† .976  .029† 66742.313  66943.531 
hw_fit     204.654  66   .000 .046† .983  .977† .029  66740.502† 66931.905†

################## Differences in Fit Indices #######################
                    df  rmsea cfi   tli  srmr    aic     bic
hw_fit - hw_fit_cfa  2 -0.001   0 0.001 0.001 -1.811 -11.627

The following lavaan models were compared:
    hw_fit_cfa
    hw_fit
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
<p><strong>Modification indices</strong></p>
<div id="cell-24" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="191">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(hw_fit, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">subset</span>(mi <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
86           HW =~ bytxmstd 42.221  4.562   2.326    0.223    0.223
98       Grades =~ bytxmstd 37.990  0.734   1.814    0.174    0.174
103    Minority ~~  bypared 23.209  0.067   0.067    0.889    0.889
47  EthnicMinor =~  bypared 22.716  0.395   0.171    0.133    0.133
158    bytxmstd ~~ bytxhstd 21.288 -6.514  -6.514   -0.210   -0.210
48  EthnicMinor =~ byfaminc 18.841 -0.725  -0.314   -0.125   -0.125
104    Minority ~~ byfaminc 18.752 -0.123  -0.123   -0.657   -0.657
99       Grades =~ bytxsstd 14.693 -0.455  -1.123   -0.109   -0.109
167    bytxsstd ~~   eng_12 14.085 -1.009  -1.009   -0.179   -0.179
187     math_12 ~~   sci_12 13.040  0.277   0.277    0.140    0.140
82           HW =~  bypared 11.355  0.358   0.182    0.142    0.142
186      eng_12 ~~    ss_12 10.345  0.285   0.285    0.238    0.238</code></pre>
</div>
</div>
<p><strong>Residuals</strong></p>
<p>Keith’s figure 18.10: normalized residuals</p>
<div id="cell-27" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="211">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardized residuals</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>resid_z <span class="ot">&lt;-</span> <span class="fu">residuals</span>(hw_fit, <span class="at">type =</span> <span class="st">"standardized.mplus"</span>)<span class="sc">$</span>cov</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(resid_z, <span class="at">method =</span> <span class="st">'number'</span>, <span class="at">type =</span> <span class="st">'lower'</span>, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap18_files/figure-html/cell-19-output-1.png" width="720" height="720" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="212">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation residuals</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>resid_cor <span class="ot">&lt;-</span> <span class="fu">residuals</span>(hw_fit, <span class="at">type =</span> <span class="st">"cor"</span>)<span class="sc">$</span>cov</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(resid_cor, <span class="at">method =</span> <span class="st">'number'</span>, <span class="at">type =</span> <span class="st">'lower'</span>, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap18_files/figure-html/cell-20-output-1.png" width="720" height="720" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="panel-models" class="level2">
<h2 class="anchored" data-anchor-id="panel-models">Panel Models</h2>
<p>성취도가 locus of control에 미치는 영향과 locus of control이 성취도에 미치는 종단적 영향을 파악하기 위한 모형; 주 목적은 효과의 방향성에 대한 이해</p>
<p><img src="images/fig18-12.png" class="img-fluid" width="800"></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>BYS44B 나는 내 인생이 나아가는 방향을 충분히 통제하지 못한다(그림에서 control8)<br>
BYS44C 내 인생에서 성공을 위해서는 노력보다 행운이 더 중요하다(luck8)<br>
BYS44F 내가 앞서 나가려고 할 때마다 무언가 또는 누군가가 나를 막는다 (stops8)<br>
BYS44M 내 인생에서 일어나는 일에는 기회와 행운이 매우 중요하다(chance8)</p>
</div>
</div>
</div>
<p>논의: 각 시점 내에서 인과관계는 설정하지 않았음. Why?</p>
<div id="cell-30" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<details class="code-fold">
<summary>Load the dataset</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"BySES"</span>, <span class="st">"control8"</span>, <span class="st">"luck8"</span>, <span class="st">"stops8"</span>, <span class="st">"chance8"</span>, <span class="st">"contro10"</span>, <span class="st">"luck10"</span>, <span class="st">"stops10"</span>, <span class="st">"chance10"</span>, <span class="st">"contro12"</span>, <span class="st">"luck12"</span>, <span class="st">"stops12"</span>, <span class="st">"chance12"</span>, <span class="st">"feel8"</span>, <span class="st">"worth8"</span>, <span class="st">"do8"</span>, <span class="st">"sat8"</span>, <span class="st">"feel10"</span>, <span class="st">"worth10"</span>, <span class="st">"do10"</span>, <span class="st">"sat10"</span>, <span class="st">"feel12"</span>, <span class="st">"worth12"</span>, <span class="st">"do12"</span>, <span class="st">"sat12"</span>, <span class="st">"read8"</span>, <span class="st">"math8"</span>, <span class="st">"scienc8"</span>, <span class="st">"social8"</span>, <span class="st">"read10"</span>, <span class="st">"math10"</span>, <span class="st">"scienc10"</span>, <span class="st">"social10"</span>, <span class="st">"read12"</span>, <span class="st">"math12"</span>, <span class="st">"scienc12"</span>, <span class="st">"social12"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>loc_txt <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"data/chap 18 latent var SEM 2/sc locus ach matrix n12k.txt"</span>, <span class="at">col_names =</span> vars)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>loc_mean <span class="ot">&lt;-</span> loc_txt[<span class="dv">40</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>loc_sds <span class="ot">&lt;-</span> loc_txt[<span class="dv">39</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>loc_cor <span class="ot">&lt;-</span> loc_txt[<span class="dv">1</span><span class="sc">:</span><span class="dv">38</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>loc_cov <span class="ot">&lt;-</span> loc_cor <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> vars, <span class="at">sds =</span> loc_sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-31" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>loc_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # measurement model</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus8 =~ control8 + luck8 + stops8 + chance8</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus10 =~ contro10 + luck10 + stops10 + chance10</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus12 =~ contro12 + luck12 + stops12 + chance12</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach8 =~ read8 + math8 + scienc8 + social8</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach10 =~ read10 + math10 + scienc10 + social10</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach12 =~ read12 + math12 + scienc12 + social12</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="st">  # structural model</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus12 ~ Locus10 + Ach10</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach12 ~ Ach10 + Locus10</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus10 ~ Locus8 + Ach8</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach10 ~ Ach8 + Locus8</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus8 ~ Sex + BySES</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach8 ~ Sex + BySES</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="st">  Sex ~~ 0*BySES</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="st">  # correlated disturbances at each time point</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus8 ~~ Ach8</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus10 ~~ Ach10</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus12 ~~ Ach12</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="st">  # correlated errors items over time</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="st">  control8 ~~ contro10</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="st">  control8 ~~ contro12</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="st">  contro10 ~~ contro12</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="st">  luck8 ~~ luck10</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="st">  luck8 ~~ luck12</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="st">  luck10 ~~ luck12</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="st">  stops8 ~~ stops10</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="st">  stops8 ~~ stops12</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="st">  stops10 ~~ stops12</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="st">  chance8 ~~ chance10</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="st">  chance8 ~~ chance12</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="st">  chance10 ~~ chance12</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="st">  read8 ~~ read10</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="st">  read8 ~~ read12</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="st">  read10 ~~ read12</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="st">  math8 ~~ math10</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="st">  math8 ~~ math12</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a><span class="st">  math10 ~~ math12</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="st">  scienc8 ~~ scienc10</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="st">  scienc8 ~~ scienc12</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="st">  scienc10 ~~ scienc12</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="st">  social8 ~~ social10</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="st">  social8 ~~ social12</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="st">  social10 ~~ social12</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>loc_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(loc_model, <span class="at">sample.cov =</span> loc_cov, <span class="at">sample.nobs =</span> <span class="dv">12572</span>)</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(loc_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 286 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        89

  Number of observations                         12572

Model Test User Model:
                                                      
  Test statistic                              8204.529
  Degrees of freedom                               262
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                            224320.606
  Degrees of freedom                               325
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.965
  Tucker-Lewis Index (TLI)                       0.956

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)            -652454.746
  Loglikelihood unrestricted model (H1)    -648352.482
                                                      
  Akaike (AIC)                             1305087.492
  Bayesian (BIC)                           1305749.584
  Sample-size adjusted Bayesian (SABIC)    1305466.751

Root Mean Square Error of Approximation:

  RMSEA                                          0.049
  90 Percent confidence interval - lower         0.048
  90 Percent confidence interval - upper         0.050
  P-value H_0: RMSEA &lt;= 0.050                    0.946
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.044

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Locus8 =~                                                             
    control8          1.000                               0.357    0.441
    luck8             1.248    0.035   35.417    0.000    0.446    0.605
    stops8            0.929    0.030   31.099    0.000    0.332    0.439
    chance8           1.555    0.043   35.948    0.000    0.555    0.624
  Locus10 =~                                                            
    contro10          1.000                               0.355    0.457
    luck10            1.281    0.033   39.181    0.000    0.455    0.663
    stops10           0.892    0.027   33.620    0.000    0.317    0.451
    chance10          1.459    0.037   39.484    0.000    0.518    0.657
  Locus12 =~                                                            
    contro12          1.000                               0.373    0.473
    luck12            1.343    0.031   43.051    0.000    0.500    0.719
    stops12           0.951    0.025   37.709    0.000    0.354    0.505
    chance12          1.489    0.035   43.061    0.000    0.555    0.694
  Ach8 =~                                                               
    read8             1.000                               8.564    0.842
    math8             1.023    0.008  121.261    0.000    8.763    0.851
    scienc8           1.019    0.008  120.649    0.000    8.729    0.855
    social8           1.005    0.008  118.952    0.000    8.605    0.846
  Ach10 =~                                                              
    read10            1.000                               8.695    0.863
    math10            1.021    0.007  136.374    0.000    8.877    0.877
    scienc10          1.042    0.008  136.616    0.000    9.064    0.885
    social10          1.006    0.008  130.757    0.000    8.744    0.864
  Ach12 =~                                                              
    read12            1.000                               8.607    0.857
    math12            1.038    0.008  135.026    0.000    8.932    0.883
    scienc12          1.036    0.008  133.000    0.000    8.921    0.881
    social12          1.016    0.008  130.088    0.000    8.744    0.869

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Locus12 ~                                                             
    Locus10           0.564    0.020   28.477    0.000    0.537    0.537
    Ach10             0.006    0.000   12.038    0.000    0.136    0.136
  Ach12 ~                                                               
    Ach10             0.950    0.006  151.543    0.000    0.959    0.959
    Locus10           0.321    0.107    3.000    0.003    0.013    0.013
  Locus10 ~                                                             
    Locus8            0.521    0.021   24.766    0.000    0.524    0.524
    Ach8              0.004    0.001    7.883    0.000    0.103    0.103
  Ach10 ~                                                               
    Ach8              0.945    0.007  132.611    0.000    0.931    0.931
    Locus8            0.818    0.142    5.745    0.000    0.034    0.034
  Locus8 ~                                                              
    Sex               0.023    0.008    2.926    0.003    0.063    0.032
    BySES             0.126    0.006   22.788    0.000    0.353    0.283
  Ach8 ~                                                                
    Sex              -0.540    0.135   -3.994    0.000   -0.063   -0.032
    BySES             5.788    0.090   64.430    0.000    0.676    0.542

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sex ~~                                                                
    BySES             0.000                               0.000    0.000
 .Locus8 ~~                                                             
   .Ach8              0.982    0.038   25.985    0.000    0.399    0.399
 .Locus10 ~~                                                            
   .Ach10             0.149    0.013   11.154    0.000    0.185    0.185
 .Locus12 ~~                                                            
   .Ach12             0.108    0.011    9.890    0.000    0.160    0.160
 .control8 ~~                                                           
   .contro10          0.077    0.005   15.574    0.000    0.077    0.154
   .contro12          0.065    0.005   13.194    0.000    0.065    0.129
 .contro10 ~~                                                           
   .contro12          0.089    0.005   18.824    0.000    0.089    0.186
 .luck8 ~~                                                              
   .luck10            0.026    0.004    7.223    0.000    0.026    0.086
   .luck12            0.025    0.003    7.467    0.000    0.025    0.089
 .luck10 ~~                                                             
   .luck12            0.025    0.003    7.839    0.000    0.025    0.101
 .stops8 ~~                                                             
   .stops10           0.089    0.004   21.178    0.000    0.089    0.210
   .stops12           0.067    0.004   16.658    0.000    0.067    0.164
 .stops10 ~~                                                            
   .stops12           0.099    0.004   25.969    0.000    0.099    0.263
 .chance8 ~~                                                            
   .chance10          0.076    0.005   15.238    0.000    0.076    0.185
   .chance12          0.074    0.005   15.669    0.000    0.074    0.185
 .chance10 ~~                                                           
   .chance12          0.068    0.004   15.871    0.000    0.068    0.199
 .read8 ~~                                                              
   .read10           12.691    0.336   37.725    0.000   12.691    0.456
   .read12            9.783    0.327   29.894    0.000    9.783    0.345
 .read10 ~~                                                             
   .read12           11.906    0.319   37.334    0.000   11.906    0.453
 .math8 ~~                                                              
   .math10           18.040    0.351   51.470    0.000   18.040    0.686
   .math12           15.389    0.332   46.385    0.000   15.389    0.598
 .math10 ~~                                                             
   .math12           18.056    0.328   55.035    0.000   18.056    0.782
 .scienc8 ~~                                                            
   .scienc10          4.344    0.303   14.353    0.000    4.344    0.171
   .scienc12          4.285    0.300   14.284    0.000    4.285    0.168
 .scienc10 ~~                                                           
   .scienc12          7.300    0.290   25.213    0.000    7.300    0.318
 .social8 ~~                                                            
   .social10          7.607    0.323   23.573    0.000    7.607    0.275
   .social12          5.962    0.310   19.204    0.000    5.962    0.221
 .social10 ~~                                                           
   .social12          7.351    0.301   24.438    0.000    7.351    0.290

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .control8          0.528    0.008   70.109    0.000    0.528    0.806
   .luck8             0.344    0.006   56.216    0.000    0.344    0.634
   .stops8            0.460    0.007   70.237    0.000    0.460    0.807
   .chance8           0.484    0.009   54.421    0.000    0.484    0.611
   .contro10          0.477    0.007   70.646    0.000    0.477    0.791
   .luck10            0.264    0.005   51.766    0.000    0.264    0.560
   .stops10           0.392    0.006   71.020    0.000    0.392    0.796
   .chance10          0.352    0.007   53.246    0.000    0.352    0.568
   .contro12          0.482    0.007   71.233    0.000    0.482    0.776
   .luck12            0.234    0.005   47.379    0.000    0.234    0.483
   .stops12           0.366    0.005   69.721    0.000    0.366    0.745
   .chance12          0.331    0.006   51.512    0.000    0.331    0.518
   .read8            29.988    0.464   64.565    0.000   29.988    0.290
   .math8            29.338    0.461   63.667    0.000   29.338    0.276
   .scienc8          28.105    0.454   61.900    0.000   28.105    0.269
   .social8          29.485    0.463   63.690    0.000   29.485    0.285
   .read10           25.818    0.397   65.026    0.000   25.818    0.255
   .math10           23.568    0.372   63.324    0.000   23.568    0.230
   .scienc10         22.844    0.377   60.589    0.000   22.844    0.218
   .social10         26.025    0.405   64.281    0.000   26.025    0.254
   .read12           26.760    0.411   65.092    0.000   26.760    0.265
   .math12           22.605    0.369   61.267    0.000   22.605    0.221
   .scienc12         23.044    0.380   60.675    0.000   23.044    0.225
   .social12         24.674    0.392   62.900    0.000   24.674    0.244
    Sex               0.250    0.003   79.284    0.000    0.250    1.000
    BySES             0.643    0.008   79.284    0.000    0.643    1.000
   .Locus8            0.117    0.006   21.190    0.000    0.919    0.919
   .Locus10           0.084    0.004   21.806    0.000    0.664    0.664
   .Locus12           0.088    0.004   23.341    0.000    0.636    0.636
   .Ach8             51.746    0.913   56.670    0.000    0.705    0.705
   .Ach10             7.732    0.194   39.803    0.000    0.102    0.102
   .Ach12             5.139    0.139   37.013    0.000    0.069    0.069
</code></pre>
</div>
</div>
</section>
<section id="multigroup-models" class="level2">
<h2 class="anchored" data-anchor-id="multigroup-models">Multigroup Models</h2>
<p>카테고리 변수의 레벨에 따라 잠재변수의 효과가 다른지에 대한 검증; 상호작용 효과<br>
연속인 (잠재)변수 간의 상호작용에 대해서는 22장에서 다룸</p>
<p><img src="images/fig18-14.png" class="img-fluid" width="700"> <img src="images/fig18-15.png" class="img-fluid" width="700"></p>
<p><strong>Estimation</strong><br>
그룹별 공분산 행렬로부터 얻어지는 fit function들의 (표본 수) 가중치 평균을 fit function으로 사용<br>
ML estimation의 경우</p>
<ul>
<li>각 그룹 j에 대해, <span class="math inline">\(F_{ML}^j = log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta)) - log|S| - (p + q)\)</span></li>
<li><span class="math inline">\(\displaystyle F_{ML} = \sum_j \frac{N_j}{N} F_{ML}^j\)</span></li>
</ul>
<p><img src="images/table18-3.png" class="img-fluid" width="700"></p>
<div id="cell-33" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="118">
<details class="code-fold">
<summary>Load the dataset</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a dataset with the same covariance matrix</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>hw_mg_minor <span class="ot">&lt;-</span> <span class="fu">read_xls</span>(<span class="st">"data/chap 18 latent var SEM 2/minority matrix.xls"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>hw_mg_white <span class="ot">&lt;-</span> <span class="fu">read_xls</span>(<span class="st">"data/chap 18 latent var SEM 2/white matrix.xls"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For minority group</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>hw_mg_minor_cov <span class="ot">&lt;-</span> hw_mg_minor[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>)] <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> hw_mg_minor<span class="sc">$</span>varname_[<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>], <span class="at">sds =</span> hw_mg_minor[<span class="dv">16</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>())</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hw_mg_minor_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(hw_mg_minor_cov))</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(hw_mg_minor_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">rownames</span>(hw_mg_minor_cov))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>mean_minor <span class="ot">&lt;-</span> hw_mg_minor[<span class="dv">15</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For white group</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>hw_mg_white_cov <span class="ot">&lt;-</span> hw_mg_white[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>)] <span class="sc">|&gt;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> hw_mg_white<span class="sc">$</span>varname_[<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>], <span class="at">sds =</span> hw_mg_white[<span class="dv">16</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>())</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hw_mg_white_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(hw_mg_white_cov))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(hw_mg_white_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">rownames</span>(hw_mg_white_cov))</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>mean_white <span class="ot">&lt;-</span> hw_mg_white[<span class="dv">15</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>hw_sim_minor <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(hw_mg_minor_cov, <span class="at">n =</span> <span class="dv">274</span>, <span class="at">type =</span> <span class="st">"exact"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sweep</span>(<span class="dv">2</span>, mean_minor, <span class="at">FUN =</span> <span class="st">"+"</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>hw_sim_white <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(hw_mg_white_cov, <span class="at">n =</span> <span class="dv">751</span>, <span class="at">type =</span> <span class="st">"exact"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sweep</span>(<span class="dv">2</span>, mean_white, <span class="at">FUN =</span> <span class="st">"+"</span>)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>hw_multigroup <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  hw_sim_minor <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"minority"</span>),</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  hw_sim_white <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"white"</span>)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-34" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="140">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hw_multigroup <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   bypared  byfaminc    parocc bytxrstd bytxmstd bytxsstd bytxhstd      hw_8     hw10
1 2.652532 10.476661 18.307222 43.65915 39.43580 42.74107 40.74896 1.3523054 1.306605
2 3.239465 14.484947 74.631633 54.42977 51.73896 39.76785 53.69368 0.9458118 2.286500
3 2.838165  5.395492 42.167602 53.91747 54.32145 54.13184 57.90915 3.0370230 4.395371
4 2.915970  7.356455  5.484995 40.96697 49.80111 41.78480 40.72891 0.8160087 5.382795
5 2.922286 10.663560 73.556475 54.29385 46.56837 45.06998 56.56422 2.0667411 3.445518
6 3.292368  6.077062 51.054957 31.28932 40.07090 37.19290 42.00691 0.3734137 5.962409
     eng_12  math_12   sci_12      ss_12    group
1 2.5335580 2.120710 5.271499  4.9715650 minority
2 3.0291990 3.019287 3.453295  4.4420167 minority
3 7.2641590 4.234914 6.412513  6.0492556 minority
4 5.8850810 7.137627 6.427559  5.6934853 minority
5 5.9106342 4.157715 5.813612  3.8663800 minority
6 0.3162357 1.635991 3.080359 -0.1924061 minority</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Using covariance matrices">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using covariance matrices
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>hw_fit_mg <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.cov =</span> <span class="fu">list</span>(hw_mg_white_cov, hw_mg_minor_cov),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.mean =</span> <span class="fu">list</span>(mean_white, mean_minor),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.nobs =</span> <span class="fu">list</span>(<span class="dv">751</span>, <span class="dv">274</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Simulated data를 이용</p>
<div id="cell-37" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="146">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>hw_model_mg <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw10 + hw_8</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>hw_fit_mg <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg, <span class="at">data =</span> hw_multigroup, <span class="at">group =</span> <span class="st">"group"</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit_mg, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 424 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        96

  Number of observations per group:                   
    minority                                       274
    white                                          751

Model Test User Model:
                                                      
  Test statistic                               223.175
  Degrees of freedom                               112
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    minority                                    95.604
    white                                      127.571

Model Test Baseline Model:

  Test statistic                              8290.390
  Degrees of freedom                               156
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.986
  Tucker-Lewis Index (TLI)                       0.981

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -33497.853
  Loglikelihood unrestricted model (H1)     -33386.266
                                                      
  Akaike (AIC)                               67187.706
  Bayesian (BIC)                             67661.221
  Sample-size adjusted Bayesian (SABIC)      67356.315

Root Mean Square Error of Approximation:

  RMSEA                                          0.044
  90 Percent confidence interval - lower         0.036
  90 Percent confidence interval - upper         0.052
  P-value H_0: RMSEA &lt;= 0.050                    0.876
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.029

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [minority]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              19.007    0.793
    bypared           0.059    0.005   11.770    0.000    1.112    0.801
    byfaminc          0.103    0.010   10.666    0.000    1.961    0.692
  prevach =~                                                            
    bytxrstd          1.000                               8.514    0.859
    bytxmstd          1.058    0.057   18.530    0.000    9.010    0.869
    bytxsstd          0.951    0.057   16.576    0.000    8.100    0.815
    bytxhstd          0.942    0.057   16.552    0.000    8.016    0.813
  hw =~                                                                 
    hw10              1.000                               0.544    0.297
    hw_8              0.791    0.195    4.062    0.000    0.430    0.378
  grades =~                                                             
    eng_12            1.000                               2.559    0.929
    math_12           0.895    0.044   20.520    0.000    2.292    0.833
    sci_12            0.923    0.040   22.949    0.000    2.362    0.877
    ss_12             1.049    0.042   24.764    0.000    2.686    0.902

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.263    0.032    8.278    0.000    0.586    0.586
  grades ~                                                              
    prevach           3.197   66.513    0.048    0.962   10.635   10.635
    hw              -46.691 1033.494   -0.045    0.964   -9.924   -9.924
  hw ~                                                                  
    prevach           0.065    0.014    4.595    0.000    1.011    1.011
    famback          -0.000    0.004   -0.045    0.964   -0.006   -0.006

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.191    0.456    0.418    0.676    0.191    0.037
 .bytxmstd ~~                                                           
   .math_12           2.386    0.613    3.895    0.000    2.386    0.305
 .bytxsstd ~~                                                           
   .sci_12            0.289    0.551    0.524    0.600    0.289    0.039
 .bytxhstd ~~                                                           
   .ss_12             1.140    0.573    1.989    0.047    1.140    0.155

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           43.085    1.448   29.755    0.000   43.085    1.798
   .bypared           2.849    0.084   33.953    0.000    2.849    2.051
   .byfaminc          8.757    0.171   51.131    0.000    8.757    3.089
   .bytxrstd         48.537    0.599   81.056    0.000   48.537    4.897
   .bytxmstd         49.808    0.626   79.526    0.000   49.808    4.804
   .bytxsstd         47.959    0.600   79.907    0.000   47.959    4.827
   .bytxhstd         48.160    0.596   80.823    0.000   48.160    4.883
   .hw10              3.214    0.111   29.011    0.000    3.214    1.753
   .hw_8              1.718    0.069   24.980    0.000    1.718    1.509
   .eng_12            5.820    0.166   34.973    0.000    5.820    2.113
   .math_12           5.385    0.166   32.389    0.000    5.385    1.957
   .sci_12            5.590    0.163   34.372    0.000    5.590    2.076
   .ss_12             5.895    0.180   32.785    0.000    5.895    1.981

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          213.212   29.517    7.223    0.000  213.212    0.371
   .bypared           0.691    0.099    6.993    0.000    0.691    0.358
   .byfaminc          4.193    0.447    9.378    0.000    4.193    0.522
   .bytxrstd         25.755    3.009    8.560    0.000   25.755    0.262
   .bytxmstd         26.302    3.181    8.268    0.000   26.302    0.245
   .bytxsstd         33.096    3.475    9.525    0.000   33.096    0.335
   .bytxhstd         33.025    3.448    9.577    0.000   33.025    0.339
   .hw10              3.068    0.281   10.932    0.000    3.068    0.912
   .hw_8              1.112    0.114    9.773    0.000    1.112    0.857
   .eng_12            1.039    0.148    7.029    0.000    1.039    0.137
   .math_12           2.321    0.230   10.076    0.000    2.321    0.306
   .sci_12            1.670    0.181    9.241    0.000    1.670    0.230
   .ss_12             1.647    0.195    8.433    0.000    1.647    0.186
    famback         361.270   51.153    7.063    0.000    1.000    1.000
   .prevach          47.575    6.080    7.825    0.000    0.656    0.656
   .hw               -0.005    0.103   -0.045    0.964   -0.016   -0.016
   .grades           14.056  225.550    0.062    0.950    2.146    2.146


Group 2 [white]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              14.207    0.718
    bypared           0.072    0.004   16.238    0.000    1.025    0.842
    byfaminc          0.094    0.007   14.113    0.000    1.336    0.593
  prevach =~                                                            
    bytxrstd          1.000                               8.583    0.844
    bytxmstd          0.997    0.036   28.022    0.000    8.560    0.835
    bytxsstd          0.987    0.035   28.103    0.000    8.475    0.842
    bytxhstd          0.970    0.035   27.524    0.000    8.325    0.833
  hw =~                                                                 
    hw10              1.000                               1.280    0.664
    hw_8              0.389    0.063    6.181    0.000    0.498    0.441
  grades =~                                                             
    eng_12            1.000                               2.419    0.920
    math_12           0.901    0.028   32.154    0.000    2.179    0.815
    sci_12            0.972    0.026   37.566    0.000    2.352    0.878
    ss_12             1.065    0.026   41.677    0.000    2.577    0.917

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.299    0.027   11.063    0.000    0.495    0.495
  grades ~                                                              
    prevach           0.156    0.012   13.222    0.000    0.555    0.555
    hw                0.468    0.114    4.118    0.000    0.248    0.248
  hw ~                                                                  
    prevach           0.046    0.009    4.917    0.000    0.307    0.307
    famback           0.022    0.006    3.658    0.000    0.239    0.239

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.860    0.289    2.971    0.003    0.860    0.153
 .bytxmstd ~~                                                           
   .math_12           2.953    0.400    7.387    0.000    2.953    0.338
 .bytxsstd ~~                                                           
   .sci_12            1.139    0.327    3.483    0.000    1.139    0.164
 .bytxhstd ~~                                                           
   .ss_12             0.349    0.310    1.127    0.260    0.349    0.056

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           54.883    0.722   76.051    0.000   54.883    2.775
   .bypared           3.335    0.044   75.101    0.000    3.335    2.740
   .byfaminc         10.348    0.082  125.757    0.000   10.348    4.589
   .bytxrstd         53.260    0.371  143.506    0.000   53.260    5.237
   .bytxmstd         53.559    0.374  143.173    0.000   53.559    5.224
   .bytxsstd         53.335    0.367  145.260    0.000   53.335    5.301
   .bytxhstd         52.956    0.365  145.243    0.000   52.956    5.300
   .hw10              3.443    0.070   48.980    0.000    3.443    1.787
   .hw_8              1.733    0.041   42.046    0.000    1.733    1.534
   .eng_12            6.409    0.096   66.808    0.000    6.409    2.438
   .math_12           5.823    0.098   59.670    0.000    5.823    2.177
   .sci_12            6.088    0.098   62.269    0.000    6.088    2.272
   .ss_12             6.612    0.103   64.449    0.000    6.612    2.352

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          189.275   14.140   13.386    0.000  189.275    0.484
   .bypared           0.431    0.056    7.687    0.000    0.431    0.291
   .byfaminc          3.299    0.198   16.701    0.000    3.299    0.649
   .bytxrstd         29.775    2.045   14.556    0.000   29.775    0.288
   .bytxmstd         31.816    2.137   14.890    0.000   31.816    0.303
   .bytxsstd         29.426    2.010   14.640    0.000   29.426    0.291
   .bytxhstd         30.535    2.047   14.917    0.000   30.535    0.306
   .hw10              2.073    0.282    7.355    0.000    2.073    0.559
   .hw_8              1.028    0.067   15.451    0.000    1.028    0.806
   .eng_12            1.060    0.085   12.496    0.000    1.060    0.153
   .math_12           2.401    0.141   17.014    0.000    2.401    0.336
   .sci_12            1.645    0.108   15.261    0.000    1.645    0.229
   .ss_12             1.262    0.099   12.770    0.000    1.262    0.160
    famback         201.843   20.408    9.890    0.000    1.000    1.000
   .prevach          55.591    4.259   13.054    0.000    0.755    0.755
   .hw                1.271    0.275    4.623    0.000    0.776    0.776
   .grades            3.005    0.215   13.978    0.000    0.514    0.514
</code></pre>
</div>
</div>
<section id="measurement-constraints" class="level3">
<h3 class="anchored" data-anchor-id="measurement-constraints">Measurement Constraints</h3>
<p>두 그룹에게 잠재변수가 동일한 의미를 가지는가?; 20장에서 자세히 다룸<br>
그룹 간에 잠재변수/측정모형의 동일성(invariance)을 검정하기 위해 factor loadings를 그룹 간에 동일하게 제약; (weak invariance)</p>
<p>제약에 대한 lavaan 문법: <a href="https://lavaan.ugent.be/tutorial/groups.html">lavaan 문서</a></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>HS.model <span class="ot">&lt;-</span> <span class="st">' visual  =~ x1 + x2 + c(v3,v3)*x3</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="st">              textual =~ x4 + x5 + x6</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="st">              speed   =~ x7 + x8 + x9 '</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>또는 다음 예에서 처럼 <code>group.equal = c("loadings")</code> 키워드를 이용<br>
결과표에서 .p1, .p2, …으로 동일하게 제약된 factor loadings를 확인할 수 있음</p>
<div id="cell-39" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="121">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrains factor loadings</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>hw_fit_mg2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit_mg2, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 398 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        96
  Number of equality constraints                     9

  Number of observations per group:                   
    minority                                       274
    white                                          751

Model Test User Model:
                                                      
  Test statistic                               238.786
  Degrees of freedom                               121
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    minority                                   106.836
    white                                      131.949

Model Test Baseline Model:

  Test statistic                              8290.390
  Degrees of freedom                               156
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.986
  Tucker-Lewis Index (TLI)                       0.981

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -33505.658
  Loglikelihood unrestricted model (H1)     -33386.266
                                                      
  Akaike (AIC)                               67185.317
  Bayesian (BIC)                             67614.440
  Sample-size adjusted Bayesian (SABIC)      67338.119

Root Mean Square Error of Approximation:

  RMSEA                                          0.044
  90 Percent confidence interval - lower         0.035
  90 Percent confidence interval - upper         0.052
  P-value H_0: RMSEA &lt;= 0.050                    0.902
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.033

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [minority]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              17.929    0.760
    bypared (.p2.)    0.067    0.003   20.083    0.000    1.207    0.846
    byfamnc (.p3.)    0.096    0.006   17.481    0.000    1.727    0.629
  prevach =~                                                            
    bytxrst           1.000                               8.530    0.860
    bytxmst (.p5.)    1.014    0.030   33.540    0.000    8.647    0.854
    bytxsst (.p6.)    0.978    0.030   32.678    0.000    8.340    0.826
    bytxhst (.p7.)    0.962    0.030   32.151    0.000    8.209    0.823
  hw =~                                                                 
    hw10              1.000                               0.678    0.361
    hw_8    (.p9.)    0.468    0.061    7.685    0.000    0.317    0.286
  grades =~                                                             
    eng_12            1.000                               2.527    0.926
    math_12 (.11.)    0.900    0.024   38.162    0.000    2.274    0.831
    sci_12  (.12.)    0.958    0.022   44.037    0.000    2.421    0.884
    ss_12   (.13.)    1.061    0.022   48.511    0.000    2.681    0.902

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.282    0.031    9.079    0.000    0.592    0.592
  grades ~                                                              
    prevach          -3.098    0.506   -6.123    0.000  -10.458  -10.458
    hw               41.744    2.495   16.732    0.000   11.203   11.203
  hw ~                                                                  
    prevach           0.078    0.011    6.992    0.000    0.987    0.987
    famback           0.000    0.000    0.806    0.420    0.005    0.005

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.222    0.456    0.487    0.626    0.222    0.042
 .bytxmstd ~~                                                           
   .math_12           2.426    0.616    3.937    0.000    2.426    0.302
 .bytxsstd ~~                                                           
   .sci_12            0.347    0.552    0.628    0.530    0.347    0.047
 .bytxhstd ~~                                                           
   .ss_12             1.099    0.571    1.925    0.054    1.099    0.151

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           43.085    1.425   30.231    0.000   43.085    1.826
   .bypared           2.849    0.086   33.057    0.000    2.849    1.997
   .byfaminc          8.757    0.166   52.839    0.000    8.757    3.192
   .bytxrstd         48.537    0.599   80.979    0.000   48.537    4.892
   .bytxmstd         49.808    0.612   81.392    0.000   49.808    4.917
   .bytxsstd         47.959    0.610   78.614    0.000   47.959    4.749
   .bytxhstd         48.160    0.603   79.915    0.000   48.160    4.828
   .hw10              3.214    0.114   28.309    0.000    3.214    1.710
   .hw_8              1.718    0.067   25.611    0.000    1.718    1.547
   .eng_12            5.820    0.165   35.298    0.000    5.820    2.132
   .math_12           5.385    0.165   32.569    0.000    5.385    1.968
   .sci_12            5.590    0.165   33.777    0.000    5.590    2.041
   .ss_12             5.895    0.180   32.823    0.000    5.895    1.983

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          235.079   27.675    8.494    0.000  235.079    0.422
   .bypared           0.578    0.096    6.031    0.000    0.578    0.284
   .byfaminc          4.543    0.442   10.284    0.000    4.543    0.604
   .bytxrstd         25.676    2.946    8.715    0.000   25.676    0.261
   .bytxmstd         27.839    3.136    8.878    0.000   27.839    0.271
   .bytxsstd         32.420    3.423    9.471    0.000   32.420    0.318
   .bytxhstd         32.120    3.371    9.528    0.000   32.120    0.323
   .hw10              3.073    0.265   11.610    0.000    3.073    0.870
   .hw_8              1.133    0.097   11.672    0.000    1.133    0.918
   .eng_12            1.064    0.143    7.437    0.000    1.064    0.143
   .math_12           2.320    0.228   10.161    0.000    2.320    0.310
   .sci_12            1.643    0.179    9.178    0.000    1.643    0.219
   .ss_12             1.652    0.192    8.612    0.000    1.652    0.187
    famback         321.452   39.204    8.200    0.000    1.000    1.000
   .prevach          47.246    5.437    8.690    0.000    0.649    0.649
   .hw                0.009    0.005    1.916    0.055    0.020    0.020
   .grades          -12.419    6.464   -1.921    0.055   -1.945   -1.945


Group 2 [white]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              14.625    0.735
    bypared (.p2.)    0.067    0.003   20.083    0.000    0.984    0.818
    byfamnc (.p3.)    0.096    0.006   17.481    0.000    1.409    0.617
  prevach =~                                                            
    bytxrst           1.000                               8.580    0.844
    bytxmst (.p5.)    1.014    0.030   33.540    0.000    8.698    0.841
    bytxsst (.p6.)    0.978    0.030   32.678    0.000    8.389    0.839
    bytxhst (.p7.)    0.962    0.030   32.151    0.000    8.258    0.830
  hw =~                                                                 
    hw10              1.000                               1.177    0.615
    hw_8    (.p9.)    0.468    0.061    7.685    0.000    0.550    0.484
  grades =~                                                             
    eng_12            1.000                               2.431    0.921
    math_12 (.11.)    0.900    0.024   38.162    0.000    2.187    0.816
    sci_12  (.12.)    0.958    0.022   44.037    0.000    2.329    0.875
    ss_12   (.13.)    1.061    0.022   48.511    0.000    2.579    0.917

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.292    0.025   11.434    0.000    0.497    0.497
  grades ~                                                              
    prevach           0.156    0.012   13.103    0.000    0.551    0.551
    hw                0.513    0.121    4.234    0.000    0.249    0.249
  hw ~                                                                  
    prevach           0.045    0.009    5.024    0.000    0.326    0.326
    famback           0.019    0.005    3.546    0.000    0.239    0.239

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.850    0.289    2.938    0.003    0.850    0.152
 .bytxmstd ~~                                                           
   .math_12           2.951    0.400    7.377    0.000    2.951    0.340
 .bytxsstd ~~                                                           
   .sci_12            1.141    0.327    3.491    0.000    1.141    0.163
 .bytxhstd ~~                                                           
   .ss_12             0.361    0.310    1.163    0.245    0.361    0.058

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           54.883    0.726   75.580    0.000   54.883    2.758
   .bypared           3.335    0.044   75.936    0.000    3.335    2.771
   .byfaminc         10.348    0.083  124.155    0.000   10.348    4.530
   .bytxrstd         53.260    0.371  143.520    0.000   53.260    5.237
   .bytxmstd         53.559    0.378  141.840    0.000   53.559    5.176
   .bytxsstd         53.335    0.365  146.123    0.000   53.335    5.332
   .bytxhstd         52.956    0.363  145.853    0.000   52.956    5.322
   .hw10              3.443    0.070   49.289    0.000    3.443    1.799
   .hw_8              1.733    0.042   41.718    0.000    1.733    1.522
   .eng_12            6.409    0.096   66.567    0.000    6.409    2.429
   .math_12           5.823    0.098   59.527    0.000    5.823    2.172
   .sci_12            6.088    0.097   62.700    0.000    6.088    2.288
   .ss_12             6.612    0.103   64.415    0.000    6.612    2.351

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          182.114   13.639   13.352    0.000  182.114    0.460
   .bypared           0.480    0.050    9.615    0.000    0.480    0.331
   .byfaminc          3.233    0.196   16.479    0.000    3.233    0.620
   .bytxrstd         29.799    2.030   14.681    0.000   29.799    0.288
   .bytxmstd         31.427    2.125   14.792    0.000   31.427    0.293
   .bytxsstd         29.674    1.994   14.880    0.000   29.674    0.297
   .bytxhstd         30.813    2.036   15.133    0.000   30.813    0.311
   .hw10              2.279    0.229    9.959    0.000    2.279    0.622
   .hw_8              0.993    0.067   14.787    0.000    0.993    0.766
   .eng_12            1.053    0.084   12.506    0.000    1.053    0.151
   .math_12           2.401    0.141   17.038    0.000    2.401    0.334
   .sci_12            1.655    0.107   15.444    0.000    1.655    0.234
   .ss_12             1.261    0.098   12.866    0.000    1.261    0.159
    famback         213.889   19.110   11.192    0.000    1.000    1.000
   .prevach          55.446    4.061   13.654    0.000    0.753    0.753
   .hw                1.051    0.209    5.032    0.000    0.759    0.759
   .grades            3.031    0.213   14.223    0.000    0.513    0.513
</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="122">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the two models</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 67188 67661 223.17                                         
hw_fit_mg2 121 67185 67614 238.79     15.611 0.037858       9    0.07547 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  223.175† 112   .000 .044  .986† .981  .029† 67187.706  67661.221 
hw_fit_mg2 238.786  121   .000 .044† .986  .981† .033  67185.317† 67614.440†

################## Differences in Fit Indices #######################
                       df rmsea    cfi tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg  9     0 -0.001   0 0.004 -2.389 -46.781

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
</section>
<section id="effect-of-homework-across-groups" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-homework-across-groups">Effect of Homework Across Groups</h3>
<p>경로 hw → grades가 그룹 간에 동일한가?</p>
<div id="cell-42" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="128">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constrains the effect of homework</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>hw_model_mg3 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw10 + hw_8</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + c(h, h)*hw</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>hw_fit_mg3 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg3,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit_mg3, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 303 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        96
  Number of equality constraints                    10

  Number of observations per group:                   
    minority                                       274
    white                                          751

Model Test User Model:
                                                      
  Test statistic                               236.984
  Degrees of freedom                               122
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    minority                                   104.664
    white                                      132.321

Model Test Baseline Model:

  Test statistic                              8290.390
  Degrees of freedom                               156
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.986
  Tucker-Lewis Index (TLI)                       0.982

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -33504.758
  Loglikelihood unrestricted model (H1)     -33386.266
                                                      
  Akaike (AIC)                               67181.515
  Bayesian (BIC)                             67605.706
  Sample-size adjusted Bayesian (SABIC)      67332.561

Root Mean Square Error of Approximation:

  RMSEA                                          0.043
  90 Percent confidence interval - lower         0.035
  90 Percent confidence interval - upper         0.051
  P-value H_0: RMSEA &lt;= 0.050                    0.924
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.033

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [minority]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              17.948    0.761
    bypared (.p2.)    0.067    0.003   20.086    0.000    1.207    0.845
    byfamnc (.p3.)    0.096    0.006   17.489    0.000    1.728    0.630
  prevach =~                                                            
    bytxrst           1.000                               8.528    0.859
    bytxmst (.p5.)    1.014    0.030   33.531    0.000    8.647    0.854
    bytxsst (.p6.)    0.978    0.030   32.663    0.000    8.339    0.825
    bytxhst (.p7.)    0.963    0.030   32.151    0.000    8.210    0.823
  hw =~                                                                 
    hw10              1.000                               0.991    0.528
    hw_8    (.p9.)    0.475    0.061    7.816    0.000    0.471    0.423
  grades =~                                                             
    eng_12            1.000                               2.522    0.926
    math_12 (.11.)    0.900    0.024   38.175    0.000    2.269    0.830
    sci_12  (.12.)    0.958    0.022   44.034    0.000    2.416    0.883
    ss_12   (.13.)    1.061    0.022   48.518    0.000    2.675    0.901

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.283    0.031    9.132    0.000    0.595    0.595
  grades ~                                                              
    prevach           0.146    0.019    7.856    0.000    0.493    0.493
    hw         (h)    0.548    0.121    4.519    0.000    0.216    0.216
  hw ~                                                                  
    prevach           0.076    0.015    5.030    0.000    0.655    0.655
    famback           0.001    0.007    0.094    0.925    0.012    0.012

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.202    0.456    0.443    0.658    0.202    0.039
 .bytxmstd ~~                                                           
   .math_12           2.427    0.616    3.941    0.000    2.427    0.302
 .bytxsstd ~~                                                           
   .sci_12            0.342    0.553    0.619    0.536    0.342    0.047
 .bytxhstd ~~                                                           
   .ss_12             1.079    0.570    1.892    0.059    1.079    0.148

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           43.085    1.425   30.228    0.000   43.085    1.826
   .bypared           2.849    0.086   33.036    0.000    2.849    1.996
   .byfaminc          8.757    0.166   52.837    0.000    8.757    3.192
   .bytxrstd         48.537    0.600   80.939    0.000   48.537    4.890
   .bytxmstd         49.808    0.612   81.404    0.000   49.808    4.918
   .bytxsstd         47.959    0.610   78.584    0.000   47.959    4.747
   .bytxhstd         48.160    0.602   79.937    0.000   48.160    4.829
   .hw10              3.214    0.114   28.318    0.000    3.214    1.711
   .hw_8              1.718    0.067   25.554    0.000    1.718    1.544
   .eng_12            5.820    0.165   35.367    0.000    5.820    2.137
   .math_12           5.385    0.165   32.611    0.000    5.385    1.970
   .sci_12            5.590    0.165   33.832    0.000    5.590    2.044
   .ss_12             5.895    0.179   32.880    0.000    5.895    1.986

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          234.497   27.663    8.477    0.000  234.497    0.421
   .bypared           0.581    0.096    6.047    0.000    0.581    0.285
   .byfaminc          4.539    0.442   10.279    0.000    4.539    0.603
   .bytxrstd         25.812    2.954    8.738    0.000   25.812    0.262
   .bytxmstd         27.801    3.130    8.882    0.000   27.801    0.271
   .bytxsstd         32.520    3.429    9.484    0.000   32.520    0.319
   .bytxhstd         32.045    3.363    9.527    0.000   32.045    0.322
   .hw10              2.548    0.310    8.213    0.000    2.548    0.722
   .hw_8              1.017    0.101   10.048    0.000    1.017    0.821
   .eng_12            1.062    0.143    7.424    0.000    1.062    0.143
   .math_12           2.320    0.228   10.158    0.000    2.320    0.311
   .sci_12            1.644    0.179    9.177    0.000    1.644    0.220
   .ss_12             1.651    0.192    8.606    0.000    1.651    0.187
    famback         322.146   39.268    8.204    0.000    1.000    1.000
   .prevach          46.966    5.417    8.671    0.000    0.646    0.646
   .hw                0.552    0.226    2.444    0.015    0.562    0.562
   .grades            3.626    0.380    9.533    0.000    0.570    0.570


Group 2 [white]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              14.631    0.735
    bypared (.p2.)    0.067    0.003   20.086    0.000    0.984    0.818
    byfamnc (.p3.)    0.096    0.006   17.489    0.000    1.409    0.617
  prevach =~                                                            
    bytxrst           1.000                               8.579    0.844
    bytxmst (.p5.)    1.014    0.030   33.531    0.000    8.699    0.841
    bytxsst (.p6.)    0.978    0.030   32.663    0.000    8.389    0.839
    bytxhst (.p7.)    0.963    0.030   32.151    0.000    8.260    0.830
  hw =~                                                                 
    hw10              1.000                               1.159    0.606
    hw_8    (.p9.)    0.475    0.061    7.816    0.000    0.551    0.484
  grades =~                                                             
    eng_12            1.000                               2.433    0.921
    math_12 (.11.)    0.900    0.024   38.175    0.000    2.190    0.816
    sci_12  (.12.)    0.958    0.022   44.034    0.000    2.331    0.875
    ss_12   (.13.)    1.061    0.022   48.518    0.000    2.581    0.917

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.291    0.025   11.429    0.000    0.497    0.497
  grades ~                                                              
    prevach           0.154    0.012   12.970    0.000    0.543    0.543
    hw         (h)    0.548    0.121    4.519    0.000    0.261    0.261
  hw ~                                                                  
    prevach           0.045    0.009    5.044    0.000    0.330    0.330
    famback           0.019    0.005    3.546    0.000    0.240    0.240

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.851    0.289    2.944    0.003    0.851    0.152
 .bytxmstd ~~                                                           
   .math_12           2.950    0.400    7.375    0.000    2.950    0.340
 .bytxsstd ~~                                                           
   .sci_12            1.141    0.327    3.492    0.000    1.141    0.163
 .bytxhstd ~~                                                           
   .ss_12             0.362    0.310    1.168    0.243    0.362    0.058

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           54.883    0.726   75.571    0.000   54.883    2.758
   .bypared           3.335    0.044   75.949    0.000    3.335    2.771
   .byfaminc         10.348    0.083  124.151    0.000   10.348    4.530
   .bytxrstd         53.260    0.371  143.540    0.000   53.260    5.238
   .bytxmstd         53.559    0.378  141.817    0.000   53.559    5.175
   .bytxsstd         53.335    0.365  146.139    0.000   53.335    5.333
   .bytxhstd         52.956    0.363  145.841    0.000   52.956    5.322
   .hw10              3.443    0.070   49.350    0.000    3.443    1.801
   .hw_8              1.733    0.042   41.712    0.000    1.733    1.522
   .eng_12            6.409    0.096   66.521    0.000    6.409    2.427
   .math_12           5.823    0.098   59.483    0.000    5.823    2.171
   .sci_12            6.088    0.097   62.661    0.000    6.088    2.287
   .ss_12             6.612    0.103   64.363    0.000    6.612    2.349

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          182.019   13.641   13.343    0.000  182.019    0.460
   .bypared           0.480    0.050    9.631    0.000    0.480    0.332
   .byfaminc          3.232    0.196   16.477    0.000    3.232    0.620
   .bytxrstd         29.797    2.030   14.681    0.000   29.797    0.288
   .bytxmstd         31.440    2.126   14.791    0.000   31.440    0.294
   .bytxsstd         29.662    1.994   14.876    0.000   29.662    0.297
   .bytxhstd         30.798    2.036   15.128    0.000   30.798    0.311
   .hw10              2.312    0.223   10.360    0.000    2.312    0.632
   .hw_8              0.993    0.067   14.829    0.000    0.993    0.766
   .eng_12            1.052    0.084   12.505    0.000    1.052    0.151
   .math_12           2.401    0.141   17.037    0.000    2.401    0.334
   .sci_12            1.656    0.107   15.446    0.000    1.656    0.234
   .ss_12             1.261    0.098   12.869    0.000    1.261    0.159
    famback         214.077   19.121   11.196    0.000    1.000    1.000
   .prevach          55.441    4.061   13.652    0.000    0.753    0.753
   .hw                1.014    0.201    5.045    0.000    0.755    0.755
   .grades            3.015    0.214   14.100    0.000    0.509    0.509
</code></pre>
</div>
</div>
<div id="cell-43" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="129">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2, hw_fit_mg3) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 67188 67661 223.17                                         
hw_fit_mg2 121 67185 67614 238.79    15.6108 0.037858       9    0.07547 .
hw_fit_mg3 122 67182 67606 236.98    -1.8015 0.000000       1    1.00000  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  223.175† 112   .000 .044  .986† .981  .029† 67187.706  67661.221 
hw_fit_mg2 238.786  121   .000 .044  .986  .981  .033  67185.317  67614.440 
hw_fit_mg3 236.984  122   .000 .043† .986  .982† .033  67181.515† 67605.706†

################## Differences in Fit Indices #######################
                        df  rmsea    cfi   tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg   9  0.000 -0.001 0.000 0.004 -2.389 -46.781
hw_fit_mg3 - hw_fit_mg2  1 -0.001  0.000 0.001 0.000 -3.801  -8.734

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
    hw_fit_mg3
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
</section>
<section id="all-effects-across-groups" class="level3">
<h3 class="anchored" data-anchor-id="all-effects-across-groups">All Effects Across Groups</h3>
<div id="cell-45" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="131">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constrain all the effects</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>hw_fit_mg4 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>, <span class="st">"regressions"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="132">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2, hw_fit_mg3, hw_fit_mg4) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 67188 67661 223.17                                         
hw_fit_mg2 121 67185 67614 238.79    15.6108 0.037858       9    0.07547 .
hw_fit_mg3 122 67182 67606 236.98    -1.8015 0.000000       1    1.00000  
hw_fit_mg4 126 67178 67583 241.79     4.8107 0.019887       4    0.30727  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  223.175† 112   .000 .044  .986† .981  .029† 67187.706  67661.221 
hw_fit_mg2 238.786  121   .000 .044  .986  .981  .033  67185.317  67614.440 
hw_fit_mg3 236.984  122   .000 .043  .986  .982  .033  67181.515  67605.706 
hw_fit_mg4 241.795  126   .000 .042† .986  .982† .033  67178.326† 67582.787†

################## Differences in Fit Indices #######################
                        df  rmsea    cfi   tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg   9  0.000 -0.001 0.000 0.004 -2.389 -46.781
hw_fit_mg3 - hw_fit_mg2  1 -0.001  0.000 0.001 0.000 -3.801  -8.734
hw_fit_mg4 - hw_fit_mg3  4 -0.001  0.000 0.000 0.001 -3.189 -22.919

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
    hw_fit_mg3
    hw_fit_mg4
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
</section>
<section id="all-effects-and-errors-across-groups" class="level3">
<h3 class="anchored" data-anchor-id="all-effects-and-errors-across-groups">All Effects and Errors Across Groups</h3>
<div id="cell-48" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="137">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constrain all the effects &amp; errors</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>hw_model_mg5 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw10 + hw_8</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ c(en, en)*eng_12</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ c(ma, ma)*math_12</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ c(sc, sc)*sci_12</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ c(ss, ss)*ss_12</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>hw_fit_mg5 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg5,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"loadings"</span>, <span class="st">"regressions"</span>,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"residuals"</span>, <span class="st">"lv.variances"</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-49" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="138">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2, hw_fit_mg3, hw_fit_mg4, hw_fit_mg5) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff    RMSEA Df diff Pr(&gt;Chisq)    
hw_fit_mg  112 67188 67661 223.17                                           
hw_fit_mg2 121 67185 67614 238.79     15.611 0.037858       9  0.0754676 .  
hw_fit_mg3 122 67182 67606 236.98     -1.801 0.000000       1  1.0000000    
hw_fit_mg4 126 67178 67583 241.79      4.811 0.019887       4  0.3072734    
hw_fit_mg5 147 67184 67485 289.32     47.528 0.049647      21  0.0007971 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  223.175† 112   .000 .044  .986† .981  .029† 67187.706  67661.221 
hw_fit_mg2 238.786  121   .000 .044  .986  .981  .033  67185.317  67614.440 
hw_fit_mg3 236.984  122   .000 .043  .986  .982  .033  67181.515  67605.706 
hw_fit_mg4 241.795  126   .000 .042† .986  .982† .033  67178.326† 67582.787 
hw_fit_mg5 289.323  147   .000 .043  .983  .981  .051  67183.854  67484.733†

################## Differences in Fit Indices #######################
                        df  rmsea    cfi    tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg   9  0.000 -0.001  0.000 0.004 -2.389 -46.781
hw_fit_mg3 - hw_fit_mg2  1 -0.001  0.000  0.001 0.000 -3.801  -8.734
hw_fit_mg4 - hw_fit_mg3  4 -0.001  0.000  0.000 0.001 -3.189 -22.919
hw_fit_mg5 - hw_fit_mg4 21  0.001 -0.003 -0.001 0.018  5.528 -98.054

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
    hw_fit_mg3
    hw_fit_mg4
    hw_fit_mg5
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sem\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/chap17.html" class="pagination-link" aria-label="Latent Variable SEM">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Latent Variable SEM</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/chap19.html" class="pagination-link" aria-label="Latent Means">
        <span class="nav-page-text">Latent Means</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>