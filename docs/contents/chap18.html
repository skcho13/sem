<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-11-26">

<title>Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions –  CHA Statistics II in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/chap19.html" rel="next">
<link href="../contents/chap17.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions –  CHA Statistics II in R">
<meta property="og:description" content="Multiple Regression and Beyond (3e) by Timothy Z. Keith">
<meta property="og:site_name" content="CHA Statistics II in R">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../"><i class="fa-solid fa-chart-bar" aria-label="chart-bar"></i> CHA Statistics II in R</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/baser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/setup2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages for SEM</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Keith’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/chap12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Path Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Factor Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Variable SEM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap18.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multigroup Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/chap22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagnostics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEM Equations</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Kline’s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../contents/Kline/composite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reflective</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: Formative</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: PLS-PM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap16-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Composite: HO</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/Kline/kchap21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Latent Growth Curve</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1OQ1D7d4MxEfMZmo_FLj29rGWqvWADKmGc_QD9g5h_ho/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#initial-model" id="toc-initial-model" class="nav-link active" data-scroll-target="#initial-model">Initial Model</a>
  <ul>
  <li><a href="#가족배경이-성적에-미치는-효과" id="toc-가족배경이-성적에-미치는-효과" class="nav-link" data-scroll-target="#가족배경이-성적에-미치는-효과">가족배경이 성적에 미치는 효과</a></li>
  <li><a href="#소수인종이-성적에-미치는-영향" id="toc-소수인종이-성적에-미치는-영향" class="nav-link" data-scroll-target="#소수인종이-성적에-미치는-영향">소수인종이 성적에 미치는 영향</a></li>
  <li><a href="#using-csem" id="toc-using-csem" class="nav-link" data-scroll-target="#using-csem">Using cSEM</a></li>
  </ul></li>
  <li><a href="#competing-models" id="toc-competing-models" class="nav-link" data-scroll-target="#competing-models">Competing models</a></li>
  <li><a href="#panel-models" id="toc-panel-models" class="nav-link" data-scroll-target="#panel-models">Panel Models</a></li>
  <li><a href="#multigroup-models" id="toc-multigroup-models" class="nav-link" data-scroll-target="#multigroup-models">Multigroup Models</a>
  <ul>
  <li><a href="#measurement-constraints" id="toc-measurement-constraints" class="nav-link" data-scroll-target="#measurement-constraints">Measurement Constraints</a></li>
  <li><a href="#effect-of-homework-across-groups" id="toc-effect-of-homework-across-groups" class="nav-link" data-scroll-target="#effect-of-homework-across-groups">Effect of Homework Across Groups</a></li>
  <li><a href="#all-effects-across-groups" id="toc-all-effects-across-groups" class="nav-link" data-scroll-target="#all-effects-across-groups">All Effects Across Groups</a></li>
  <li><a href="#all-effects-and-errors-across-groups" id="toc-all-effects-and-errors-across-groups" class="nav-link" data-scroll-target="#all-effects-and-errors-across-groups">All Effects and Errors Across Groups</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Chapter 18. Multigroup Models, Panel Models, Dangers and Assumptions</h1>
<p class="subtitle lead">Multiple Regression and Beyond (3e) by Timothy Z. Keith</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 26, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="1">
<details class="code-fold">
<summary>Load libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manymome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>A Latent Variable Homework Model</strong><br>
Single indicators와 correlated errors를 가지는 모형을 구성</p>
<section id="initial-model" class="level2">
<h2 class="anchored" data-anchor-id="initial-model">Initial Model</h2>
<p><img src="images/fig18-1.png" class="img-fluid" width="700"></p>
<div id="cell-4" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<details class="code-fold">
<summary>Load the dataset</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data/chap 18 latent var SEM 2/HW latent matrix.sav"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>hwcov <span class="ot">&lt;-</span> hw[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">16</span>)] <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> hw<span class="sc">$</span>varname_[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">sds =</span> hw[<span class="dv">16</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">16</span>]  <span class="sc">|&gt;</span> <span class="fu">as.double</span>())</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a dataset with the same covariance matrix</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>hw_sim <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(hwcov, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"exact"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># replace Minority values to 1 if it &gt; 0.3, otherwise 0</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>hw_sim <span class="ot">&lt;-</span> hw_sim <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Minority =</span> <span class="fu">ifelse</span>(Minority <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-5" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hw_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # measurement model</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">  EthnicMinor =~ Minority</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  HW =~ hw10 + hw_8</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">  # residual covariacne/variance</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Minority ~~ 0.0099*Minority</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">  # structural model</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch ~ b1*Famback + b2*EthnicMinor</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades ~ b3*PrevAch + b4*HW</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">  HW ~ b5*PrevAch + b6*Famback + b7*EthnicMinor</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effects; famback &gt; homework &gt; grades</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">  ind_fam := b4*b6</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">  # indirect effects; ethnicminor &gt; homework &gt; grades</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">  ind_ethinic := b4*b7</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>hw_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model, <span class="at">sample.cov =</span> hwcov, <span class="at">sample.nobs =</span> <span class="dv">1000</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 277 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        39

  Number of observations                          1000

Model Test User Model:
                                                      
  Test statistic                               204.654
  Degrees of freedom                                66
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              8392.044
  Degrees of freedom                                91
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.983
  Tucker-Lewis Index (TLI)                       0.977

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -33331.251
  Loglikelihood unrestricted model (H1)     -33228.924
                                                      
  Akaike (AIC)                               66740.502
  Bayesian (BIC)                             66931.905
  Sample-size adjusted Bayesian (SABIC)      66808.039

Root Mean Square Error of Approximation:

  RMSEA                                          0.046
  90 Percent confidence interval - lower         0.039
  90 Percent confidence interval - upper         0.053
  P-value H_0: RMSEA &lt;= 0.050                    0.825
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.029

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  EthnicMinor =~                                                        
    Minority          1.000                               0.434    0.975
  Famback =~                                                            
    parocc            1.000                              16.760    0.776
    bypared           0.062    0.003   21.618    0.000    1.032    0.805
    byfaminc          0.100    0.005   19.224    0.000    1.683    0.667
  PrevAch =~                                                            
    bytxrstd          1.000                               8.806    0.855
    bytxmstd          0.997    0.030   33.754    0.000    8.782    0.844
    bytxsstd          0.990    0.030   33.537    0.000    8.718    0.846
    bytxhstd          0.967    0.029   32.925    0.000    8.513    0.837
  HW =~                                                                 
    hw10              1.000                               1.126    0.592
    hw_8              0.453    0.060    7.553    0.000    0.510    0.451
  Grades =~                                                             
    eng_12            1.000                               2.471    0.924
    math_12           0.896    0.024   37.832    0.000    2.213    0.820
    sci_12            0.957    0.022   43.705    0.000    2.364    0.878
    ss_12             1.062    0.022   48.218    0.000    2.625    0.914

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  PrevAch ~                                                             
    Famback   (b1)    0.278    0.020   13.656    0.000    0.529    0.529
    EthnicMnr (b2)   -1.774    0.645   -2.749    0.006   -0.087   -0.087
  Grades ~                                                              
    PrevAch   (b3)    0.145    0.012   12.580    0.000    0.518    0.518
    HW        (b4)    0.601    0.132    4.569    0.000    0.274    0.274
  HW ~                                                                  
    PrevAch   (b5)    0.053    0.008    6.643    0.000    0.413    0.413
    Famback   (b6)    0.013    0.004    3.122    0.002    0.198    0.198
    EthnicMnr (b7)    0.281    0.123    2.293    0.022    0.108    0.108

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.704    0.248    2.844    0.004    0.704    0.128
 .bytxmstd ~~                                                           
   .math_12           2.856    0.342    8.350    0.000    2.856    0.331
 .bytxsstd ~~                                                           
   .sci_12            0.920    0.285    3.227    0.001    0.920    0.130
 .bytxhstd ~~                                                           
   .ss_12             0.533    0.277    1.927    0.054    0.533    0.082
  EthnicMinor ~~                                                        
    Famback          -2.136    0.277   -7.709    0.000   -0.294   -0.294

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Minority          0.010                               0.010    0.050
   .parocc          185.127   13.017   14.222    0.000  185.127    0.397
   .bypared           0.580    0.046   12.697    0.000    0.580    0.353
   .byfaminc          3.528    0.193   18.276    0.000    3.528    0.555
   .bytxrstd         28.555    1.718   16.625    0.000   28.555    0.269
   .bytxmstd         31.233    1.821   17.153    0.000   31.233    0.288
   .bytxsstd         30.165    1.767   17.067    0.000   30.165    0.284
   .bytxhstd         30.864    1.774   17.399    0.000   30.864    0.299
   .hw10              2.352    0.202   11.639    0.000    2.352    0.650
   .hw_8              1.018    0.058   17.562    0.000    1.018    0.797
   .eng_12            1.052    0.074   14.115    0.000    1.052    0.147
   .math_12           2.378    0.122   19.545    0.000    2.378    0.327
   .sci_12            1.653    0.094   17.625    0.000    1.653    0.228
   .ss_12             1.364    0.090   15.133    0.000    1.364    0.165
    EthnicMinor       0.188    0.009   21.242    0.000    1.000    1.000
    Famback         280.913   21.604   13.003    0.000    1.000    1.000
   .PrevAch          53.163    3.514   15.130    0.000    0.686    0.686
   .HW                0.915    0.182    5.020    0.000    0.722    0.722
   .Grades            3.150    0.202   15.604    0.000    0.516    0.516

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    ind_fam           0.008    0.003    2.727    0.006    0.054    0.054
    ind_ethinic       0.169    0.079    2.138    0.032    0.030    0.030
</code></pre>
</div>
</div>
<p><strong>비표준화 결과</strong></p>
<p>어떤 단위로 측정되었는가?<br>
Grades: 0 (an F average) to 12 (A+)<br>
Homework:<br>
<img src="images/hw-scale.png" class="img-fluid" width="300"></p>
<p><img src="images/fig18-6.png" class="img-fluid" width="700"></p>
<section id="가족배경이-성적에-미치는-효과" class="level3">
<h3 class="anchored" data-anchor-id="가족배경이-성적에-미치는-효과">가족배경이 성적에 미치는 효과</h3>
<p>소수인종 변수를 통제한 상태에서</p>
<p>All (direct/indirect) paths from family background to grades: total effect</p>
<div id="cell-8" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the simulated data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>hw_fit_sim <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model, <span class="at">data =</span> hw_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manymome)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># All indirect paths from family background to grades: total effect</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>paths <span class="ot">&lt;-</span> <span class="fu">all_indirect_paths</span>(hw_fit_sim, <span class="at">x =</span> <span class="st">"Famback"</span>, <span class="at">y =</span> <span class="st">"Grades"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>paths <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
all_indirect_paths(fit = hw_fit_sim, x = "Famback", y = "Grades")
Path(s): 
  path                              
1 Famback -&gt; PrevAch -&gt; HW -&gt; Grades
2 Famback -&gt; PrevAch -&gt; Grades      
3 Famback -&gt; HW -&gt; Grades           </code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ind_est_std <span class="ot">&lt;-</span> <span class="fu">many_indirect_effects</span>(paths,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> hw_fit_sim, <span class="at">R =</span> <span class="dv">1000</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_ci =</span> <span class="cn">TRUE</span>, <span class="at">boot_type =</span> <span class="st">"bc"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_y =</span> <span class="cn">TRUE</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>ind_est_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=16s  </code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>
==  Indirect Effect(s) (Both x-variable(s) and y-variable(s) Standardized)  ==
                                     std CI.lo CI.hi Sig
Famback -&gt; PrevAch -&gt; HW -&gt; Grades 0.059 0.034 0.108 Sig
Famback -&gt; PrevAch -&gt; Grades       0.284 0.229 0.336 Sig
Famback -&gt; HW -&gt; Grades            0.050 0.013 0.098 Sig

 - [CI.lo to CI.hi] are 95.0% bias-corrected confidence intervals by
   nonparametric bootstrapping with 1000 samples.
 - std: The standardized indirect effects.
 </code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total effect (all indirects + directs) from family background to grades</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ind_est_std[[<span class="dv">1</span>]] <span class="sc">+</span> ind_est_std[[<span class="dv">2</span>]] <span class="sc">+</span> ind_est_std[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
== Indirect Effect (Both ‘Famback’ and ‘Grades’ Standardized) ==
                                                        
 Path:                Famback -&gt; PrevAch -&gt; HW -&gt; Grades
 Path:                Famback -&gt; PrevAch -&gt; Grades      
 Path:                Famback -&gt; HW -&gt; Grades           
 Function of Effects: 0.392                             
 95.0% Bootstrap CI:  [0.342 to 0.442]                  

Computation of the Function of Effects:
 ((Famback-&gt;PrevAch-&gt;HW-&gt;Grades)
+(Famback-&gt;PrevAch-&gt;Grades))
+(Famback-&gt;HW-&gt;Grades) 


Bias-corrected confidence interval formed by nonparametric bootstrapping with
1000 bootstrap samples.</code></pre>
</div>
</div>
<p>특정 간접효과를 테스트하려면,</p>
<div id="cell-13" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">indirect_effect</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> hw_fit_sim,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Famback"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Grades"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="fu">c</span>(<span class="st">"HW"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_out =</span> out_med,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_y =</span> <span class="cn">TRUE</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ==  Indirect Effect(s) (Both x-variable(s) and y-variable(s) Standardized)  ==</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   std CI.lo CI.hi Sig</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># famback -&gt; prevach -&gt; hw -&gt; grades 0.060 0.034 0.105 Sig</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># famback -&gt; prevach -&gt; grades       0.274 0.222 0.325 Sig</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># famback -&gt; hw -&gt; grades            0.054 0.018 0.102 Sig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
== Indirect Effect (Both ‘Famback’ and ‘Grades’ Standardized) ==
                                         
 Path:            Famback -&gt; HW -&gt; Grades
 Indirect Effect: 0.050                  

Computation Formula:
  (b.HW~Famback)*(b.Grades~HW)*sd_Famback/sd_Grades

Computation:
  (0.01251)*(0.58685)*(16.70928)/(2.47203)

Coefficients of Component Paths:
       Path Coefficient
 HW~Famback      0.0125
  Grades~HW      0.5868

NOTE:
- The effects of the component paths are from the model, not standardized.</code></pre>
</div>
</div>
</section>
<section id="소수인종이-성적에-미치는-영향" class="level3">
<h3 class="anchored" data-anchor-id="소수인종이-성적에-미치는-영향">소수인종이 성적에 미치는 영향</h3>
<p>가족배경 변수를 통제한 상태에서</p>
<p>All (direct/indirect) paths from minority to grades: total effect<br>
소수인종 변수가 카테고리 변수(더미)이므로 해석에 유의</p>
<div id="cell-15" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All indirect paths from minority to grades: total effect</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>paths2 <span class="ot">&lt;-</span> <span class="fu">all_indirect_paths</span>(hw_fit_sim,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"EthnicMinor"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Grades"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>paths2 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
all_indirect_paths(fit = hw_fit_sim, x = "EthnicMinor", y = "Grades")
Path(s): 
  path                                  
1 EthnicMinor -&gt; PrevAch -&gt; HW -&gt; Grades
2 EthnicMinor -&gt; PrevAch -&gt; Grades      
3 EthnicMinor -&gt; HW -&gt; Grades           </code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ind_est_std2 <span class="ot">&lt;-</span> <span class="fu">many_indirect_effects</span>(paths2,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> hw_fit_sim, <span class="at">R =</span> <span class="dv">1000</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_ci =</span> <span class="cn">TRUE</span>, <span class="at">boot_type =</span> <span class="st">"bc"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_x =</span> <span class="cn">FALSE</span>,  <span class="co"># categorical variable</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_y =</span> <span class="cn">TRUE</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ind_est_std2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=13s  </code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>
==  Indirect Effect(s) (y-variable(s) Standardized)  ==
                                          ind  CI.lo CI.hi Sig
EthnicMinor -&gt; PrevAch -&gt; HW -&gt; Grades -0.013 -0.040 0.001    
EthnicMinor -&gt; PrevAch -&gt; Grades       -0.061 -0.144 0.013    
EthnicMinor -&gt; HW -&gt; Grades             0.036 -0.017 0.110    

 - [CI.lo to CI.hi] are 95.0% bias-corrected confidence intervals by
   nonparametric bootstrapping with 1000 samples.
 - std: The partially standardized indirect effects. 
 - y-variable(s) standardized.
 </code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total effect (all indirects + directs) from minority to grades</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ind_est_std2[[<span class="dv">1</span>]] <span class="sc">+</span> ind_est_std2[[<span class="dv">2</span>]] <span class="sc">+</span> ind_est_std2[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
== Indirect Effect (‘Grades’ Standardized) ==
                                                            
 Path:                EthnicMinor -&gt; PrevAch -&gt; HW -&gt; Grades
 Path:                EthnicMinor -&gt; PrevAch -&gt; Grades      
 Path:                EthnicMinor -&gt; HW -&gt; Grades           
 Function of Effects: -0.037                                
 95.0% Bootstrap CI:  [-0.146 to 0.073]                     

Computation of the Function of Effects:
 ((EthnicMinor-&gt;PrevAch-&gt;HW-&gt;Grades)
+(EthnicMinor-&gt;PrevAch-&gt;Grades))
+(EthnicMinor-&gt;HW-&gt;Grades) 


Bias-corrected confidence interval formed by nonparametric bootstrapping with
1000 bootstrap samples.</code></pre>
</div>
</div>
</section>
<section id="using-csem" class="level3">
<h3 class="anchored" data-anchor-id="using-csem">Using cSEM</h3>
<div id="cell-19" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>hw_model_c <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="st">  EthnicMinor &lt;~ Minority</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Famback =~ bypared + byfaminc + parocc</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">  HW =~ hw_8 + hw10</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch ~ Famback + EthnicMinor</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades ~ PrevAch + HW</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">  HW ~ PrevAch + Famback + EthnicMinor</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>hw_raw_imp <span class="ot">&lt;-</span> VIM<span class="sc">::</span><span class="fu">kNN</span>(hw_raw, <span class="at">k =</span> <span class="dv">10</span>) <span class="co"># kNN imputation</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>csem_fit <span class="ot">&lt;-</span> cSEM<span class="sc">::</span><span class="fu">csem</span>(<span class="at">.data =</span> hw_raw_imp, <span class="at">.model =</span> hw_model_c, <span class="at">.resample_method =</span> <span class="st">"bootstrap"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>cSEM<span class="sc">::</span><span class="fu">summarize</span>(csem_fit) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ERROR: Error: 객체 'hw_raw'를 찾을 수 없습니다

Error: 객체 'hw_raw'를 찾을 수 없습니다
Traceback:

1. check_data(data)
2. .handleSimpleError(function (cnd) 
 . {
 .     watcher$capture_plot_and_output()
 .     cnd &lt;- sanitize_call(cnd)
 .     watcher$push(cnd)
 .     switch(on_error, continue = invokeRestart("eval_continue"), 
 .         stop = invokeRestart("eval_stop"), error = invokeRestart("eval_error", 
 .             cnd))
 . }, "객체 'hw_raw'를 찾을 수 없습니다", base::quote(eval(expr, 
 .     envir)))</code></pre>
</div>
</div>
</section>
</section>
<section id="competing-models" class="level2">
<h2 class="anchored" data-anchor-id="competing-models">Competing models</h2>
<p><img src="images/table18-2.png" class="img-fluid" width="700"></p>
<p><img src="images/fig18-8.png" class="img-fluid" width="700"></p>
<div id="cell-21" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Measurement model</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>hw_model_cfa <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">  EthnicMinor =~ Minority</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Famback =~ bypared + byfaminc + parocc</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">  PrevAch =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">  HW =~ hw_8 + hw10</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Minority ~~ 0.0099*Minority</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>hw_fit_cfa <span class="ot">&lt;-</span> <span class="fu">cfa</span>(hw_model_cfa, <span class="at">sample.cov =</span> hwcov, <span class="at">sample.nobs =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit, hw_fit_cfa) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

           Df   AIC   BIC  Chisq Chisq diff     RMSEA Df diff Pr(&gt;Chisq)
hw_fit_cfa 64 66742 66944 202.47                                        
hw_fit     66 66741 66932 204.65     2.1889 0.0097196       2     0.3347

####################### Model Fit Indices ###########################
              chisq df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_cfa 202.465† 64   .000 .047  .983† .976  .029† 66742.313  66943.531 
hw_fit     204.654  66   .000 .046† .983  .977† .029  66740.502† 66931.905†

################## Differences in Fit Indices #######################
                    df  rmsea cfi   tli  srmr    aic     bic
hw_fit - hw_fit_cfa  2 -0.001   0 0.001 0.001 -1.811 -11.627

The following lavaan models were compared:
    hw_fit_cfa
    hw_fit
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
<p><strong>Modification indices</strong></p>
<div id="cell-24" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(hw_fit, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">subset</span>(mi <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
86           HW =~ bytxmstd 42.221  4.562   2.326    0.223    0.223
98       Grades =~ bytxmstd 37.990  0.734   1.814    0.174    0.174
103    Minority ~~  bypared 23.209  0.067   0.067    0.889    0.889
47  EthnicMinor =~  bypared 22.716  0.395   0.171    0.133    0.133
158    bytxmstd ~~ bytxhstd 21.288 -6.514  -6.514   -0.210   -0.210
48  EthnicMinor =~ byfaminc 18.841 -0.725  -0.314   -0.125   -0.125
104    Minority ~~ byfaminc 18.752 -0.123  -0.123   -0.657   -0.657
99       Grades =~ bytxsstd 14.693 -0.455  -1.123   -0.109   -0.109
167    bytxsstd ~~   eng_12 14.085 -1.009  -1.009   -0.179   -0.179
187     math_12 ~~   sci_12 13.040  0.277   0.277    0.140    0.140
82           HW =~  bypared 11.355  0.358   0.182    0.142    0.142
186      eng_12 ~~    ss_12 10.345  0.285   0.285    0.238    0.238</code></pre>
</div>
</div>
<p><strong>Residuals</strong></p>
<p>Keith’s figure 18.10: normalized residuals</p>
<div id="cell-27" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardized residuals</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>resid_z <span class="ot">&lt;-</span> <span class="fu">residuals</span>(hw_fit, <span class="at">type =</span> <span class="st">"standardized.mplus"</span>)<span class="sc">$</span>cov</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(resid_z, <span class="at">method =</span> <span class="st">'number'</span>, <span class="at">type =</span> <span class="st">'lower'</span>, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap18_files/figure-html/cell-19-output-1.png" width="720" height="720" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation residuals</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>resid_cor <span class="ot">&lt;-</span> <span class="fu">residuals</span>(hw_fit, <span class="at">type =</span> <span class="st">"cor"</span>)<span class="sc">$</span>cov</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(resid_cor, <span class="at">method =</span> <span class="st">'number'</span>, <span class="at">type =</span> <span class="st">'lower'</span>, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chap18_files/figure-html/cell-20-output-1.png" width="720" height="720" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="panel-models" class="level2">
<h2 class="anchored" data-anchor-id="panel-models">Panel Models</h2>
<p>성취도가 locus of control에 미치는 영향과 locus of control이 성취도에 미치는 종단적 영향을 파악하기 위한 모형; 주 목적은 효과의 방향성에 대한 이해</p>
<p><img src="images/fig18-12.png" class="img-fluid" width="800"></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>BYS44B 나는 내 인생이 나아가는 방향을 충분히 통제하지 못한다(그림에서 control8)<br>
BYS44C 내 인생에서 성공을 위해서는 노력보다 행운이 더 중요하다(luck8)<br>
BYS44F 내가 앞서 나가려고 할 때마다 무언가 또는 누군가가 나를 막는다 (stops8)<br>
BYS44M 내 인생에서 일어나는 일에는 기회와 행운이 매우 중요하다(chance8)</p>
</div>
</div>
</div>
<p>논의: 각 시점 내에서 인과관계는 설정하지 않았음. Why?</p>
<div id="cell-30" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<details class="code-fold">
<summary>Load the dataset</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"BySES"</span>, <span class="st">"control8"</span>, <span class="st">"luck8"</span>, <span class="st">"stops8"</span>, <span class="st">"chance8"</span>, <span class="st">"contro10"</span>, <span class="st">"luck10"</span>, <span class="st">"stops10"</span>, <span class="st">"chance10"</span>, <span class="st">"contro12"</span>, <span class="st">"luck12"</span>, <span class="st">"stops12"</span>, <span class="st">"chance12"</span>, <span class="st">"feel8"</span>, <span class="st">"worth8"</span>, <span class="st">"do8"</span>, <span class="st">"sat8"</span>, <span class="st">"feel10"</span>, <span class="st">"worth10"</span>, <span class="st">"do10"</span>, <span class="st">"sat10"</span>, <span class="st">"feel12"</span>, <span class="st">"worth12"</span>, <span class="st">"do12"</span>, <span class="st">"sat12"</span>, <span class="st">"read8"</span>, <span class="st">"math8"</span>, <span class="st">"scienc8"</span>, <span class="st">"social8"</span>, <span class="st">"read10"</span>, <span class="st">"math10"</span>, <span class="st">"scienc10"</span>, <span class="st">"social10"</span>, <span class="st">"read12"</span>, <span class="st">"math12"</span>, <span class="st">"scienc12"</span>, <span class="st">"social12"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>loc_txt <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"data/chap 18 latent var SEM 2/sc locus ach matrix n12k.txt"</span>, <span class="at">col_names =</span> vars)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>loc_mean <span class="ot">&lt;-</span> loc_txt[<span class="dv">40</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>loc_sds <span class="ot">&lt;-</span> loc_txt[<span class="dv">39</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>loc_cor <span class="ot">&lt;-</span> loc_txt[<span class="dv">1</span><span class="sc">:</span><span class="dv">38</span>, ] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>loc_cov <span class="ot">&lt;-</span> loc_cor <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> vars, <span class="at">sds =</span> loc_sds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-31" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>loc_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # measurement model</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus8 =~ control8 + luck8 + stops8 + chance8</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus10 =~ contro10 + luck10 + stops10 + chance10</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus12 =~ contro12 + luck12 + stops12 + chance12</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach8 =~ read8 + math8 + scienc8 + social8</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach10 =~ read10 + math10 + scienc10 + social10</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach12 =~ read12 + math12 + scienc12 + social12</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="st">  # structural model</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus12 ~ Locus10 + Ach10</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach12 ~ Ach10 + Locus10</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus10 ~ Locus8 + Ach8</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach10 ~ Ach8 + Locus8</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus8 ~ Sex + BySES</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="st">  Ach8 ~ Sex + BySES</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="st">  Sex ~~ 0*BySES</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="st">  # correlated disturbances at each time point</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus8 ~~ Ach8</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus10 ~~ Ach10</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="st">  Locus12 ~~ Ach12</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="st">  # correlated errors items over time</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="st">  control8 ~~ contro10</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="st">  control8 ~~ contro12</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="st">  contro10 ~~ contro12</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="st">  luck8 ~~ luck10</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="st">  luck8 ~~ luck12</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="st">  luck10 ~~ luck12</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="st">  stops8 ~~ stops10</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="st">  stops8 ~~ stops12</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="st">  stops10 ~~ stops12</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="st">  chance8 ~~ chance10</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="st">  chance8 ~~ chance12</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="st">  chance10 ~~ chance12</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="st">  read8 ~~ read10</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="st">  read8 ~~ read12</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="st">  read10 ~~ read12</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="st">  math8 ~~ math10</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="st">  math8 ~~ math12</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a><span class="st">  math10 ~~ math12</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="st">  scienc8 ~~ scienc10</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="st">  scienc8 ~~ scienc12</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="st">  scienc10 ~~ scienc12</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="st">  social8 ~~ social10</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="st">  social8 ~~ social12</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="st">  social10 ~~ social12</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>loc_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(loc_model, <span class="at">sample.cov =</span> loc_cov, <span class="at">sample.nobs =</span> <span class="dv">12572</span>)</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(loc_fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 286 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        89

  Number of observations                         12572

Model Test User Model:
                                                      
  Test statistic                              8204.529
  Degrees of freedom                               262
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                            224320.606
  Degrees of freedom                               325
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.965
  Tucker-Lewis Index (TLI)                       0.956

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)            -652454.746
  Loglikelihood unrestricted model (H1)    -648352.482
                                                      
  Akaike (AIC)                             1305087.492
  Bayesian (BIC)                           1305749.584
  Sample-size adjusted Bayesian (SABIC)    1305466.751

Root Mean Square Error of Approximation:

  RMSEA                                          0.049
  90 Percent confidence interval - lower         0.048
  90 Percent confidence interval - upper         0.050
  P-value H_0: RMSEA &lt;= 0.050                    0.946
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.044

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Locus8 =~                                                             
    control8          1.000                               0.357    0.441
    luck8             1.248    0.035   35.417    0.000    0.446    0.605
    stops8            0.929    0.030   31.099    0.000    0.332    0.439
    chance8           1.555    0.043   35.948    0.000    0.555    0.624
  Locus10 =~                                                            
    contro10          1.000                               0.355    0.457
    luck10            1.281    0.033   39.181    0.000    0.455    0.663
    stops10           0.892    0.027   33.620    0.000    0.317    0.451
    chance10          1.459    0.037   39.484    0.000    0.518    0.657
  Locus12 =~                                                            
    contro12          1.000                               0.373    0.473
    luck12            1.343    0.031   43.051    0.000    0.500    0.719
    stops12           0.951    0.025   37.709    0.000    0.354    0.505
    chance12          1.489    0.035   43.061    0.000    0.555    0.694
  Ach8 =~                                                               
    read8             1.000                               8.564    0.842
    math8             1.023    0.008  121.261    0.000    8.763    0.851
    scienc8           1.019    0.008  120.649    0.000    8.729    0.855
    social8           1.005    0.008  118.952    0.000    8.605    0.846
  Ach10 =~                                                              
    read10            1.000                               8.695    0.863
    math10            1.021    0.007  136.374    0.000    8.877    0.877
    scienc10          1.042    0.008  136.616    0.000    9.064    0.885
    social10          1.006    0.008  130.757    0.000    8.744    0.864
  Ach12 =~                                                              
    read12            1.000                               8.607    0.857
    math12            1.038    0.008  135.026    0.000    8.932    0.883
    scienc12          1.036    0.008  133.000    0.000    8.921    0.881
    social12          1.016    0.008  130.088    0.000    8.744    0.869

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Locus12 ~                                                             
    Locus10           0.564    0.020   28.477    0.000    0.537    0.537
    Ach10             0.006    0.000   12.038    0.000    0.136    0.136
  Ach12 ~                                                               
    Ach10             0.950    0.006  151.543    0.000    0.959    0.959
    Locus10           0.321    0.107    3.000    0.003    0.013    0.013
  Locus10 ~                                                             
    Locus8            0.521    0.021   24.766    0.000    0.524    0.524
    Ach8              0.004    0.001    7.883    0.000    0.103    0.103
  Ach10 ~                                                               
    Ach8              0.945    0.007  132.611    0.000    0.931    0.931
    Locus8            0.818    0.142    5.745    0.000    0.034    0.034
  Locus8 ~                                                              
    Sex               0.023    0.008    2.926    0.003    0.063    0.032
    BySES             0.126    0.006   22.788    0.000    0.353    0.283
  Ach8 ~                                                                
    Sex              -0.540    0.135   -3.994    0.000   -0.063   -0.032
    BySES             5.788    0.090   64.430    0.000    0.676    0.542

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sex ~~                                                                
    BySES             0.000                               0.000    0.000
 .Locus8 ~~                                                             
   .Ach8              0.982    0.038   25.985    0.000    0.399    0.399
 .Locus10 ~~                                                            
   .Ach10             0.149    0.013   11.154    0.000    0.185    0.185
 .Locus12 ~~                                                            
   .Ach12             0.108    0.011    9.890    0.000    0.160    0.160
 .control8 ~~                                                           
   .contro10          0.077    0.005   15.574    0.000    0.077    0.154
   .contro12          0.065    0.005   13.194    0.000    0.065    0.129
 .contro10 ~~                                                           
   .contro12          0.089    0.005   18.824    0.000    0.089    0.186
 .luck8 ~~                                                              
   .luck10            0.026    0.004    7.223    0.000    0.026    0.086
   .luck12            0.025    0.003    7.467    0.000    0.025    0.089
 .luck10 ~~                                                             
   .luck12            0.025    0.003    7.839    0.000    0.025    0.101
 .stops8 ~~                                                             
   .stops10           0.089    0.004   21.178    0.000    0.089    0.210
   .stops12           0.067    0.004   16.658    0.000    0.067    0.164
 .stops10 ~~                                                            
   .stops12           0.099    0.004   25.969    0.000    0.099    0.263
 .chance8 ~~                                                            
   .chance10          0.076    0.005   15.238    0.000    0.076    0.185
   .chance12          0.074    0.005   15.669    0.000    0.074    0.185
 .chance10 ~~                                                           
   .chance12          0.068    0.004   15.871    0.000    0.068    0.199
 .read8 ~~                                                              
   .read10           12.691    0.336   37.725    0.000   12.691    0.456
   .read12            9.783    0.327   29.894    0.000    9.783    0.345
 .read10 ~~                                                             
   .read12           11.906    0.319   37.334    0.000   11.906    0.453
 .math8 ~~                                                              
   .math10           18.040    0.351   51.470    0.000   18.040    0.686
   .math12           15.389    0.332   46.385    0.000   15.389    0.598
 .math10 ~~                                                             
   .math12           18.056    0.328   55.035    0.000   18.056    0.782
 .scienc8 ~~                                                            
   .scienc10          4.344    0.303   14.353    0.000    4.344    0.171
   .scienc12          4.285    0.300   14.284    0.000    4.285    0.168
 .scienc10 ~~                                                           
   .scienc12          7.300    0.290   25.213    0.000    7.300    0.318
 .social8 ~~                                                            
   .social10          7.607    0.323   23.573    0.000    7.607    0.275
   .social12          5.962    0.310   19.204    0.000    5.962    0.221
 .social10 ~~                                                           
   .social12          7.351    0.301   24.438    0.000    7.351    0.290

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .control8          0.528    0.008   70.109    0.000    0.528    0.806
   .luck8             0.344    0.006   56.216    0.000    0.344    0.634
   .stops8            0.460    0.007   70.237    0.000    0.460    0.807
   .chance8           0.484    0.009   54.421    0.000    0.484    0.611
   .contro10          0.477    0.007   70.646    0.000    0.477    0.791
   .luck10            0.264    0.005   51.766    0.000    0.264    0.560
   .stops10           0.392    0.006   71.020    0.000    0.392    0.796
   .chance10          0.352    0.007   53.246    0.000    0.352    0.568
   .contro12          0.482    0.007   71.233    0.000    0.482    0.776
   .luck12            0.234    0.005   47.379    0.000    0.234    0.483
   .stops12           0.366    0.005   69.721    0.000    0.366    0.745
   .chance12          0.331    0.006   51.512    0.000    0.331    0.518
   .read8            29.988    0.464   64.565    0.000   29.988    0.290
   .math8            29.338    0.461   63.667    0.000   29.338    0.276
   .scienc8          28.105    0.454   61.900    0.000   28.105    0.269
   .social8          29.485    0.463   63.690    0.000   29.485    0.285
   .read10           25.818    0.397   65.026    0.000   25.818    0.255
   .math10           23.568    0.372   63.324    0.000   23.568    0.230
   .scienc10         22.844    0.377   60.589    0.000   22.844    0.218
   .social10         26.025    0.405   64.281    0.000   26.025    0.254
   .read12           26.760    0.411   65.092    0.000   26.760    0.265
   .math12           22.605    0.369   61.267    0.000   22.605    0.221
   .scienc12         23.044    0.380   60.675    0.000   23.044    0.225
   .social12         24.674    0.392   62.900    0.000   24.674    0.244
    Sex               0.250    0.003   79.284    0.000    0.250    1.000
    BySES             0.643    0.008   79.284    0.000    0.643    1.000
   .Locus8            0.117    0.006   21.190    0.000    0.919    0.919
   .Locus10           0.084    0.004   21.806    0.000    0.664    0.664
   .Locus12           0.088    0.004   23.341    0.000    0.636    0.636
   .Ach8             51.746    0.913   56.670    0.000    0.705    0.705
   .Ach10             7.732    0.194   39.803    0.000    0.102    0.102
   .Ach12             5.139    0.139   37.013    0.000    0.069    0.069
</code></pre>
</div>
</div>
</section>
<section id="multigroup-models" class="level2">
<h2 class="anchored" data-anchor-id="multigroup-models">Multigroup Models</h2>
<p>카테고리 변수의 레벨에 따라 잠재변수의 효과가 다른지에 대한 검증; 상호작용 효과<br>
연속인 (잠재)변수 간의 상호작용에 대해서는 22장에서 다룸</p>
<p><img src="images/fig18-14.png" class="img-fluid" width="700"> <img src="images/fig18-15.png" class="img-fluid" width="700"></p>
<p><strong>Estimation</strong><br>
그룹별 공분산 행렬로부터 얻어지는 fit function들의 (표본 수) 가중치 평균을 fit function으로 사용<br>
ML estimation의 경우</p>
<ul>
<li>각 그룹 j에 대해, <span class="math inline">\(F_{ML}^j = log|\Sigma(\theta)| + tr(S\Sigma^{-1}(\theta)) - log|S| - (p + q)\)</span></li>
<li><span class="math inline">\(\displaystyle F_{ML} = \sum_j \frac{N_j}{N} F_{ML}^j\)</span></li>
</ul>
<p><img src="images/table18-3.png" class="img-fluid" width="700"></p>
<div id="cell-33" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="129">
<details class="code-fold">
<summary>Load the dataset</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a dataset with the same covariance matrix</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>hw_mg_minor <span class="ot">&lt;-</span> <span class="fu">read_xls</span>(<span class="st">"data/chap 18 latent var SEM 2/minority matrix.xls"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>hw_mg_white <span class="ot">&lt;-</span> <span class="fu">read_xls</span>(<span class="st">"data/chap 18 latent var SEM 2/white matrix.xls"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For minority group</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>hw_mg_minor_cov <span class="ot">&lt;-</span> hw_mg_minor[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>)] <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> hw_mg_minor<span class="sc">$</span>varname_[<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>], <span class="at">sds =</span> hw_mg_minor[<span class="dv">16</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>())</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hw_mg_minor_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(hw_mg_minor_cov))</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(hw_mg_minor_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">rownames</span>(hw_mg_minor_cov))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>mean_minor <span class="ot">&lt;-</span> hw_mg_minor[<span class="dv">15</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For white group</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>hw_mg_white_cov <span class="ot">&lt;-</span> hw_mg_white[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>)] <span class="sc">|&gt;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lav_matrix_vechr</span>(<span class="at">diagonal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getCov</span>(<span class="at">names =</span> hw_mg_white<span class="sc">$</span>varname_[<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>], <span class="at">sds =</span> hw_mg_white[<span class="dv">16</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>())</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hw_mg_white_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(hw_mg_white_cov))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(hw_mg_white_cov) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">rownames</span>(hw_mg_white_cov))</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>mean_white <span class="ot">&lt;-</span> hw_mg_white[<span class="dv">15</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">15</span>] <span class="sc">|&gt;</span> <span class="fu">as.double</span>()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>hw_sim_minor <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(hw_mg_minor_cov, <span class="at">n =</span> <span class="dv">274</span>, <span class="at">type =</span> <span class="st">"exact"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sweep</span>(<span class="dv">2</span>, mean_minor, <span class="at">FUN =</span> <span class="st">"+"</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>hw_sim_white <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">kd</span>(hw_mg_white_cov, <span class="at">n =</span> <span class="dv">751</span>, <span class="at">type =</span> <span class="st">"exact"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sweep</span>(<span class="dv">2</span>, mean_white, <span class="at">FUN =</span> <span class="st">"+"</span>)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">131</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>hw_multigroup <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  hw_sim_minor <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"minority"</span>),</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  hw_sim_white <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"white"</span>)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">900</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-34" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="130">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hw_multigroup <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   bypared  byfaminc   parocc bytxrstd bytxmstd bytxsstd bytxhstd     hw_8     hw10
1 3.477102 10.665843 38.43281 46.96390 57.89953 50.71309 45.52944 2.879256 6.703532
2 3.298204 10.055041 46.10124 63.11553 65.43042 46.32358 52.61707 2.718312 5.034043
3 3.392463  9.906801 48.69503 61.66536 62.68831 67.51536 62.09874 2.149325 5.855915
4 2.522122  8.551281 49.65279 56.15432 54.94386 44.65248 47.67488 2.947018 5.570204
5 5.575341 10.891556 64.23261 58.78616 63.80637 57.38648 60.86180 3.403386 4.031776
6 5.192402 10.667251 68.82314 56.87892 54.70169 54.10558 51.51500 5.503236 3.788413
     eng_12  math_12   sci_12     ss_12    group
1  8.661664 7.910145 7.247774  8.123688    white
2  6.632333 4.591556 6.289245  7.601705 minority
3  9.070309 5.404964 9.544480  8.503456 minority
4 10.935536 7.104243 9.076028 11.466477    white
5  5.652511 2.516713 3.941772  8.302535 minority
6  7.828620 4.378463 6.640992  8.810365 minority</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Using covariance matrices">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using covariance matrices
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>hw_fit_mg <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.cov =</span> <span class="fu">list</span>(hw_mg_white_cov, hw_mg_minor_cov),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.mean =</span> <span class="fu">list</span>(mean_white, mean_minor),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.nobs =</span> <span class="fu">list</span>(<span class="dv">751</span>, <span class="dv">274</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Simulated data (N=900)를 이용</p>
<div id="cell-37" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="131">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>hw_model_mg <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw10 + hw_8</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>hw_fit_mg <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg, <span class="at">data =</span> hw_multigroup, <span class="at">group =</span> <span class="st">"group"</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit_mg, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 402 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        96

  Number of observations per group:                   
    white                                          665
    minority                                       235

Model Test User Model:
                                                      
  Test statistic                               194.017
  Degrees of freedom                               112
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    white                                      116.568
    minority                                    77.449

Model Test Baseline Model:

  Test statistic                              7292.337
  Degrees of freedom                               156
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.989
  Tucker-Lewis Index (TLI)                       0.984

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -29423.810
  Loglikelihood unrestricted model (H1)     -29326.802
                                                      
  Akaike (AIC)                               59039.621
  Bayesian (BIC)                             59500.651
  Sample-size adjusted Bayesian (SABIC)      59195.771

Root Mean Square Error of Approximation:

  RMSEA                                          0.040
  90 Percent confidence interval - lower         0.031
  90 Percent confidence interval - upper         0.050
  P-value H_0: RMSEA &lt;= 0.050                    0.955
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.029

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [white]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              14.608    0.727
    bypared           0.071    0.004   15.757    0.000    1.035    0.842
    byfaminc          0.096    0.007   13.683    0.000    1.397    0.605
  prevach =~                                                            
    bytxrstd          1.000                               8.625    0.849
    bytxmstd          0.986    0.037   26.563    0.000    8.509    0.834
    bytxsstd          0.967    0.037   26.491    0.000    8.342    0.837
    bytxhstd          0.960    0.037   26.134    0.000    8.278    0.834
  hw =~                                                                 
    hw10              1.000                               1.278    0.660
    hw_8              0.381    0.068    5.606    0.000    0.487    0.433
  grades =~                                                             
    eng_12            1.000                               2.454    0.924
    math_12           0.888    0.030   29.950    0.000    2.179    0.808
    sci_12            0.967    0.027   35.958    0.000    2.373    0.879
    ss_12             1.062    0.027   39.818    0.000    2.606    0.918

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.297    0.028   10.658    0.000    0.504    0.504
  grades ~                                                              
    prevach           0.161    0.012   12.909    0.000    0.567    0.567
    hw                0.444    0.120    3.686    0.000    0.231    0.231
  hw ~                                                                  
    prevach           0.042    0.010    4.237    0.000    0.285    0.285
    famback           0.023    0.006    3.669    0.000    0.259    0.259

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.862    0.303    2.842    0.004    0.862    0.158
 .bytxmstd ~~                                                           
   .math_12           3.018    0.432    6.985    0.000    3.018    0.337
 .bytxsstd ~~                                                           
   .sci_12            1.349    0.348    3.876    0.000    1.349    0.193
 .bytxhstd ~~                                                           
   .ss_12             0.094    0.328    0.288    0.774    0.094    0.015

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           54.813    0.780   70.297    0.000   54.813    2.726
   .bypared           3.321    0.048   69.655    0.000    3.321    2.701
   .byfaminc         10.328    0.090  115.341    0.000   10.328    4.473
   .bytxrstd         53.051    0.394  134.605    0.000   53.051    5.220
   .bytxmstd         53.420    0.396  135.035    0.000   53.420    5.236
   .bytxsstd         53.243    0.386  137.807    0.000   53.243    5.344
   .bytxhstd         52.914    0.385  137.469    0.000   52.914    5.331
   .hw10              3.418    0.075   45.506    0.000    3.418    1.765
   .hw_8              1.723    0.044   39.523    0.000    1.723    1.533
   .eng_12            6.410    0.103   62.243    0.000    6.410    2.414
   .math_12           5.793    0.105   55.391    0.000    5.793    2.148
   .sci_12            6.089    0.105   58.201    0.000    6.089    2.257
   .ss_12             6.621    0.110   60.106    0.000    6.621    2.331

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          190.906   15.208   12.553    0.000  190.906    0.472
   .bypared           0.441    0.059    7.501    0.000    0.441    0.292
   .byfaminc          3.379    0.216   15.625    0.000    3.379    0.634
   .bytxrstd         28.897    2.135   13.538    0.000   28.897    0.280
   .bytxmstd         31.677    2.252   14.066    0.000   31.677    0.304
   .bytxsstd         29.676    2.122   13.983    0.000   29.676    0.299
   .bytxhstd         30.003    2.141   14.011    0.000   30.003    0.305
   .hw10              2.119    0.310    6.835    0.000    2.119    0.565
   .hw_8              1.027    0.071   14.548    0.000    1.027    0.812
   .eng_12            1.031    0.090   11.518    0.000    1.031    0.146
   .math_12           2.526    0.156   16.171    0.000    2.526    0.347
   .sci_12            1.648    0.115   14.386    0.000    1.648    0.226
   .ss_12             1.275    0.106   12.025    0.000    1.275    0.158
    famback         213.400   22.443    9.509    0.000    1.000    1.000
   .prevach          55.537    4.493   12.361    0.000    0.746    0.746
   .hw                1.269    0.301    4.213    0.000    0.777    0.777
   .grades            3.107    0.232   13.370    0.000    0.516    0.516


Group 2 [minority]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              18.455    0.788
    bypared           0.057    0.005   10.629    0.000    1.054    0.792
    byfaminc          0.105    0.011    9.719    0.000    1.941    0.690
  prevach =~                                                            
    bytxrstd          1.000                               8.852    0.877
    bytxmstd          1.022    0.058   17.572    0.000    9.046    0.864
    bytxsstd          0.897    0.058   15.372    0.000    7.936    0.803
    bytxhstd          0.883    0.057   15.505    0.000    7.818    0.804
  hw =~                                                                 
    hw10              1.000                               0.802    0.442
    hw_8              0.731    0.181    4.045    0.000    0.586    0.512
  grades =~                                                             
    eng_12            1.000                               2.555    0.936
    math_12           0.905    0.047   19.150    0.000    2.312    0.831
    sci_12            0.909    0.042   21.428    0.000    2.322    0.875
    ss_12             1.037    0.045   22.915    0.000    2.649    0.895

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.281    0.037    7.662    0.000    0.587    0.587
  grades ~                                                              
    prevach           0.131    0.042    3.099    0.002    0.455    0.455
    hw                0.768    0.603    1.272    0.203    0.241    0.241
  hw ~                                                                  
    prevach           0.062    0.015    4.044    0.000    0.681    0.681
    famback           0.001    0.006    0.225    0.822    0.031    0.031

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.257    0.474    0.543    0.587    0.257    0.055
 .bytxmstd ~~                                                           
   .math_12           2.350    0.683    3.441    0.001    2.350    0.288
 .bytxsstd ~~                                                           
   .sci_12            0.287    0.600    0.478    0.632    0.287    0.038
 .bytxhstd ~~                                                           
   .ss_12             1.420    0.629    2.257    0.024    1.420    0.186

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           43.630    1.528   28.555    0.000   43.630    1.863
   .bypared           2.823    0.087   32.534    0.000    2.823    2.122
   .byfaminc          8.887    0.183   48.462    0.000    8.887    3.161
   .bytxrstd         48.458    0.659   73.578    0.000   48.458    4.800
   .bytxmstd         49.773    0.683   72.871    0.000   49.773    4.754
   .bytxsstd         48.064    0.645   74.522    0.000   48.064    4.861
   .bytxhstd         48.249    0.634   76.060    0.000   48.249    4.962
   .hw10              3.207    0.118   27.095    0.000    3.207    1.768
   .hw_8              1.731    0.075   23.172    0.000    1.731    1.512
   .eng_12            5.785    0.178   32.494    0.000    5.785    2.120
   .math_12           5.439    0.182   29.961    0.000    5.439    1.954
   .sci_12            5.620    0.173   32.455    0.000    5.620    2.117
   .ss_12             5.939    0.193   30.769    0.000    5.939    2.007

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          208.041   31.044    6.701    0.000  208.041    0.379
   .bypared           0.658    0.100    6.583    0.000    0.658    0.372
   .byfaminc          4.137    0.480    8.621    0.000    4.137    0.523
   .bytxrstd         23.579    3.192    7.387    0.000   23.579    0.231
   .bytxmstd         27.811    3.569    7.793    0.000   27.811    0.254
   .bytxsstd         34.775    3.867    8.994    0.000   34.775    0.356
   .bytxhstd         33.441    3.720    8.988    0.000   33.441    0.354
   .hw10              2.649    0.305    8.677    0.000    2.649    0.805
   .hw_8              0.967    0.132    7.306    0.000    0.967    0.738
   .eng_12            0.919    0.152    6.041    0.000    0.919    0.123
   .math_12           2.400    0.256    9.370    0.000    2.400    0.310
   .sci_12            1.657    0.192    8.631    0.000    1.657    0.235
   .ss_12             1.739    0.216    8.063    0.000    1.739    0.199
    famback         340.576   52.807    6.449    0.000    1.000    1.000
   .prevach          51.378    6.931    7.413    0.000    0.656    0.656
   .hw                0.329    0.187    1.762    0.078    0.511    0.511
   .grades            3.794    0.484    7.841    0.000    0.581    0.581
</code></pre>
</div>
</div>
<section id="measurement-constraints" class="level3">
<h3 class="anchored" data-anchor-id="measurement-constraints">Measurement Constraints</h3>
<p>두 그룹에게 잠재변수가 동일한 의미를 가지는가?; 20장에서 자세히 다룸<br>
그룹 간에 잠재변수/측정모형의 동일성(invariance)을 검정하기 위해 factor loadings를 그룹 간에 동일하게 제약; (weak invariance)</p>
<p>제약에 대한 lavaan 문법: <a href="https://lavaan.ugent.be/tutorial/groups.html">lavaan 문서</a></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>HS.model <span class="ot">&lt;-</span> <span class="st">' visual  =~ x1 + x2 + c(v3,v3)*x3</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="st">              textual =~ x4 + x5 + x6</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="st">              speed   =~ x7 + x8 + x9 '</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>또는 다음 예에서 처럼 <code>group.equal = c("loadings")</code> 키워드를 이용<br>
결과표에서 .p1, .p2, …으로 동일하게 제약된 factor loadings를 확인할 수 있음</p>
<div id="cell-39" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="132">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrains factor loadings</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>hw_fit_mg2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw_fit_mg2, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 401 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        96
  Number of equality constraints                     9

  Number of observations per group:                   
    white                                          665
    minority                                       235

Model Test User Model:
                                                      
  Test statistic                               209.165
  Degrees of freedom                               121
  P-value (Chi-square)                           0.000
  Test statistic for each group:
    white                                      120.642
    minority                                    88.523

Model Test Baseline Model:

  Test statistic                              7292.337
  Degrees of freedom                               156
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.988
  Tucker-Lewis Index (TLI)                       0.984

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -29431.384
  Loglikelihood unrestricted model (H1)     -29326.802
                                                      
  Akaike (AIC)                               59036.769
  Bayesian (BIC)                             59454.577
  Sample-size adjusted Bayesian (SABIC)      59178.279

Root Mean Square Error of Approximation:

  RMSEA                                          0.040
  90 Percent confidence interval - lower         0.031
  90 Percent confidence interval - upper         0.049
  P-value H_0: RMSEA &lt;= 0.050                    0.963
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.033

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured


Group 1 [white]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              15.002    0.741
    bypared (.p2.)    0.066    0.003   19.026    0.000    0.996    0.819
    byfamnc (.p3.)    0.098    0.006   16.614    0.000    1.468    0.628
  prevach =~                                                            
    bytxrst           1.000                               8.691    0.851
    bytxmst (.p5.)    0.995    0.031   31.773    0.000    8.648    0.840
    bytxsst (.p6.)    0.948    0.031   30.716    0.000    8.235    0.833
    bytxhst (.p7.)    0.939    0.031   30.463    0.000    8.159    0.829
  hw =~                                                                 
    hw10              1.000                               1.181    0.613
    hw_8    (.p9.)    0.454    0.064    7.059    0.000    0.536    0.473
  grades =~                                                             
    eng_12            1.000                               2.467    0.925
    math_12 (.11.)    0.893    0.025   35.559    0.000    2.202    0.811
    sci_12  (.12.)    0.950    0.023   41.891    0.000    2.344    0.876
    ss_12   (.13.)    1.056    0.023   46.042    0.000    2.604    0.917

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.293    0.027   11.005    0.000    0.505    0.505
  grades ~                                                              
    prevach           0.160    0.012   12.855    0.000    0.564    0.564
    hw                0.480    0.128    3.762    0.000    0.230    0.230
  hw ~                                                                  
    prevach           0.041    0.009    4.335    0.000    0.302    0.302
    famback           0.021    0.006    3.600    0.000    0.263    0.263

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.854    0.304    2.813    0.005    0.854    0.157
 .bytxmstd ~~                                                           
   .math_12           2.997    0.432    6.941    0.000    2.997    0.338
 .bytxsstd ~~                                                           
   .sci_12            1.351    0.348    3.884    0.000    1.351    0.191
 .bytxhstd ~~                                                           
   .ss_12             0.117    0.328    0.357    0.721    0.117    0.019

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           54.813    0.785   69.859    0.000   54.813    2.709
   .bypared           3.321    0.047   70.439    0.000    3.321    2.732
   .byfaminc         10.328    0.091  113.892    0.000   10.328    4.417
   .bytxrstd         53.051    0.396  133.951    0.000   53.051    5.194
   .bytxmstd         53.420    0.399  133.769    0.000   53.420    5.187
   .bytxsstd         53.243    0.384  138.823    0.000   53.243    5.383
   .bytxhstd         52.914    0.382  138.555    0.000   52.914    5.373
   .hw10              3.418    0.075   45.757    0.000    3.418    1.774
   .hw_8              1.723    0.044   39.250    0.000    1.723    1.522
   .eng_12            6.410    0.103   61.994    0.000    6.410    2.404
   .math_12           5.793    0.105   55.031    0.000    5.793    2.134
   .sci_12            6.089    0.104   58.703    0.000    6.089    2.276
   .ss_12             6.621    0.110   60.139    0.000    6.621    2.332

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          184.342   14.742   12.505    0.000  184.342    0.450
   .bypared           0.486    0.053    9.178    0.000    0.486    0.329
   .byfaminc          3.312    0.215   15.409    0.000    3.312    0.606
   .bytxrstd         28.778    2.122   13.559    0.000   28.778    0.276
   .bytxmstd         31.265    2.239   13.962    0.000   31.265    0.295
   .bytxsstd         29.999    2.109   14.224    0.000   29.999    0.307
   .bytxhstd         30.411    2.129   14.283    0.000   30.411    0.314
   .hw10              2.317    0.251    9.215    0.000    2.317    0.624
   .hw_8              0.994    0.071   14.040    0.000    0.994    0.776
   .eng_12            1.023    0.089   11.512    0.000    1.023    0.144
   .math_12           2.519    0.156   16.154    0.000    2.519    0.342
   .sci_12            1.659    0.114   14.572    0.000    1.659    0.232
   .ss_12             1.277    0.105   12.145    0.000    1.277    0.158
    famback         225.055   21.210   10.611    0.000    1.000    1.000
   .prevach          56.253    4.348   12.938    0.000    0.745    0.745
   .hw                1.059    0.229    4.621    0.000    0.759    0.759
   .grades            3.140    0.230   13.622    0.000    0.516    0.516


Group 2 [minority]:

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  famback =~                                                            
    parocc            1.000                              17.351    0.753
    bypared (.p2.)    0.066    0.003   19.026    0.000    1.152    0.841
    byfamnc (.p3.)    0.098    0.006   16.614    0.000    1.698    0.625
  prevach =~                                                            
    bytxrst           1.000                               8.701    0.872
    bytxmst (.p5.)    0.995    0.031   31.773    0.000    8.658    0.847
    bytxsst (.p6.)    0.948    0.031   30.716    0.000    8.245    0.817
    bytxhst (.p7.)    0.939    0.031   30.463    0.000    8.169    0.821
  hw =~                                                                 
    hw10              1.000                               0.979    0.530
    hw_8    (.p9.)    0.454    0.064    7.059    0.000    0.444    0.396
  grades =~                                                             
    eng_12            1.000                               2.523    0.933
    math_12 (.11.)    0.893    0.025   35.559    0.000    2.252    0.823
    sci_12  (.12.)    0.950    0.023   41.891    0.000    2.397    0.883
    ss_12   (.13.)    1.056    0.023   46.042    0.000    2.664    0.897

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  prevach ~                                                             
    famback           0.295    0.035    8.332    0.000    0.589    0.589
  grades ~                                                              
    prevach           0.118    0.043    2.772    0.006    0.407    0.407
    hw                0.826    0.515    1.602    0.109    0.321    0.321
  hw ~                                                                  
    prevach           0.068    0.016    4.369    0.000    0.602    0.602
    famback           0.006    0.008    0.722    0.470    0.098    0.098

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .bytxrstd ~~                                                           
   .eng_12            0.339    0.473    0.717    0.473    0.339    0.071
 .bytxmstd ~~                                                           
   .math_12           2.433    0.689    3.529    0.000    2.433    0.288
 .bytxsstd ~~                                                           
   .sci_12            0.356    0.602    0.591    0.555    0.356    0.048
 .bytxhstd ~~                                                           
   .ss_12             1.376    0.628    2.191    0.028    1.376    0.184

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc           43.630    1.503   29.034    0.000   43.630    1.894
   .bypared           2.823    0.089   31.592    0.000    2.823    2.061
   .byfaminc          8.887    0.177   50.153    0.000    8.887    3.272
   .bytxrstd         48.458    0.651   74.428    0.000   48.458    4.855
   .bytxmstd         49.773    0.666   74.681    0.000   49.773    4.872
   .bytxsstd         48.064    0.659   72.971    0.000   48.064    4.760
   .bytxhstd         48.249    0.649   74.326    0.000   48.249    4.849
   .hw10              3.207    0.121   26.602    0.000    3.207    1.735
   .hw_8              1.731    0.073   23.657    0.000    1.731    1.543
   .eng_12            5.785    0.176   32.793    0.000    5.785    2.139
   .math_12           5.439    0.179   30.460    0.000    5.439    1.987
   .sci_12            5.620    0.177   31.721    0.000    5.620    2.069
   .ss_12             5.939    0.194   30.648    0.000    5.939    1.999

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .parocc          229.612   28.952    7.931    0.000  229.612    0.433
   .bypared           0.550    0.097    5.667    0.000    0.550    0.293
   .byfaminc          4.495    0.472    9.519    0.000    4.495    0.609
   .bytxrstd         23.913    3.099    7.716    0.000   23.913    0.240
   .bytxmstd         29.426    3.529    8.339    0.000   29.426    0.282
   .bytxsstd         33.978    3.820    8.895    0.000   33.978    0.333
   .bytxhstd         32.303    3.655    8.837    0.000   32.303    0.326
   .hw10              2.457    0.354    6.941    0.000    2.457    0.719
   .hw_8              1.060    0.113    9.396    0.000    1.060    0.843
   .eng_12            0.946    0.146    6.467    0.000    0.946    0.129
   .math_12           2.422    0.255    9.512    0.000    2.422    0.323
   .sci_12            1.630    0.191    8.541    0.000    1.630    0.221
   .ss_12             1.730    0.212    8.156    0.000    1.730    0.196
    famback         301.059   39.678    7.588    0.000    1.000    1.000
   .prevach          49.415    6.115    8.081    0.000    0.653    0.653
   .hw                0.536    0.281    1.909    0.056    0.558    0.558
   .grades            3.562    0.491    7.252    0.000    0.559    0.559
</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="135">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the two models</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 59040 59501 194.02                                        
hw_fit_mg2 121 59037 59455 209.16     15.148 0.03896       9    0.08696 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  194.017† 112   .000 .040  .989† .984  .029† 59039.621  59500.651 
hw_fit_mg2 209.165  121   .000 .040† .988  .984† .033  59036.769† 59454.577†

################## Differences in Fit Indices #######################
                       df rmsea    cfi tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg  9     0 -0.001   0 0.004 -2.852 -46.074

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
</section>
<section id="effect-of-homework-across-groups" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-homework-across-groups">Effect of Homework Across Groups</h3>
<p>경로 hw → grades가 그룹 간에 동일한가?</p>
<div id="cell-42" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="133">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constrains the effect of homework</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>hw_model_mg3 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw10 + hw_8</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ eng_12</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ math_12</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ sci_12</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ ss_12</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + c(h, h)*hw</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>hw_fit_mg3 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg3,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-43" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="134">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2, hw_fit_mg3) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 59040 59501 194.02                                        
hw_fit_mg2 121 59037 59455 209.16    15.1476 0.03896       9    0.08696 .
hw_fit_mg3 122 59035 59448 209.76     0.5932 0.00000       1    0.44117  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  194.017† 112   .000 .040  .989† .984  .029† 59039.621  59500.651 
hw_fit_mg2 209.165  121   .000 .040  .988  .984  .033  59036.769  59454.577 
hw_fit_mg3 209.758  122   .000 .040† .988  .984† .033  59035.362† 59448.368†

################## Differences in Fit Indices #######################
                        df rmsea    cfi tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg   9     0 -0.001   0 0.004 -2.852 -46.074
hw_fit_mg3 - hw_fit_mg2  1     0  0.000   0 0.000 -1.407  -6.209

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
    hw_fit_mg3
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
</section>
<section id="all-effects-across-groups" class="level3">
<h3 class="anchored" data-anchor-id="all-effects-across-groups">All Effects Across Groups</h3>
<div id="cell-45" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="125">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constrain all the effects</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>hw_fit_mg4 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>, <span class="st">"regressions"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="126">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2, hw_fit_mg3, hw_fit_mg4) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 59040 59501 194.02                                        
hw_fit_mg2 121 59037 59455 209.16    15.1476 0.03896       9    0.08696 .
hw_fit_mg3 122 59035 59448 209.76     0.5932 0.00000       1    0.44117  
hw_fit_mg4 126 59031 59425 213.11     3.3504 0.00000       4    0.50099  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  194.017† 112   .000 .040  .989† .984  .029† 59039.621  59500.651 
hw_fit_mg2 209.165  121   .000 .040  .988  .984  .033  59036.769  59454.577 
hw_fit_mg3 209.758  122   .000 .040  .988  .984  .033  59035.362  59448.368 
hw_fit_mg4 213.108  126   .000 .039† .988  .985† .034  59030.712† 59424.509†

################## Differences in Fit Indices #######################
                        df  rmsea    cfi   tli  srmr    aic     bic
hw_fit_mg2 - hw_fit_mg   9  0.000 -0.001 0.000 0.004 -2.852 -46.074
hw_fit_mg3 - hw_fit_mg2  1  0.000  0.000 0.000 0.000 -1.407  -6.209
hw_fit_mg4 - hw_fit_mg3  4 -0.001  0.000 0.001 0.001 -4.650 -23.859

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
    hw_fit_mg3
    hw_fit_mg4
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>
</section>
<section id="all-effects-and-errors-across-groups" class="level3">
<h3 class="anchored" data-anchor-id="all-effects-and-errors-across-groups">All Effects and Errors Across Groups</h3>
<div id="cell-48" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="127">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constrain all the effects &amp; errors</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>hw_model_mg5 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="st">  famback =~ parocc + bypared + byfaminc</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach =~ bytxrstd + bytxmstd + bytxsstd + bytxhstd</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="st">  hw =~ hw10 + hw_8</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="st">  grades =~ eng_12 + math_12 + sci_12 + ss_12</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxrstd ~~ c(en, en)*eng_12</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxmstd ~~ c(ma, ma)*math_12</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxsstd ~~ c(sc, sc)*sci_12</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="st">  bytxhstd ~~ c(ss, ss)*ss_12</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="st">  prevach ~ famback</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="st">  grades ~ prevach + hw</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="st">  hw ~ prevach + famback</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>hw_fit_mg5 <span class="ot">&lt;-</span> <span class="fu">sem</span>(hw_model_mg5,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hw_multigroup,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.equal =</span> <span class="fu">c</span>(</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"loadings"</span>, <span class="st">"regressions"</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"residuals"</span>, <span class="st">"lv.variances"</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-49" class="cell" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="128">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compareFit</span>(hw_fit_mg, hw_fit_mg2, hw_fit_mg3, hw_fit_mg4, hw_fit_mg5) <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

            Df   AIC   BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)  
hw_fit_mg  112 59040 59501 194.02                                        
hw_fit_mg2 121 59037 59455 209.16     15.148 0.03896       9    0.08696 .
hw_fit_mg3 122 59035 59448 209.76      0.593 0.00000       1    0.44117  
hw_fit_mg4 126 59031 59425 213.11      3.350 0.00000       4    0.50099  
hw_fit_mg5 147 59023 59316 247.26     34.155 0.03731      21    0.03488 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

####################### Model Fit Indices ###########################
              chisq  df pvalue rmsea   cfi   tli  srmr        aic        bic
hw_fit_mg  194.017† 112   .000 .040  .989† .984  .029† 59039.621  59500.651 
hw_fit_mg2 209.165  121   .000 .040  .988  .984  .033  59036.769  59454.577 
hw_fit_mg3 209.758  122   .000 .040  .988  .984  .033  59035.362  59448.368 
hw_fit_mg4 213.108  126   .000 .039  .988  .985  .034  59030.712  59424.509 
hw_fit_mg5 247.263  147   .000 .039† .986  .985† .044  59022.867† 59315.813†

################## Differences in Fit Indices #######################
                        df  rmsea    cfi   tli  srmr    aic      bic
hw_fit_mg2 - hw_fit_mg   9  0.000 -0.001 0.000 0.004 -2.852  -46.074
hw_fit_mg3 - hw_fit_mg2  1  0.000  0.000 0.000 0.000 -1.407   -6.209
hw_fit_mg4 - hw_fit_mg3  4 -0.001  0.000 0.001 0.001 -4.650  -23.859
hw_fit_mg5 - hw_fit_mg4 21  0.000 -0.002 0.000 0.010 -7.845 -108.695

The following lavaan models were compared:
    hw_fit_mg
    hw_fit_mg2
    hw_fit_mg3
    hw_fit_mg4
    hw_fit_mg5
To view results, assign the compareFit() output to an object and  use the summary() method; see the class?FitDiff help page.</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sem\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/chap17.html" class="pagination-link" aria-label="Latent Variable SEM">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Latent Variable SEM</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/chap19.html" class="pagination-link" aria-label="Latent Means">
        <span class="nav-page-text">Latent Means</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>